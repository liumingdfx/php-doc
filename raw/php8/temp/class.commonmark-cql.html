<div id="class.commonmark-cql" class="reference"> <h1 class="title">The CommonMark\CQL class</h1>  <div class="partintro"><p class="verinfo">(cmark &gt;= 1.1.0)</p>  <div class="section" id="commonmark-cql.intro">   <h2 class="title">简介</h2>   <p class="para">    CommonMark Query Language is a DSL for describing how to travel through a CommonMark Node tree implemented as a parser and compiler for a small set of instructions, and a virtual machine for executing those instructions.   </p>   <p class="formalpara">    <h5 class="title">Paths:</h5>     <p class="para">      In it&#039;s most simplistic form, a CQL query combines the following paths and <span>/</span> to describe how to travel through a tree:      <ul class="simplelist">       <li class="member">firstChild</li>       <li class="member">lastChild</li>       <li class="member">previous</li>       <li class="member">next</li>       <li class="member">parent</li>      </ul>      For example, <span>/firstChild/lastChild</span> would travel to the last child node of the first child node.     </p>   </p>   <p class="formalpara">   <h5 class="title">Loops</h5>   <p class="para">    CQL can be instructed to loop, for example through the children of, or siblings to a particular node, by using the path <span>children</span>, or <span>siblings</span>. For example, <span>/firstChild/children</span> will travel to all the children of the first child node.   </p>   </p>   <p class="formalpara">    <h5 class="title">Subqueries</h5>     <p class="para">      CQL can be instructed how to travel by using a subquery like <span>[/firstChild]</span>. For example, <span>/firstChild/children[/firstChild]</span> will travel to the first child node of all the children of the first child node.     </p>      </p>   <p class="formalpara">    <h5 class="title">Loop Constraints</h5>     <p class="para">      While looping, CQL can be instructed to constrict the travelled path to nodes of particular type. For example <span>/children(BlockQuote)</span> will travel to the children of a node where the type is <span>BlockQuote</span>. The following types are recognized (case insensitively):      <ul class="simplelist">       <li class="member">BlockQuote</li>       <li class="member">List</li>       <li class="member">Item</li>       <li class="member">CodeBlock</li>       <li class="member">HtmlBlock</li>       <li class="member">CustomBlock</li>       <li class="member">Paragraph</li>       <li class="member">Heading</li>       <li class="member">ThematicBreak</li>       <li class="member">Text</li>       <li class="member">SoftBreak</li>       <li class="member">LineBreak</li>       <li class="member">Code</li>       <li class="member">HtmlInline</li>       <li class="member">CustomInline</li>       <li class="member">Emphasis</li>       <li class="member">Strong</li>       <li class="member">Link</li>       <li class="member">Image</li>      </ul>      Types may be used as a union, for example <span>/children(BlockQuote|List)</span> will travel to the children of a node where the type is <span>BlockQuote</span> or <span>List</span>. Types, or unions of types, may be also negated. For example <span>/children(~BlockQuote)</span> will travel to the children of a node where the type is not <span>BlockQuote</span>, and <span>/children(~BlockQuote|Paragraph)</span> will travel to the children of a node where the type is not <span>BlockQuote</span> or <span>Paragraph</span>     </p>   </p>   <p class="formalpara">    <h5 class="title">Path Constraints</h5>     <p class="para">      CQL can be instructed to create a loop to travel to a node of a particular type, at a particular path. For example, <span>/firstChild(BlockQuote)</span> will travel to the first child node where the type is <span>BlockQuote</span>. Note that like other loops for <span>children</span> and <span>siblings</span>, this kind of path can only be followed by a subquery.     </p>   </p>   <p class="formalpara">    <h5 class="title">Implementation Notes</h5>    <p class="para">    While CQL has been implemented as part of the PHP CommonMark extension, it stands separately from PHP and does not use PHP&#039;s virtual machine or internal representation of values.   </p>    </p>  </div>  <div class="section" id="commonmark-cql.synopsis">   <h2 class="title">类摘要</h2>   <div class="classsynopsis">    <span class="ooclass"><strong class="classname"></strong></span>    <div class="classsynopsisinfo">     <span class="ooclass">      <span class="modifier">class</span> <strong class="classname">CommonMark\CQL</strong>     </span>     {</div>    <div class="classsynopsisinfo classsynopsisinfo_comment">// Constructor </div>    <div class="constructorsynopsis dc-description">   <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/commonmark-cql.construct.php" class="methodname" style="color:#CC7832">__construct</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$query</span></span>)</div>        <div class="classsynopsisinfo classsynopsisinfo_comment">// 方法 </div>    <div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/commonmark-cql.invoke.php" class="methodname" style="color:#CC7832">__invoke</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.commonmark-node.php" class="type CommonMark\Node" style="color:#EAB766">CommonMark\Node</a></span> <span class="parameter" style="color:#3A95FF">$root</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.callable.php" class="type callable" style="color:#EAB766">callable</a></span> <span class="parameter" style="color:#3A95FF">$handler</span></span>)</div>   }</div>  </div> </div>    <h2>目录</h2><ul class="chunklist chunklist_reference"><li>{@link CommonMark\CQL::__construct} — CQL Construction</li><li>{@link CommonMark\CQL::__invoke} — CQL Execution</li></ul></div>