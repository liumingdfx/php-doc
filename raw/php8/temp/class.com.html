<div id="class.com" class="reference">  <h1 class="title">The com class</h1> <div class="partintro"><p class="verinfo">(PHP 4 &gt;= 4.1.0, PHP 5, PHP 7, PHP 8)</p>  <div class="section" id="com.intro">   <h2 class="title">简介</h2>   <p class="para">    The com class allows you to instantiate an OLE compatible COM object and    call its methods and access its properties.   </p>  </div>  <div class="section" id="com.synopsis">   <h2 class="title">类摘要</h2>   <div class="classsynopsis"><div class="classsynopsisinfo">         <span class="modifier">class</span> <strong class="classname"><strong class="classname">com</strong></strong>             <span class="modifier">extends</span>      <a href="https://www.php.net/manual/zh/class.variant.php" class="classname">variant</a>     {</div>    <div class="classsynopsisinfo classsynopsisinfo_comment">// 方法 </div>    <div class="constructorsynopsis dc-description">   <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/com.construct.php" class="methodname" style="color:#CC7832">__construct</a></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$module_name</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766">string</span>|<span class="type" style="color:#EAB766">null</span></span> <span class="parameter" style="color:#3A95FF">$server_name</span><span class="initializer"> = <strong><span>null</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$codepage</span><span class="initializer"> = <strong><span>CP_ACP</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$typelib</span><span class="initializer"> = &quot;&quot;</span></span><br>)</div>   }</div>  </div>  <div class="section" id="class.com.overloadedmethods">   <h2 class="title">Overloaded Methods</h2>   <p class="para">    The returned object is an overloaded object, which means that PHP does    not see any fixed methods as it does with regular classes; instead, any    property or method accesses are passed through to COM.   </p>   <p class="para">    PHP will automatically detect methods that accept    parameters by reference, and will automatically convert regular PHP    variables to a form that can be passed by reference.  This means that you    can call the method very naturally; you needn&#039;t go to any extra effort in    your code.   </p>  </div>  <div class="section" id="class.com.examples">   <h2 class="title">com examples</h2>   <p class="para">    <div class="example" id="">     <p><strong>示例 #1 com example (1)</strong></p>     <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// starting word<br /></span><span style="color: #9876AA">$word </span><span style="color: #007700">= new </span><span style="color: #9876AA">com</span><span style="color: #007700">(</span><span style="color: #DD0000">"word.application"</span><span style="color: #007700">) or die(</span><span style="color: #DD0000">"Unable to instantiate Word"</span><span style="color: #007700">);<br />echo </span><span style="color: #DD0000">"Loaded Word, version </span><span style="color: #007700">{</span><span style="color: #9876AA">$word</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Version</span><span style="color: #007700">}</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//bring it to front<br /></span><span style="color: #9876AA">$word</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Visible </span><span style="color: #007700">= </span><span style="color: #9876AA">1</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//open an empty document<br /></span><span style="color: #9876AA">$word</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Documents</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Add</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//do some weird stuff<br /></span><span style="color: #9876AA">$word</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Selection</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">TypeText</span><span style="color: #007700">(</span><span style="color: #DD0000">"This is a test..."</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$word</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Documents</span><span style="color: #007700">[</span><span style="color: #9876AA">1</span><span style="color: #007700">]-&gt;</span><span style="color: #9876AA">SaveAs</span><span style="color: #007700">(</span><span style="color: #DD0000">"Useless test.doc"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//closing word<br /></span><span style="color: #9876AA">$word</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Quit</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//free the object<br /></span><span style="color: #9876AA">$word </span><span style="color: #007700">= </span><span style="color: #9876AA">null</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    </div>   </p>   <p class="para">    <div class="example" id="">     <p><strong>示例 #2 com example (2)</strong></p>     <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= new </span><span style="color: #9876AA">com</span><span style="color: #007700">(</span><span style="color: #DD0000">"ADODB.Connection"</span><span style="color: #007700">) or die(</span><span style="color: #DD0000">"Cannot start ADO"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Open</span><span style="color: #007700">(</span><span style="color: #DD0000">"Provider=SQLOLEDB; Data Source=localhost;<br />Initial Catalog=database; User ID=user; Password=password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$rs </span><span style="color: #007700">= </span><span style="color: #9876AA">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Execute</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT * FROM sometable"</span><span style="color: #007700">);    </span><span style="color: #FF8000">// Recordset<br /><br /></span><span style="color: #9876AA">$num_columns </span><span style="color: #007700">= </span><span style="color: #9876AA">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Fields</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Count</span><span style="color: #007700">();<br />echo </span><span style="color: #9876AA">$num_columns </span><span style="color: #007700">. </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /><br />for (</span><span style="color: #9876AA">$i</span><span style="color: #007700">=</span><span style="color: #9876AA">0</span><span style="color: #007700">; </span><span style="color: #9876AA">$i </span><span style="color: #007700">&lt; </span><span style="color: #9876AA">$num_columns</span><span style="color: #007700">; </span><span style="color: #9876AA">$i</span><span style="color: #007700">++) {<br />    </span><span style="color: #9876AA">$fld</span><span style="color: #007700">[</span><span style="color: #9876AA">$i</span><span style="color: #007700">] = </span><span style="color: #9876AA">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Fields</span><span style="color: #007700">(</span><span style="color: #9876AA">$i</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$rowcount </span><span style="color: #007700">= </span><span style="color: #9876AA">0</span><span style="color: #007700">;<br />while (!</span><span style="color: #9876AA">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">EOF</span><span style="color: #007700">) {<br />    for (</span><span style="color: #9876AA">$i</span><span style="color: #007700">=</span><span style="color: #9876AA">0</span><span style="color: #007700">; </span><span style="color: #9876AA">$i </span><span style="color: #007700">&lt; </span><span style="color: #9876AA">$num_columns</span><span style="color: #007700">; </span><span style="color: #9876AA">$i</span><span style="color: #007700">++) {<br />        echo </span><span style="color: #9876AA">$fld</span><span style="color: #007700">[</span><span style="color: #9876AA">$i</span><span style="color: #007700">]-&gt;</span><span style="color: #9876AA">value </span><span style="color: #007700">. </span><span style="color: #DD0000">"\t"</span><span style="color: #007700">;<br />    }<br />    echo </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />    </span><span style="color: #9876AA">$rowcount</span><span style="color: #007700">++;            </span><span style="color: #FF8000">// increments rowcount<br />    </span><span style="color: #9876AA">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">MoveNext</span><span style="color: #007700">();<br />}<br /><br /></span><span style="color: #9876AA">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Close</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">Close</span><span style="color: #007700">();<br /><br /></span><span style="color: #9876AA">$rs </span><span style="color: #007700">= </span><span style="color: #9876AA">null</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">null</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>     </div>    </div>   </p>  </div> </div> <h2>目录</h2><ul class="chunklist chunklist_reference"><li>{@link com::__construct} — com class constructor</li></ul></div>