<div id="function.oci-bind-by-name" class="refentry"> <div class="refnamediv">  <h1 class="refname">oci_bind_by_name</h1>  <p class="verinfo">(PHP 5, PHP 7, PHP 8, PECL OCI8 &gt;= 1.1.0)</p><p class="refpurpose"><span class="refname">oci_bind_by_name</span> &mdash; <span class="dc-title">绑定 PHP 变量到 Oracle 位置标志符</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.oci-bind-by-name-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>oci_bind_by_name</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">resource</span> <span class="parameter" style="color:#3A95FF">$statement</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$param</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.declarations.php#language.types.declarations.mixed" class="type mixed" style="color:#EAB766">mixed</a></span> <span class="parameter" style="color:#3A95FF">&$var</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$max_length</span><span class="initializer"> = -1</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$type</span><span class="initializer"> = 0</span></span><br>): <span class="type" style="color:#EAB766">bool</span></div>  <p class="para rdfs-comment">   将 PHP 变量 <span class="parameter" style="color:#3A95FF">var</span> 绑定到 Oracle 位置占位符 <span class="parameter" style="color:#3A95FF">param</span>。绑定对   Oracle 数据库性能很重要，同时也是避免 SQL 注入安全问题的一种方式。  </p>  <p class="para">    绑定允许数据库重用语句上下文和以前执行语句的缓存，即使另一个用户或进程最初（originally）执行它也是如此。绑定减少了 SQL    注入问题，因为与绑定变量关联的数据永远不会被视为 SQL 语句的一部分。不需要引用或转义。  </p>  <p class="para">    已经绑定的 PHP 变量可以改变，语句重新执行，而不需要重新解析语句或重新绑定。  </p>  <p class="para">    在 Oracle 中，绑定变量通常分为用于传递到数据库的值的 <span>IN</span> 绑定和用于返回给 PHP 的值的 <span>OUT</span>    绑定。绑定变量可以同时为 <span>IN</span> 和 <span>OUT</span>。绑定变量是用于输入还是输出是在运行时确定的。  </p>  <p class="para">    使用 <span>OUT</span> 绑定时必须指定 <span class="parameter" style="color:#3A95FF">max_length</span> 以便 PHP 分配足够的内存来保存返回值。  </p>  <p class="para">    对于 <span>IN</span> 绑定，如果使用不同的 PHP 变量值多次重新执行该语句，建议设置 <span class="parameter" style="color:#3A95FF">max_length</span> 长度。否则    Oracle 可能会将数据截断为初始 PHP 变量值的长度。如果不知道最大长度是多少，则在每次调用 <span class="function">{@link oci_execute()}</span> 之前使用当前数据大小重新调用    <span class="function"><strong style="color:#CC7832">oci_bind_by_name()</strong></span>。绑定不必要的大长度将对数据库中的进程内存产生影响。  </p>  <p class="para">    绑定调用告诉 Oracle 从哪个内存地址读取数据。对于 <span>IN</span> 绑定，调用 <span class="function">{@link oci_execute()}</span>    时地址需要包含有效数据。这意味着变量绑定必须保留在作用域内直到执行。否则，可能会出现意外结果或错误，例如“ORA-01460：未实现或不合理的转换请求”。对于    <span>OUT</span> 绑定，一个问题是没有在 PHP 变量中设置值。  </p>  <p class="para">    对于重复执行的语句，永远不变的绑定值可能会降低 Oracle 优化器选择最佳语句执行计划的能力。很少重新执行的长时间运行的语句可能无法从绑定中获益。但是，在这两种情况下，绑定可能比将字符串连接到    SQL 语句中更安全，因为如果连接未过滤的用户文本，这可能会带来安全风险。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.oci-bind-by-name-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">statement</span></dt>     <dd>      <p class="para">       有效的 OCI8 语句标识符。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">param</span></dt>     <dd>      <p class="para">       语句中使用以冒号为前缀的绑定变量占位符。冒号在 <span class="parameter" style="color:#3A95FF">param</span> 中是可选的。Oracle 不使用问号作为占位符。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">var</span></dt>     <dd>      <p class="para">       与 <span class="parameter" style="color:#3A95FF">param</span> 关联的 PHP 变量      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">max_length</span></dt>     <dd>      <p class="para">       设置数据的最大长度。如果将其设置为 -1，则此函数将使用 <span class="parameter" style="color:#3A95FF">var</span>       的当前长度来设置最大长度。在这种情况下，<span class="parameter" style="color:#3A95FF">var</span> 必须存在并且在调用       <span class="function"><strong style="color:#CC7832">oci_bind_by_name()</strong></span> 时包含数据。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">type</span></dt>     <dd>      <p class="para">       Oracle 处理数据的数据类型。使用的默认 <span class="parameter" style="color:#3A95FF">type</span> 是 <strong><span>SQLT_CHR</span></strong>。可能的话，Oracle       将在此类型和数据库列（或 PL/SQL 变量类型）之间转换数据。      </p>      <p class="para">       如果要绑定抽象数据类型（LOB/ROWID/BFILE），需要先用 <span class="function">{@link oci_new_descriptor()}</span>       函数分配空间。<span class="parameter" style="color:#3A95FF">length</span> 没有用于抽象数据类型，应被设为 -1。      </p>      <p class="para">       <span class="parameter" style="color:#3A95FF">type</span> 的可能值为：       <ul class="itemizedlist">        <li class="listitem">         <p class="para">          <strong><span>SQLT_BFILEE</span></strong> 或 <strong><span>OCI_B_BFILE</span></strong>           对应 BFILE；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_CFILEE</span></strong> 或 <strong><span>OCI_B_CFILEE</span></strong> 对应 CFILE；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_CLOB</span></strong> 或 <strong><span>OCI_B_CLOB</span></strong> 对应 CLOB；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_BLOB</span></strong> 或 <strong><span>OCI_B_BLOB</span></strong> 对应 BLOB；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_RDD</span></strong> 或 <strong><span>OCI_B_ROWID</span></strong> 对应 ROWID；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_NTY</span></strong> 或 <strong><span>OCI_B_NTY</span></strong> 对应命名数据类型；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_INT</span></strong> 或 <strong><span>OCI_B_INT</span></strong> 对应整型；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_CHR</span></strong> 对应 VARCHAR；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_BIN</span></strong> 或 <strong><span>OCI_B_BIN</span></strong>          对应 RAW 列；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_LNG</span></strong> 对应 LONG 列；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_LBI</span></strong> 对应 LONG RAW 列；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_RSET</span></strong> 对应使用 <span class="function">{@link oci_new_cursor()}</span> 创建的游标；         </p>        </li>        <li class="listitem">         <p class="para">          <strong><span>SQLT_BOL</span></strong> 或 <strong><span>OCI_B_BOL</span></strong> 对应 PL/SQL BOOLEAN（需要 Oracle Database 12c）         </p>        </li>       </ul>      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.oci-bind-by-name-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   成功时返回 <strong><span>true</span></strong>， 或者在失败时返回 <strong><span>false</span></strong>。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.oci-bind-by-name-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="example-5429">    <p><strong>示例 #1 使用 <span class="function"><strong style="color:#CC7832">oci_bind_by_name()</strong></span> 插入数据</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">// Create the table with:<br />//   CREATE TABLE mytab (id NUMBER, text VARCHAR2(40));<br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$m </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">,</span><span style="color: #DD0000">"INSERT INTO mytab (id, text) VALUES(:id_bv, :text_bv)"</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$id </span><span style="color: #007700">= </span><span style="color: #9876AA">1</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$text </span><span style="color: #007700">= </span><span style="color: #DD0000">"Data to insert     "</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":id_bv"</span><span style="color: #007700">, </span><span style="color: #9876AA">$id</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":text_bv"</span><span style="color: #007700">, </span><span style="color: #9876AA">$text</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Table now contains: 1, 'Data to insert     '<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span>  <p class="para">   <div class="example" id="example-5432">    <p><strong>示例 #2 一次绑定多次执行</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">// Create the table with:<br />//   CREATE TABLE mytab (id NUMBER);<br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$m </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$a </span><span style="color: #007700">= array(</span><span style="color: #9876AA">1</span><span style="color: #007700">,</span><span style="color: #9876AA">3</span><span style="color: #007700">,</span><span style="color: #9876AA">5</span><span style="color: #007700">,</span><span style="color: #9876AA">7</span><span style="color: #007700">,</span><span style="color: #9876AA">11</span><span style="color: #007700">);  </span><span style="color: #FF8000">// data to insert<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'INSERT INTO mytab (id) VALUES (:bv)'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':bv'</span><span style="color: #007700">, </span><span style="color: #9876AA">$v</span><span style="color: #007700">, </span><span style="color: #9876AA">20</span><span style="color: #007700">);<br />foreach (</span><span style="color: #9876AA">$a </span><span style="color: #007700">as </span><span style="color: #9876AA">$v</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$r </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_DEFAULT</span><span style="color: #007700">);  </span><span style="color: #FF8000">// don't auto commit<br /></span><span style="color: #007700">}<br /></span><span style="color: #9876AA">oci_commit</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">); </span><span style="color: #FF8000">// commit everything at once<br /><br />// Table contains five rows: 1, 3, 5, 7, 11<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="example-5435">    <p><strong>示例 #3 使用 <span>foreach</span> 循环绑定</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$m </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT * FROM departments WHERE department_name = :dname AND location_id = :loc'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$ba </span><span style="color: #007700">= array(</span><span style="color: #DD0000">':dname' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'IT Support'</span><span style="color: #007700">, </span><span style="color: #DD0000">':loc' </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">1700</span><span style="color: #007700">);<br /><br />foreach (</span><span style="color: #9876AA">$ba </span><span style="color: #007700">as </span><span style="color: #9876AA">$key </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">$val</span><span style="color: #007700">) {<br /><br />    </span><span style="color: #FF8000">// oci_bind_by_name($stid, $key, $val) does not work<br />    // because it binds each placeholder to the same location: $val<br />    // instead use the actual location of the data: $ba[$key]<br />    </span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">$key</span><span style="color: #007700">, </span><span style="color: #9876AA">$ba</span><span style="color: #007700">[</span><span style="color: #9876AA">$key</span><span style="color: #007700">]);<br />}<br /><br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #9876AA">OCI_RETURN_NULLS</span><span style="color: #007700">);<br />foreach (</span><span style="color: #9876AA">$row </span><span style="color: #007700">as </span><span style="color: #9876AA">$item</span><span style="color: #007700">) {<br />    print </span><span style="color: #9876AA">$item</span><span style="color: #007700">.</span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="example-5438">    <p><strong>示例 #4 在 WHERE 子句中绑定</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"hr"</span><span style="color: #007700">, </span><span style="color: #DD0000">"hrpwd"</span><span style="color: #007700">, </span><span style="color: #DD0000">"localhost/XE"</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$m </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT last_name FROM employees WHERE department_id = :didbv ORDER BY last_name'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$didbv </span><span style="color: #007700">= </span><span style="color: #9876AA">60</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':didbv'</span><span style="color: #007700">, </span><span style="color: #9876AA">$didbv</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br />while ((</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">)) != </span><span style="color: #9876AA">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'LAST_NAME'</span><span style="color: #007700">] .</span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">// Output is<br />//    Austin<br />//    Ernst<br />//    Hunold<br />//    Lorentz<br />//    Pataballa<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="example-5441">    <p><strong>示例 #5 使用 LIKE 子句绑定</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$m </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">// Find all cities that begin with 'South'<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT city FROM locations WHERE city LIKE :bv"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$city </span><span style="color: #007700">= </span><span style="color: #DD0000">'South%'</span><span style="color: #007700">;  </span><span style="color: #FF8000">// '%' is a wildcard in SQL<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":bv"</span><span style="color: #007700">, </span><span style="color: #9876AA">$city</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_fetch_all</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">$res</span><span style="color: #007700">);<br /><br />foreach (</span><span style="color: #9876AA">$res</span><span style="color: #007700">[</span><span style="color: #DD0000">'CITY'</span><span style="color: #007700">] as </span><span style="color: #9876AA">$c</span><span style="color: #007700">) {<br />    print </span><span style="color: #9876AA">$c </span><span style="color: #007700">. </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #FF8000">// Output is<br />//   South Brunswick<br />//   South San Francisco<br />//   Southlake<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="example-5444">    <p><strong>示例 #6 与 REGEXP_LIKE 绑定</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$m </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">// Find all cities that contain 'ing'<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT city FROM locations WHERE REGEXP_LIKE(city, :bv)"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$city </span><span style="color: #007700">= </span><span style="color: #DD0000">'.*ing.*'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":bv"</span><span style="color: #007700">, </span><span style="color: #9876AA">$city</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_fetch_all</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">$res</span><span style="color: #007700">);<br /><br />foreach (</span><span style="color: #9876AA">$res</span><span style="color: #007700">[</span><span style="color: #DD0000">'CITY'</span><span style="color: #007700">] as </span><span style="color: #9876AA">$c</span><span style="color: #007700">) {<br />    print </span><span style="color: #9876AA">$c </span><span style="color: #007700">. </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #FF8000">// Output is<br />//   Beijing<br />//   Singapore<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">    对于少量固定数量的 IN 子句条件，请使用单独的绑定变量。运行时未知的值可以设置为 NULL。这允许所有应用程序用户使用单个语句，从而最大限度地提高 Oracle 数据库缓存效率。  </p>  <p class="para">   <div class="example" id="example-5447">    <p><strong>示例 #7 在 IN 子句中绑定多个值</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$m </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT last_name FROM employees WHERE employee_id in (:e1, :e2, :e3)'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$mye1 </span><span style="color: #007700">= </span><span style="color: #9876AA">103</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$mye2 </span><span style="color: #007700">= </span><span style="color: #9876AA">104</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$mye3 </span><span style="color: #007700">= </span><span style="color: #9876AA">NULL</span><span style="color: #007700">; </span><span style="color: #FF8000">// pretend we were not given this value<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':e1'</span><span style="color: #007700">, </span><span style="color: #9876AA">$mye1</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':e2'</span><span style="color: #007700">, </span><span style="color: #9876AA">$mye2</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':e3'</span><span style="color: #007700">, </span><span style="color: #9876AA">$mye3</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_fetch_all</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">$res</span><span style="color: #007700">);<br />foreach (</span><span style="color: #9876AA">$res</span><span style="color: #007700">[</span><span style="color: #DD0000">'LAST_NAME'</span><span style="color: #007700">] as </span><span style="color: #9876AA">$name</span><span style="color: #007700">) {<br />    print </span><span style="color: #9876AA">$name </span><span style="color: #007700">.</span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">// Output is<br />//   Ernst<br />//   Hunold<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="example-5450">    <p><strong>示例 #8 Binding a ROWID returned by a query</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">// Create the table with:<br />//   CREATE TABLE mytab (id NUMBER, salary NUMBER, name VARCHAR2(40));<br />//   INSERT INTO mytab (id, salary, name) VALUES (1, 100, 'Chris');<br />//   COMMIT;<br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$m </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'SELECT ROWID, name FROM mytab WHERE id = :id_bv FOR UPDATE'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$id </span><span style="color: #007700">= </span><span style="color: #9876AA">1</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':id_bv'</span><span style="color: #007700">, </span><span style="color: #9876AA">$id</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #9876AA">OCI_RETURN_NULLS</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$rid </span><span style="color: #007700">= </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'ROWID'</span><span style="color: #007700">];<br /></span><span style="color: #9876AA">$name </span><span style="color: #007700">= </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'NAME'</span><span style="color: #007700">];<br /><br /></span><span style="color: #FF8000">// Change name to upper case &amp; save the changes<br /></span><span style="color: #9876AA">$name </span><span style="color: #007700">= </span><span style="color: #9876AA">strtoupper</span><span style="color: #007700">(</span><span style="color: #9876AA">$name</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'UPDATE mytab SET name = :n_bv WHERE ROWID = :r_bv'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':n_bv'</span><span style="color: #007700">, </span><span style="color: #9876AA">$name</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':r_bv'</span><span style="color: #007700">, </span><span style="color: #9876AA">$rid</span><span style="color: #007700">, -</span><span style="color: #9876AA">1</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_B_ROWID</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// The table now contains 1, 100, CHRIS<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="example-5453">    <p><strong>示例 #9 INSERT 时绑定 ROWID</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">// This example inserts an id &amp; name, and then updates the salary<br />// Create the table with:<br />//   CREATE TABLE mytab (id NUMBER, salary NUMBER, name VARCHAR2(40));<br />//<br />// Based on original ROWID example by thies at thieso dot net (980221)<br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$m </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$m</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">"INSERT INTO mytab (id, name) VALUES(:id_bv, :name_bv)<br />        RETURNING ROWID INTO :rid"</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$ins_stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$rowid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_new_descriptor</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_D_ROWID</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$ins_stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":id_bv"</span><span style="color: #007700">,   </span><span style="color: #9876AA">$id</span><span style="color: #007700">,    </span><span style="color: #9876AA">10</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$ins_stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":name_bv"</span><span style="color: #007700">, </span><span style="color: #9876AA">$name</span><span style="color: #007700">,  </span><span style="color: #9876AA">32</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$ins_stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":rid"</span><span style="color: #007700">,     </span><span style="color: #9876AA">$rowid</span><span style="color: #007700">, -</span><span style="color: #9876AA">1</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_B_ROWID</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">"UPDATE mytab SET salary = :salary WHERE ROWID = :rid"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$upd_stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$upd_stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":rid"</span><span style="color: #007700">, </span><span style="color: #9876AA">$rowid</span><span style="color: #007700">, -</span><span style="color: #9876AA">1</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_B_ROWID</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$upd_stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":salary"</span><span style="color: #007700">, </span><span style="color: #9876AA">$salary</span><span style="color: #007700">,   </span><span style="color: #9876AA">32</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// ids and names to insert<br /></span><span style="color: #9876AA">$data </span><span style="color: #007700">= array(</span><span style="color: #9876AA">1111 </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Larry"</span><span style="color: #007700">,<br />              </span><span style="color: #9876AA">2222 </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Bill"</span><span style="color: #007700">,<br />              </span><span style="color: #9876AA">3333 </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Jim"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Salary of each person<br /></span><span style="color: #9876AA">$salary </span><span style="color: #007700">= </span><span style="color: #9876AA">10000</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// Insert and immediately update each row<br /></span><span style="color: #007700">foreach (</span><span style="color: #9876AA">$data </span><span style="color: #007700">as </span><span style="color: #9876AA">$id </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">$name</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$ins_stid</span><span style="color: #007700">);<br />    </span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$upd_stid</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$rowid</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">free</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$upd_stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$ins_stid</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Show the new rows<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT * FROM mytab"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br />while (</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #9876AA">OCI_RETURN_NULLS</span><span style="color: #007700">)) {<br />    </span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$row</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="oauth.setrsacertificate.example">    <p><strong>示例 #10 为 PL/SQL 存储函数绑定</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">//  Before running the PHP program, create a stored function in<br />//  SQL*Plus or SQL Developer:<br />//<br />//  CREATE OR REPLACE FUNCTION myfunc(p IN NUMBER) RETURN NUMBER AS<br />//  BEGIN<br />//      RETURN p * 3;<br />//  END;<br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$p </span><span style="color: #007700">= </span><span style="color: #9876AA">8</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'begin :r := myfunc(:p); end;'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':p'</span><span style="color: #007700">, </span><span style="color: #9876AA">$p</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// The return value is an OUT bind. The default type will be a string<br />// type so binding a length 40 means that at most 40 digits will be<br />// returned.<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':r'</span><span style="color: #007700">, </span><span style="color: #9876AA">$r</span><span style="color: #007700">, </span><span style="color: #9876AA">40</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br />print </span><span style="color: #DD0000">"</span><span style="color: #9876AA">$r</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;   </span><span style="color: #FF8000">// prints 24<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">  <div class="example" id="example-5459">   <p><strong>示例 #11 为 PL/SQL 存储过程绑定参数</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">//  Before running the PHP program, create a stored procedure in<br />//  SQL*Plus or SQL Developer:<br />//<br />//  CREATE OR REPLACE PROCEDURE myproc(p1 IN NUMBER, p2 OUT NUMBER) AS<br />//  BEGIN<br />//      p2 := p1 * 2;<br />//  END;<br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$p1 </span><span style="color: #007700">= </span><span style="color: #9876AA">8</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'begin myproc(:p1, :p2); end;'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':p1'</span><span style="color: #007700">, </span><span style="color: #9876AA">$p1</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// The second procedure parameter is an OUT bind. The default type<br />// will be a string type so binding a length 40 means that at most 40<br />// digits will be returned.<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':p2'</span><span style="color: #007700">, </span><span style="color: #9876AA">$p2</span><span style="color: #007700">, </span><span style="color: #9876AA">40</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br />print </span><span style="color: #DD0000">"</span><span style="color: #9876AA">$p2</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;   </span><span style="color: #FF8000">// prints 16<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">  <div class="example" id="example-5462">   <p><strong>示例 #12 绑定 CLOB 列</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">// Before running, create the table:<br />//     CREATE TABLE mytab (mykey NUMBER, myclob CLOB);<br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$mykey </span><span style="color: #007700">= </span><span style="color: #9876AA">12343</span><span style="color: #007700">;  </span><span style="color: #FF8000">// arbitrary key for this example;<br /><br /></span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">"INSERT INTO mytab (mykey, myclob)<br />        VALUES (:mykey, EMPTY_CLOB())<br />        RETURNING myclob INTO :myclob"</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$clob </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_new_descriptor</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_D_LOB</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":mykey"</span><span style="color: #007700">, </span><span style="color: #9876AA">$mykey</span><span style="color: #007700">, </span><span style="color: #9876AA">5</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":myclob"</span><span style="color: #007700">, </span><span style="color: #9876AA">$clob</span><span style="color: #007700">, -</span><span style="color: #9876AA">1</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_B_CLOB</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_DEFAULT</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$clob</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">save</span><span style="color: #007700">(</span><span style="color: #DD0000">"A very long string"</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">oci_commit</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Fetching CLOB data<br /><br /></span><span style="color: #9876AA">$query </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT myclob FROM mytab WHERE mykey = :mykey'</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse </span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$query</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">":mykey"</span><span style="color: #007700">, </span><span style="color: #9876AA">$mykey</span><span style="color: #007700">, </span><span style="color: #9876AA">5</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br />print </span><span style="color: #DD0000">'&lt;table border="1"&gt;'</span><span style="color: #007700">;<br />while (</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #9876AA">OCI_RETURN_LOBS</span><span style="color: #007700">)) {<br />    print </span><span style="color: #DD0000">'&lt;tr&gt;&lt;td&gt;'</span><span style="color: #007700">.</span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'MYCLOB'</span><span style="color: #007700">].</span><span style="color: #DD0000">'&lt;/td&gt;&lt;/tr&gt;'</span><span style="color: #007700">;<br />    </span><span style="color: #FF8000">// In a loop, freeing the large variable before the 2nd fetch reduces PHP's peak memory usage<br />    </span><span style="color: #007700">unset(</span><span style="color: #9876AA">$row</span><span style="color: #007700">);  <br />}<br />print </span><span style="color: #DD0000">'&lt;/table&gt;'</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>   </div>  </div>  </p>  <p class="para">  <div class="example" id="example-5465">   <p><strong>示例 #13 绑定 PL/SQL BOOLEAN</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">]), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$plsql </span><span style="color: #007700">= <br />  </span><span style="color: #DD0000">"begin<br />    :output1 := true;<br />    :output2 := false;<br />   end;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$s </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$c</span><span style="color: #007700">, </span><span style="color: #9876AA">$plsql</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$s</span><span style="color: #007700">, </span><span style="color: #DD0000">':output1'</span><span style="color: #007700">, </span><span style="color: #9876AA">$output1</span><span style="color: #007700">, -</span><span style="color: #9876AA">1</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_B_BOL</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$s</span><span style="color: #007700">, </span><span style="color: #DD0000">':output2'</span><span style="color: #007700">, </span><span style="color: #9876AA">$output2</span><span style="color: #007700">, -</span><span style="color: #9876AA">1</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_B_BOL</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$s</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$output1</span><span style="color: #007700">);  </span><span style="color: #FF8000">// true<br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$output2</span><span style="color: #007700">);  </span><span style="color: #FF8000">// false<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>   </div>  </div>  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 notes" id="refsect1-function.oci-bind-by-name-notes">  <h3 class="title">注释</h3>  <div class="warning"><strong class="warning">警告</strong>   <p class="para">    不要同时使用 <span class="function">{@link addslashes()}</span> 和 <span class="function"><strong style="color:#CC7832">oci_bind_by_name()</strong></span>，因为不需要引号。任何应用的引号都将写入数据库，因为    <span class="function"><strong style="color:#CC7832">oci_bind_by_name()</strong></span> 逐字插入数据并且不会删除引号或转义字符。   </p>  </div>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    如果将字符串绑定到 <span>WHERE</span> 子句中的 <span>CHAR</span> 列，请记住 Oracle 对 <span>CHAR</span>    列使用空白填充的比较语义。PHP 变量使用空格填充到与成功的 <span>WHERE</span> 子句的列相同的宽度。   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">     PHP <span class="parameter" style="color:#3A95FF">var</span> 参数是引用。某些形式的循环无法按预期工作：   </p>   <div class="informalexample">     <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #007700">foreach (</span><span style="color: #9876AA">$myarray </span><span style="color: #007700">as </span><span style="color: #9876AA">$key </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">$value</span><span style="color: #007700">)  {<br />    </span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">$key</span><span style="color: #007700">, </span><span style="color: #9876AA">$value</span><span style="color: #007700">);<br />}<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>     </div>   </div>   <p class="para">    这会将每个键绑定到 $value 的位置，因此所有绑定变量最终都指向最后一个循环迭代的值。应该使用以下内容：   </p>   <div class="informalexample">     <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #007700">foreach (</span><span style="color: #9876AA">$myarray </span><span style="color: #007700">as </span><span style="color: #9876AA">$key </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">$value</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">$key</span><span style="color: #007700">, </span><span style="color: #9876AA">$myarray</span><span style="color: #007700">[</span><span style="color: #9876AA">$key</span><span style="color: #007700">]);<br />}<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>     </div>   </div>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.oci-bind-by-name-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link oci_bind_array_by_name()} - Binds a PHP array to an Oracle PL/SQL array parameter</span></li>    <li class="member"><span class="function">{@link oci_parse()} - 预处理用于执行的 Oracle 语句</span></li>   </ul>  </span> </div></div>