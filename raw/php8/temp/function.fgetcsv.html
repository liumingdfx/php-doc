<div id="function.fgetcsv" class="refentry"> <div class="refnamediv">  <h1 class="refname">fgetcsv</h1>  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">fgetcsv</span> &mdash; <span class="dc-title">从文件指针中读入一行并解析 CSV 字段</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.fgetcsv-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>fgetcsv</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">resource</span> <span class="parameter" style="color:#3A95FF">$stream</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">int</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$length</span><span class="initializer"> = <strong><span>null</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$separator</span><span class="initializer"> = &quot;,&quot;</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$enclosure</span><span class="initializer"> = &quot;\&quot;&quot;</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$escape</span><span class="initializer"> = &quot;\\&quot;</span></span><br>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   和 <span class="function">{@link fgets()}</span> 类似，只除了   <span class="function"><strong style="color:#CC7832">fgetcsv()</strong></span> 解析读入的行并找出 <abbr title="Comma Separated Value">CSV</abbr>   格式的字段然后返回一个包含这些字段的数组。  </p>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    使用此函数需要考虑区域设置。例如，如果 <span>LC_CTYPE</span> 是    <span>en_US.UTF-8</span>，通过该函数可能会导致对文件中的单字节编码读取错误。   </p>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.fgetcsv-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">stream</span></dt>     <dd>      <p class="para">       一个由 <span class="function">{@link fopen()}</span>、<span class="function">{@link popen()}</span> 或       <span class="function">{@link fsockopen()}</span> 产生的有效文件指针。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">length</span></dt>     <dd>      <p class="para">       必须大于在 CVS 文件（允许尾随行尾字符）中找到的最长行（以字符为单位）。否则，该行将拆分为       <span class="parameter" style="color:#3A95FF">length</span> 字符的块，除非拆分发生在环绕字符内。      </p>      <p class="para">       忽略此参数（或者设为 0 或者在 PHP 8.0.0 及以后的版本中设为 <strong><span>null</span></strong>）行的最大长度将不受限制，速度稍慢。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">separator</span></dt>     <dd>      <p class="para">       可选的 <span class="parameter" style="color:#3A95FF">separator</span> 参数，设置字段分隔符（仅一个单字节字符）。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">enclosure</span></dt>     <dd>      <p class="para">       可选的 <span class="parameter" style="color:#3A95FF">enclosure</span> 参数，设置字段环绕符（仅一个单字节字符）。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">escape</span></dt>     <dd>      <p class="para">       可选的 <span class="parameter" style="color:#3A95FF">escape</span>       参数，设置转义字符（最多一个单字节字符）。空字符串（<span>&quot;&quot;</span>）禁用所有的转义机制。      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:        <span class="simpara">        Usually an <span class="parameter" style="color:#3A95FF">enclosure</span> character is escaped inside        a field by doubling it; however, the <span class="parameter" style="color:#3A95FF">escape</span>        character can be used as an alternative. So for the default parameter        values <span>&quot;&quot;</span> and <span>\&quot;</span> have the same        meaning. Other than allowing to escape the        <span class="parameter" style="color:#3A95FF">enclosure</span> character the        <span class="parameter" style="color:#3A95FF">escape</span> character has no special meaning; it isn&#039;t        even meant to escape itself.       </span>      </p></blockquote>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.fgetcsv-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   成功时返回包含读取字段的索引数组， 或者在失败时返回 <strong><span>false</span></strong>。  </p>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">        CSV 文件中的空行将被返回为一个包含有单个 <span class="type" style="color:#EAB766">null</span> 字段的数组，不会被当成错误。   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>: <span class="simpara">在读取在 Macintosh 电脑中或由其创建的文件时， 如果 PHP不能正确的识别行结束符，启用运行时配置可选项 <a href="https://www.php.net/manual/zh/filesystem.configuration.php#ini.auto-detect-line-endings" class="link">auto_detect_line_endings</a>也许可以解决此问题。</span></p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.fgetcsv-changelog">  <h3 class="title">更新日志</h3>  <span>   <table class="doctable informaltable">         <thead>      <tr>       <th>版本</th>       <th>说明</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td>8.0.0</td>       <td>        现在 <span class="parameter" style="color:#3A95FF">length</span> 允许为 null.       </td>      </tr>      <tr>       <td>7.4.0</td>       <td>        <span class="parameter" style="color:#3A95FF">escape</span> 参数也接受空字符串来禁用所有的转义机制。       </td>      </tr>     </tbody>       </table>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.fgetcsv-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 读取并显示 CSV 文件的整个内容</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$row </span><span style="color: #007700">= </span><span style="color: #9876AA">1</span><span style="color: #007700">;<br />if ((</span><span style="color: #9876AA">$handle </span><span style="color: #007700">= </span><span style="color: #9876AA">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">"test.csv"</span><span style="color: #007700">, </span><span style="color: #DD0000">"r"</span><span style="color: #007700">)) !== </span><span style="color: #9876AA">FALSE</span><span style="color: #007700">) {<br />    while ((</span><span style="color: #9876AA">$data </span><span style="color: #007700">= </span><span style="color: #9876AA">fgetcsv</span><span style="color: #007700">(</span><span style="color: #9876AA">$handle</span><span style="color: #007700">, </span><span style="color: #9876AA">1000</span><span style="color: #007700">, </span><span style="color: #DD0000">","</span><span style="color: #007700">)) !== </span><span style="color: #9876AA">FALSE</span><span style="color: #007700">) {<br />        </span><span style="color: #9876AA">$num </span><span style="color: #007700">= </span><span style="color: #9876AA">count</span><span style="color: #007700">(</span><span style="color: #9876AA">$data</span><span style="color: #007700">);<br />        echo </span><span style="color: #DD0000">"&lt;p&gt; </span><span style="color: #9876AA">$num</span><span style="color: #DD0000"> fields in line </span><span style="color: #9876AA">$row</span><span style="color: #DD0000">: &lt;br /&gt;&lt;/p&gt;\n"</span><span style="color: #007700">;<br />        </span><span style="color: #9876AA">$row</span><span style="color: #007700">++;<br />        for (</span><span style="color: #9876AA">$c</span><span style="color: #007700">=</span><span style="color: #9876AA">0</span><span style="color: #007700">; </span><span style="color: #9876AA">$c </span><span style="color: #007700">&lt; </span><span style="color: #9876AA">$num</span><span style="color: #007700">; </span><span style="color: #9876AA">$c</span><span style="color: #007700">++) {<br />            echo </span><span style="color: #9876AA">$data</span><span style="color: #007700">[</span><span style="color: #9876AA">$c</span><span style="color: #007700">] . </span><span style="color: #DD0000">"&lt;br /&gt;\n"</span><span style="color: #007700">;<br />        }<br />    }<br />    </span><span style="color: #9876AA">fclose</span><span style="color: #007700">(</span><span style="color: #9876AA">$handle</span><span style="color: #007700">);<br />}<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.fgetcsv-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link str_getcsv()} - 解析 CSV 字符串为一个数组</span></li>    <li class="member"><span class="function">{@link explode()} - 使用一个字符串分割另一个字符串</span></li>    <li class="member"><span class="function">{@link file()} - 把整个文件读入一个数组中</span></li>    <li class="member"><span class="function">{@link pack()} - 将数据打包成二进制字符串</span></li>    <li class="member"><span class="function">{@link fputcsv()} - 将行格式化为 CSV 并写入文件指针</span></li>   </ul>  </span> </div></div>