<div id="solrquery.collapse" class="refentry"> <div class="refnamediv">  <h1 class="refname">SolrQuery::collapse</h1>  <p class="verinfo">(No version information available, might only be in Git)</p><p class="refpurpose"><span class="refname">SolrQuery::collapse</span> &mdash; <span class="dc-title">Collapses the result set to a single document per group</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-solrquery.collapse-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><strong>SolrQuery::collapse</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">{@link SolrCollapseFunction}</span> <span class="parameter" style="color:#3A95FF">$collapseFunction</span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.solrquery.php" class="type SolrQuery" style="color:#EAB766">SolrQuery</a></span></div>  <p class="para rdfs-comment">     Collapses the result set to a single document per group before it forwards     the result set to the rest of the search components.  </p>  <p class="para">     So all downstream components (faceting, highlighting, etc...) will work with     the collapsed result set.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-solrquery.collapse-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">collapseFunction</span></dt>     <dd>      <p class="para">                </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-solrquery.collapse-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   Returns the current <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.solrquery.php" class="type SolrQuery" style="color:#EAB766">SolrQuery</a></span> object  </p> </div><br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-solrquery.collapse-examples">  <h3 class="title">示例</h3>  <div class="example" id="">   <p><strong>示例 #1 <span class="methodname" style="color:#CC7832"><strong>SolrQuery::collapse()</strong></span> example</strong></p>   <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #007700">include </span><span style="color: #DD0000">"bootstrap.php"</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$options </span><span style="color: #007700">= array<br />(<br />        </span><span style="color: #DD0000">'hostname' </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">SOLR_SERVER_HOSTNAME</span><span style="color: #007700">,<br />        </span><span style="color: #DD0000">'login'    </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">SOLR_SERVER_USERNAME</span><span style="color: #007700">,<br />        </span><span style="color: #DD0000">'password' </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">SOLR_SERVER_PASSWORD</span><span style="color: #007700">,<br />        </span><span style="color: #DD0000">'port'     </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">SOLR_SERVER_PORT</span><span style="color: #007700">,<br />        </span><span style="color: #DD0000">'path'     </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">SOLR_SERVER_PATH<br /></span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$client </span><span style="color: #007700">= new </span><span style="color: #9876AA">SolrClient</span><span style="color: #007700">(</span><span style="color: #9876AA">$options</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$query </span><span style="color: #007700">= new </span><span style="color: #9876AA">SolrQuery</span><span style="color: #007700">(</span><span style="color: #DD0000">'*:*'</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$collapseFunction </span><span style="color: #007700">= new </span><span style="color: #9876AA">SolrCollapseFunction</span><span style="color: #007700">(</span><span style="color: #DD0000">'manu_id_s'</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$collapseFunction<br /></span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">setSize</span><span style="color: #007700">(</span><span style="color: #9876AA">2</span><span style="color: #007700">)<br />-&gt;</span><span style="color: #9876AA">setNullPolicy</span><span style="color: #007700">(</span><span style="color: #9876AA">SolrCollapseFunction</span><span style="color: #007700">::</span><span style="color: #9876AA">NULLPOLICY_IGNORE</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$query<br /></span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">collapse</span><span style="color: #007700">(</span><span style="color: #9876AA">$collapseFunction</span><span style="color: #007700">)<br />-&gt;</span><span style="color: #9876AA">setRows</span><span style="color: #007700">(</span><span style="color: #9876AA">4</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$queryResponse </span><span style="color: #007700">= </span><span style="color: #9876AA">$client</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">query</span><span style="color: #007700">(</span><span style="color: #9876AA">$query</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$response </span><span style="color: #007700">= </span><span style="color: #9876AA">$queryResponse</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">getResponse</span><span style="color: #007700">();<br /><br /></span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$response</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>   </div>   <div class="example-contents"><p>以上示例的输出类似于：</p></div>        <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;">            <div class="cdata"><span>SolrObject Object<br>(<br>    [responseHeader] =&gt; SolrObject Object<br>        (<br>            [status] =&gt; 0<br>            [QTime] =&gt; 1<br>            [params] =&gt; SolrObject Object<br>                (<br>                    [q] =&gt; *:*<br>                    [indent] =&gt; on<br>                    [fq] =&gt; {!collapse field=manu_id_s size=2 nullPolicy=ignore}<br>                    [rows] =&gt; 4<br>                    [version] =&gt; 2.2<br>                    [wt] =&gt; xml<br>                )<br><br>        )<br><br>    [response] =&gt; SolrObject Object<br>        (<br>            [numFound] =&gt; 14<br>            [start] =&gt; 0<br>            [docs] =&gt; Array<br>                (<br>                    [0] =&gt; SolrObject Object<br>                        (<br>                            [id] =&gt; SP2514N<br>                            [name] =&gt; Array<br>                                (<br>                                    [0] =&gt; Samsung SpinPoint P120 SP2514N - hard drive - 250 GB - ATA-133<br>                                )<br><br>                            [manu] =&gt; Array<br>                                (<br>                                    [0] =&gt; Samsung Electronics Co. Ltd.<br>                                )<br><br>                            [manu_id_s] =&gt; samsung<br>                            [cat] =&gt; Array<br>                                (<br>                                    [0] =&gt; electronics<br>                                    [1] =&gt; hard drive<br>                                )<br><br>                            [features] =&gt; Array<br>                                (<br>                                    [0] =&gt; 7200RPM, 8MB cache, IDE Ultra ATA-133<br>                                    [1] =&gt; NoiseGuard, SilentSeek technology, Fluid Dynamic Bearing (FDB) motor<br>                                )<br><br>                            [price] =&gt; Array<br>                                (<br>                                    [0] =&gt; 92<br>                                )<br><br>                            [popularity] =&gt; Array<br>                                (<br>                                    [0] =&gt; 6<br>                                )<br><br>                            [inStock] =&gt; Array<br>                                (<br>                                    [0] =&gt; 1<br>                                )<br><br>                            [manufacturedate_dt] =&gt; 2006-02-13T15:26:37Z<br>                            [store] =&gt; Array<br>                                (<br>                                    [0] =&gt; 35.0752,-97.032<br>                                )<br><br>                            [_version_] =&gt; 1510294336412057600<br>                        )<br><br>                    [1] =&gt; SolrObject Object<br>                        (<br>                            [id] =&gt; 6H500F0<br>                            [name] =&gt; Array<br>                                (<br>                                    [0] =&gt; Maxtor DiamondMax 11 - hard drive - 500 GB - SATA-300<br>                                )<br><br>                            [manu] =&gt; Array<br>                                (<br>                                    [0] =&gt; Maxtor Corp.<br>                                )<br><br>                            [manu_id_s] =&gt; maxtor<br>                            [cat] =&gt; Array<br>                                (<br>                                    [0] =&gt; electronics<br>                                    [1] =&gt; hard drive<br>                                )<br><br>                            [features] =&gt; Array<br>                                (<br>                                    [0] =&gt; SATA 3.0Gb/s, NCQ<br>                                    [1] =&gt; 8.5ms seek<br>                                    [2] =&gt; 16MB cache<br>                                )<br><br>                            [price] =&gt; Array<br>                                (<br>                                    [0] =&gt; 350<br>                                )<br><br>                            [popularity] =&gt; Array<br>                                (<br>                                    [0] =&gt; 6<br>                                )<br><br>                            [inStock] =&gt; Array<br>                                (<br>                                    [0] =&gt; 1<br>                                )<br><br>                            [store] =&gt; Array<br>                                (<br>                                    [0] =&gt; 45.17614,-93.87341<br>                                )<br><br>                            [manufacturedate_dt] =&gt; 2006-02-13T15:26:37Z<br>                            [_version_] =&gt; 1510294336449806336<br>                        )<br><br>                    [2] =&gt; SolrObject Object<br>                        (<br>                            [id] =&gt; F8V7067-APL-KIT<br>                            [name] =&gt; Array<br>                                (<br>                                    [0] =&gt; Belkin Mobile Power Cord for iPod w/ Dock<br>                                )<br><br>                            [manu] =&gt; Array<br>                                (<br>                                    [0] =&gt; Belkin<br>                                )<br><br>                            [manu_id_s] =&gt; belkin<br>                            [cat] =&gt; Array<br>                                (<br>                                    [0] =&gt; electronics<br>                                    [1] =&gt; connector<br>                                )<br><br>                            [features] =&gt; Array<br>                                (<br>                                    [0] =&gt; car power adapter, white<br>                                )<br><br>                            [weight] =&gt; Array<br>                                (<br>                                    [0] =&gt; 4<br>                                )<br><br>                            [price] =&gt; Array<br>                                (<br>                                    [0] =&gt; 19.95<br>                                )<br><br>                            [popularity] =&gt; Array<br>                                (<br>                                    [0] =&gt; 1<br>                                )<br><br>                            [inStock] =&gt; Array<br>                                (<br>                                    [0] =&gt; <br>                                )<br><br>                            [store] =&gt; Array<br>                                (<br>                                    [0] =&gt; 45.18014,-93.87741<br>                                )<br><br>                            [manufacturedate_dt] =&gt; 2005-08-01T16:30:25Z<br>                            [_version_] =&gt; 1510294336458194944<br>                        )<br><br>                    [3] =&gt; SolrObject Object<br>                        (<br>                            [id] =&gt; MA147LL/A<br>                            [name] =&gt; Array<br>                                (<br>                                    [0] =&gt; Apple 60 GB iPod with Video Playback Black<br>                                )<br><br>                            [manu] =&gt; Array<br>                                (<br>                                    [0] =&gt; Apple Computer Inc.<br>                                )<br><br>                            [manu_id_s] =&gt; apple<br>                            [cat] =&gt; Array<br>                                (<br>                                    [0] =&gt; electronics<br>                                    [1] =&gt; music<br>                                )<br><br>                            [features] =&gt; Array<br>                                (<br>                                    [0] =&gt; iTunes, Podcasts, Audiobooks<br>                                    [1] =&gt; Stores up to 15,000 songs, 25,000 photos, or 150 hours of video<br>                                    [2] =&gt; 2.5-inch, 320x240 color TFT LCD display with LED backlight<br>                                    [3] =&gt; Up to 20 hours of battery life<br>                                    [4] =&gt; Plays AAC, MP3, WAV, AIFF, Audible, Apple Lossless, H.264 video<br>                                    [5] =&gt; Notes, Calendar, Phone book, Hold button, Date display, Photo wallet, Built-in games, JPEG photo playback, Upgradeable firmware, USB 2.0 compatibility, Playback speed control, Rechargeable capability, Battery level indication<br>                                )<br><br>                            [includes] =&gt; Array<br>                                (<br>                                    [0] =&gt; earbud headphones, USB cable<br>                                )<br><br>                            [weight] =&gt; Array<br>                                (<br>                                    [0] =&gt; 5.5<br>                                )<br><br>                            [price] =&gt; Array<br>                                (<br>                                    [0] =&gt; 399<br>                                )<br><br>                            [popularity] =&gt; Array<br>                                (<br>                                    [0] =&gt; 10<br>                                )<br><br>                            [inStock] =&gt; Array<br>                                (<br>                                    [0] =&gt; 1<br>                                )<br><br>                            [store] =&gt; Array<br>                                (<br>                                    [0] =&gt; 37.7752,-100.0232<br>                                )<br><br>                            [manufacturedate_dt] =&gt; 2005-10-12T08:00:00Z<br>                            [_version_] =&gt; 1510294336562003968<br>                        )<br><br>                )<br><br>        )<br><br>)<br></span></div>        </div>  </div> </div></div>