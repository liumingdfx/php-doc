<div id="luasandbox.registerlibrary" class="refentry"> <div class="refnamediv">  <h1 class="refname">LuaSandbox::registerLibrary</h1>  <p class="verinfo">(PECL luasandbox &gt;= 1.0.0)</p><p class="refpurpose"><span class="refname">LuaSandbox::registerLibrary</span> &mdash; <span class="dc-title">Register a set of PHP functions as a Lua library</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-luasandbox.registerlibrary-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><strong>LuaSandbox::registerLibrary</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$libname</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">$functions</span></span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div>  <p class="para rdfs-comment">   Registers a set of PHP functions as a Lua library, so that Lua can call   the relevant PHP code.  </p>  <p class="para">   For more information about calling Lua functions and the return values,   see <span class="methodname" style="color:#CC7832">{@link LuaSandboxFunction::call()}</span>.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-luasandbox.registerlibrary-parameters">  <h3 class="title">参数</h3>  <dl>       <dt><span class="parameter" style="color:#3A95FF">libname</span></dt>    <dd>     <span>      The name of the library. In the Lua state, the global variable of this      name will be set to the table of functions. If the table already exists,      the new functions will be added to it.     </span>    </dd>          <dt><span class="parameter" style="color:#3A95FF">functions</span></dt>    <dd>     <p class="para">      An <span class="type" style="color:#EAB766">array</span>, where each key is a function name, and each value is a      corresponding PHP <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.callable.php" class="type callable" style="color:#EAB766">callable</a></span>.     </p>    </dd>     </dl> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-luasandbox.registerlibrary-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   没有返回值。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-luasandbox.registerlibrary-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 Registering PHP functions to call from Lua</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">// create a new LuaSandbox<br /></span><span style="color: #9876AA">$sandbox </span><span style="color: #007700">= new </span><span style="color: #9876AA">LuaSandbox</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// Register some functions in the Lua environment<br /><br /></span><span style="color: #007700">function </span><span style="color: #9876AA">frobnosticate</span><span style="color: #007700">( </span><span style="color: #9876AA">$v </span><span style="color: #007700">) {<br />    return [ </span><span style="color: #9876AA">$v </span><span style="color: #007700">+ </span><span style="color: #9876AA">42 </span><span style="color: #007700">];<br />}<br /><br /></span><span style="color: #9876AA">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">registerLibrary</span><span style="color: #007700">( </span><span style="color: #DD0000">'php'</span><span style="color: #007700">, [<br />    </span><span style="color: #DD0000">'frobnosticate' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'frobnosticate'</span><span style="color: #007700">,<br />    </span><span style="color: #DD0000">'output' </span><span style="color: #007700">=&gt; function ( </span><span style="color: #9876AA">$string </span><span style="color: #007700">) {<br />        echo </span><span style="color: #DD0000">"</span><span style="color: #9876AA">$string</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />    },<br />    </span><span style="color: #DD0000">'error' </span><span style="color: #007700">=&gt; function () {<br />        throw new </span><span style="color: #9876AA">LuaSandboxRuntimeError</span><span style="color: #007700">( </span><span style="color: #DD0000">"Something is wrong" </span><span style="color: #007700">);<br />    }<br />] );<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-luasandbox.registerlibrary-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="methodname" style="color:#CC7832">{@link LuaSandbox::loadString()} - Load Lua code into the Lua environment</span></li>    <li class="member"><span class="methodname" style="color:#CC7832">{@link LuaSandbox::wrapPhpFunction()} - Wrap a PHP callable in a LuaSandboxFunction</span></li>   </ul>  </span> </div></div>