<div id="function.imap-search" class="refentry"> <div class="refnamediv">  <h1 class="refname">imap_search</h1>  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">imap_search</span> &mdash; <span class="dc-title">This function returns an array of messages matching the given search criteria</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.imap-search-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>imap_search</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.imap-connection.php" class="type IMAP\Connection" style="color:#EAB766">IMAP\Connection</a></span> <span class="parameter" style="color:#3A95FF">$imap</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$criteria</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$flags</span><span class="initializer"> = <strong><span>SE_FREE</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$charset</span><span class="initializer"> = &quot;&quot;</span></span><br>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   This function performs a search on the mailbox currently opened   in the given <abbr title="Internet Message Access Protocol">IMAP</abbr> stream.   </p>  <p class="para">   For example, to match all unanswered messages sent by Mom, you&#039;d   use: &quot;UNANSWERED FROM mom&quot;. Searches appear to be case   insensitive. This list of criteria is from a reading of the UW   c-client source code and may be incomplete or   inaccurate (see also <a href="http://www.faqs.org/rfcs/rfc1176" class="link external">&raquo;&nbsp;RFC1176</a>,    section &quot;tag SEARCH search_criteria&quot;).  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.imap-search-parameters">  <h3 class="title">参数</h3>  <span>   <dl>    <dt><span class="parameter" style="color:#3A95FF">imap</span></dt><dd><p class="para"><span class="classname"><a href="https://www.php.net/manual/zh/class.imap-connection.php" class="classname">IMAP\Connection</a></span> 实例。</p></dd>         <dt><span class="parameter" style="color:#3A95FF">criteria</span></dt>     <dd>      <p class="para">       A string, delimited by spaces, in which the following keywords are       allowed. Any multi-word arguments (e.g.       <span>FROM &quot;joey smith&quot;</span>) must be quoted. Results will match       all <span class="parameter" style="color:#3A95FF">criteria</span> entries.       <ul class="itemizedlist">        <li class="listitem">         <span class="simpara">          ALL - return all messages matching the rest of the criteria         </span>        </li>        <li class="listitem">         <span class="simpara">          ANSWERED - match messages with the \\ANSWERED flag set         </span>        </li>        <li class="listitem">         <span class="simpara">          BCC &quot;string&quot; - match messages with &quot;string&quot; in the Bcc: field         </span>        </li>        <li class="listitem">         <span class="simpara">          BEFORE &quot;date&quot; - match messages with Date: before &quot;date&quot;         </span>        </li>        <li class="listitem">         <span class="simpara">          BODY &quot;string&quot; - match messages with &quot;string&quot; in the body of the message         </span>        </li>        <li class="listitem">         <span class="simpara">          CC &quot;string&quot; - match messages with &quot;string&quot; in the Cc: field         </span>        </li>        <li class="listitem">         <span class="simpara">          DELETED - match deleted messages         </span>        </li>        <li class="listitem">         <span class="simpara">          FLAGGED - match messages with the \\FLAGGED (sometimes          referred to as Important or Urgent) flag set         </span>        </li>        <li class="listitem">         <span class="simpara">          FROM &quot;string&quot; - match messages with &quot;string&quot; in the From: field         </span>        </li>        <li class="listitem">         <span class="simpara">          KEYWORD &quot;string&quot; - match messages with &quot;string&quot; as a keyword         </span>        </li>        <li class="listitem">         <span class="simpara">          NEW - match new messages         </span>        </li>        <li class="listitem">         <span class="simpara">          OLD - match old messages         </span>        </li>        <li class="listitem">         <span class="simpara">          ON &quot;date&quot; - match messages with Date: matching &quot;date&quot;         </span>        </li>        <li class="listitem">         <span class="simpara">          RECENT - match messages with the \\RECENT flag set         </span>        </li>        <li class="listitem">         <span class="simpara">          SEEN - match messages that have been read (the \\SEEN flag is set)         </span>        </li>        <li class="listitem">         <span class="simpara">          SINCE &quot;date&quot; - match messages with Date: after &quot;date&quot;         </span>        </li>        <li class="listitem">         <span class="simpara">          SUBJECT &quot;string&quot; - match messages with &quot;string&quot; in the Subject:         </span>        </li>        <li class="listitem">         <span class="simpara">          TEXT &quot;string&quot; - match messages with text &quot;string&quot;         </span>        </li>        <li class="listitem">         <span class="simpara">          TO &quot;string&quot; - match messages with &quot;string&quot; in the To:         </span>        </li>        <li class="listitem">         <span class="simpara">          UNANSWERED - match messages that have not been answered         </span>        </li>        <li class="listitem">         <span class="simpara">          UNDELETED - match messages that are not deleted         </span>        </li>        <li class="listitem">         <span class="simpara">          UNFLAGGED - match messages that are not flagged         </span>        </li>        <li class="listitem">         <span class="simpara">          UNKEYWORD &quot;string&quot; - match messages that do not have the          keyword &quot;string&quot;         </span>        </li>        <li class="listitem">         <span class="simpara">          UNSEEN - match messages which have not been read yet         </span>        </li>       </ul>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">flags</span></dt>     <dd>      <p class="para">       Valid values for <span class="parameter" style="color:#3A95FF">flags</span> are        <strong><span>SE_UID</span></strong>, which causes the returned array to       contain UIDs instead of messages sequence numbers.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">charset</span></dt>     <dd>      <p class="para">       MIME character set to use when searching strings.      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.imap-search-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   Returns an array of message numbers or UIDs.  </p>  <p class="para">   Return <strong><span>false</span></strong> if it does not understand the search   <span class="parameter" style="color:#3A95FF">criteria</span> or no messages have been found.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.imap-search-changelog">  <h3 class="title">更新日志</h3>  <table class="doctable informaltable">       <thead>     <tr>      <th>版本</th>      <th>说明</th>     </tr>    </thead>    <tbody class="tbody">     <tr> <td>8.1.0</td> <td>  现在 <span class="parameter" style="color:#3A95FF">imap</span> 参数接受 <span class="classname"><a href="https://www.php.net/manual/zh/class.imap-connection.php" class="classname">IMAP\Connection</a></span>  实例，之前接受有效的 <span>imap</span> <a href="https://www.php.net/manual/zh/language.types.resource.php" class="link">resource</a>。 </td></tr>    </tbody>     </table> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.imap-search-examples">  <h3 class="title">示例</h3>  <div class="example" id="">   <p><strong>示例 #1 <span class="function"><strong style="color:#CC7832">imap_search()</strong></span> example</strong></p>   <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$imap   </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_open</span><span style="color: #007700">(</span><span style="color: #DD0000">'{imap.example.com:993/imap/ssl}INBOX'</span><span style="color: #007700">, </span><span style="color: #DD0000">'foo@example.com'</span><span style="color: #007700">, </span><span style="color: #DD0000">'pass123'</span><span style="color: #007700">, </span><span style="color: #9876AA">OP_READONLY</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$some   </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_search</span><span style="color: #007700">(</span><span style="color: #9876AA">$imap</span><span style="color: #007700">, </span><span style="color: #DD0000">'SUBJECT "HOWTO be Awesome" SINCE "8 August 2008"'</span><span style="color: #007700">, </span><span style="color: #9876AA">SE_UID</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$msgnos </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_search</span><span style="color: #007700">(</span><span style="color: #9876AA">$imap</span><span style="color: #007700">, </span><span style="color: #DD0000">'ALL'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$uids   </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_search</span><span style="color: #007700">(</span><span style="color: #9876AA">$imap</span><span style="color: #007700">, </span><span style="color: #DD0000">'ALL'</span><span style="color: #007700">, </span><span style="color: #9876AA">SE_UID</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$some</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$msgnos</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$uids</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>   </div>   <div class="example-contents"><p>以上示例的输出类似于：</p></div>   <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>Array<br>(<br>    [0] =&gt; 4<br>    [1] =&gt; 6<br>    [2] =&gt; 11<br>)<br>Array<br>(<br>    [0] =&gt; 1<br>    [1] =&gt; 2<br>    [2] =&gt; 3<br>    [3] =&gt; 4<br>    [4] =&gt; 5<br>    [5] =&gt; 6<br>)<br>Array<br>(<br>    [0] =&gt; 1<br>    [1] =&gt; 4<br>    [2] =&gt; 6<br>    [3] =&gt; 8<br>    [4] =&gt; 11<br>    [5] =&gt; 12<br>)<br></span></div>   </div>  </div> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.imap-search-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link imap_listscan()} - Returns the list of mailboxes that matches the given text</span></li>   </ul>  </span> </div></div>