<div id="function.mail" class="refentry"> <div class="refnamediv">  <h1 class="refname">mail</h1>  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mail</span> &mdash; <span class="dc-title">发送邮件</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.mail-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>mail</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$to</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$subject</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$message</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766">string</span></span> <span class="parameter" style="color:#3A95FF">$additional_headers</span><span class="initializer"> = []</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$additional_params</span><span class="initializer"> = &quot;&quot;</span></span><br>): <span class="type" style="color:#EAB766">bool</span></div>  <p class="para rdfs-comment">   发送一封电子邮件。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.mail-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">to</span></dt>     <dd>      <p class="para">       电子邮件收件人，或收件人列表。      </p>      <p class="para">       本字符串的格式必须符合       <a href="http://www.faqs.org/rfcs/rfc2822" class="link external">&raquo;&nbsp;RFC 2822</a>。例如：       <ul class="simplelist">        <li class="member">user@example.com</li>        <li class="member">user@example.com, anotheruser@example.com</li>        <li class="member">User &lt;user@example.com&gt;</li>        <li class="member">User &lt;user@example.com&gt;, Another User &lt;anotheruser@example.com&gt;</li>       </ul>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">subject</span></dt>     <dd>      <p class="para">       电子邮件的主题。      </p>      <div class="caution"><strong class="caution">警告</strong>       <p class="para">        本项不能包含任何换行符，否则邮件可能无法正确发送。       </p>      </div>     </dd>             <dt><span class="parameter" style="color:#3A95FF">message</span></dt>     <dd>      <p class="para">       所要发送的消息。      </p>      <p class="para">       行之间必须以一个 CRLF（\r\n）分隔。每行不能超过 70 个字符。      </p>      <div class="caution"><strong class="caution">警告</strong>       <p class="para">        （Windows 下）当 PHP 直接连接到 SMTP 服务器时，如果在一行开头发现一个句号，则会被删掉。要避免此问题，将单个句号替换成两个句号。        <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$text </span><span style="color: #007700">= </span><span style="color: #9876AA">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n."</span><span style="color: #007700">, </span><span style="color: #DD0000">"\n.."</span><span style="color: #007700">, </span><span style="color: #9876AA">$text</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>        </div>       </p>      </div>     </dd>             <dt><span class="parameter" style="color:#3A95FF">additional_headers</span>（可选项）</dt>     <dd>      <p class="para">       <span class="type" style="color:#EAB766">String</span> or <span class="type" style="color:#EAB766">array</span> to be inserted at the end of the email header.      </p>      <p class="para">       This is typically used to add extra headers (From, Cc, and Bcc).       Multiple extra headers should be separated with a CRLF (\r\n).       If outside data are used to compose this header, the data should be sanitized       so that no unwanted headers could be injected.       </p>      <p class="para">       If an <span class="type" style="color:#EAB766">array</span> is passed, its keys are the header names and its       values are the respective header values.      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:        <p class="para">        Before PHP 5.4.42 and 5.5.27, repectively, <span class="parameter" style="color:#3A95FF">additional_headers</span> did not have mail header        injection protection. Therefore, users must make sure specified headers        are safe and contains headers only. i.e. Never start mail body by putting        multiple newlines.       </p>      </p></blockquote>            <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:        <p class="para">        When sending mail, the mail <em>must</em> contain        a <span>From</span> header. This can be set with the        <span class="parameter" style="color:#3A95FF">additional_headers</span> parameter, or a default        can be set in <var class="filename">php.ini</var>.       </p>       <p class="para">        Failing to do this will result in an error        message similar to <span>Warning: mail(): &quot;sendmail_from&quot; not        set in php.ini or custom &quot;From:&quot; header missing</span>.        The <span>From</span> header sets also        <span>Return-Path</span> when sending directly via SMTP (Windows only).       </p>      </p></blockquote>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:        <p class="para">        If messages are not received, try using a LF (\n) only.        Some Unix mail transfer agents (most notably        <a href="http://cr.yp.to/qmail.html" class="link external">&raquo;&nbsp;qmail</a>) replace LF by CRLF        automatically (which leads to doubling CR if CRLF is used).        This should be a last resort, as it does not comply with        <a href="http://www.faqs.org/rfcs/rfc2822" class="link external">&raquo;&nbsp;RFC 2822</a>.       </p>      </p></blockquote>     </dd>             <dt><span class="parameter" style="color:#3A95FF">additional_params</span> (optional)</dt>     <dd>      <p class="para">       The <span class="parameter" style="color:#3A95FF">additional_params</span> parameter       can be used to pass additional flags as command line options to the       program configured to be used when sending mail, as defined by the       <span>sendmail_path</span> configuration setting. For example,       this can be used to set the envelope sender address when using       sendmail with the <span>-f</span> sendmail option.      </p>      <p class="para">       This parameter is escaped by <span class="function">{@link escapeshellcmd()}</span> internally       to prevent command execution. <span class="function">{@link escapeshellcmd()}</span> prevents       command execution, but allows to add additional parameters. For security reasons,       it is recommended for the user to sanitize this parameter to avoid adding unwanted       parameters to the shell command.      </p>      <p class="para">       Since <span class="function">{@link escapeshellcmd()}</span> is applied automatically, some characters       that are allowed as email addresses by internet RFCs cannot be used.        <span class="function"><strong style="color:#CC7832">mail()</strong></span> can not allow such characters, so in programs where the use of       such characters is required, alternative means of sending emails (such as using a framework       or a library) is recommended.       </p>      <p class="para">       The user that the webserver runs as should be added as a trusted user to the       sendmail configuration to prevent a &#039;X-Warning&#039; header from being added       to the message when the envelope sender (-f) is set using this method.       For sendmail users, this file is <var class="filename">/etc/mail/trusted-users</var>.      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.mail-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   如果邮件成功接受投递，返回 <strong><span>true</span></strong>，否则返回 <strong><span>false</span></strong>。  </p>  <p class="para">   同样重要的是要注意到，邮件仅接受了投递并不意味着邮件实际上达到预定目的地。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.mail-changelog">  <h3 class="title">更新日志</h3>  <span>   <table class="doctable informaltable">         <thead>      <tr>       <th>版本</th>       <th>说明</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td>7.2.0</td>       <td>        现在 <span class="parameter" style="color:#3A95FF">additional_headers</span> 参数开始支持 <span class="type" style="color:#EAB766">array</span>。       </td>      </tr>     </tbody>       </table>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.mail-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 发送邮件</strong></p>    <div class="example-contents"><p>     使用 <span class="function"><strong style="color:#CC7832">mail()</strong></span> 发送简单的邮件：    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// 消息<br /></span><span style="color: #9876AA">$message </span><span style="color: #007700">= </span><span style="color: #DD0000">"Line 1\r\nLine 2\r\nLine 3"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// 如果任何一行超过 70 个字符，应该使用 wordwrap()<br /></span><span style="color: #9876AA">$message </span><span style="color: #007700">= </span><span style="color: #9876AA">wordwrap</span><span style="color: #007700">(</span><span style="color: #9876AA">$message</span><span style="color: #007700">, </span><span style="color: #9876AA">70</span><span style="color: #007700">, </span><span style="color: #DD0000">"\r\n"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// 发送<br /></span><span style="color: #9876AA">mail</span><span style="color: #007700">(</span><span style="color: #DD0000">'caffeinated@example.com'</span><span style="color: #007700">, </span><span style="color: #DD0000">'My Subject'</span><span style="color: #007700">, </span><span style="color: #9876AA">$message</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>   <div class="example" id="">    <p><strong>示例 #2 使用额外标头发送邮件</strong></p>    <div class="example-contents"><p>     The addition of basic headers, telling the MUA     the From and Reply-To addresses:    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$to      </span><span style="color: #007700">= </span><span style="color: #DD0000">'nobody@example.com'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$subject </span><span style="color: #007700">= </span><span style="color: #DD0000">'the subject'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$message </span><span style="color: #007700">= </span><span style="color: #DD0000">'hello'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$headers </span><span style="color: #007700">= </span><span style="color: #DD0000">'From: webmaster@example.com' </span><span style="color: #007700">. </span><span style="color: #DD0000">"\r\n" </span><span style="color: #007700">.<br />    </span><span style="color: #DD0000">'Reply-To: webmaster@example.com' </span><span style="color: #007700">. </span><span style="color: #DD0000">"\r\n" </span><span style="color: #007700">.<br />    </span><span style="color: #DD0000">'X-Mailer: PHP/' </span><span style="color: #007700">. </span><span style="color: #9876AA">phpversion</span><span style="color: #007700">();<br /><br /></span><span style="color: #9876AA">mail</span><span style="color: #007700">(</span><span style="color: #9876AA">$to</span><span style="color: #007700">, </span><span style="color: #9876AA">$subject</span><span style="color: #007700">, </span><span style="color: #9876AA">$message</span><span style="color: #007700">, </span><span style="color: #9876AA">$headers</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>   <div class="example" id="">    <p><strong>示例 #3 使用 <span class="type" style="color:#EAB766">array</span> 形式的额外标头发送邮件</strong></p>    <div class="example-contents"><p>     This example sends the same mail as the example immediately above, but     passes the additional headers as array (available as of PHP 7.2.0).    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$to      </span><span style="color: #007700">= </span><span style="color: #DD0000">'nobody@example.com'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$subject </span><span style="color: #007700">= </span><span style="color: #DD0000">'the subject'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$message </span><span style="color: #007700">= </span><span style="color: #DD0000">'hello'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$headers </span><span style="color: #007700">= array(<br />    </span><span style="color: #DD0000">'From' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'webmaster@example.com'</span><span style="color: #007700">,<br />    </span><span style="color: #DD0000">'Reply-To' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'webmaster@example.com'</span><span style="color: #007700">,<br />    </span><span style="color: #DD0000">'X-Mailer' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'PHP/' </span><span style="color: #007700">. </span><span style="color: #9876AA">phpversion</span><span style="color: #007700">()<br />);<br /><br /></span><span style="color: #9876AA">mail</span><span style="color: #007700">(</span><span style="color: #9876AA">$to</span><span style="color: #007700">, </span><span style="color: #9876AA">$subject</span><span style="color: #007700">, </span><span style="color: #9876AA">$message</span><span style="color: #007700">, </span><span style="color: #9876AA">$headers</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>   <div class="example" id="">    <p><strong>示例 #4 Sending mail with an additional command line parameter.</strong></p>    <div class="example-contents"><p>     The <span class="parameter" style="color:#3A95FF">additional_params</span> parameter     can be used to pass an additional parameter to the program configured     to use when sending mail using the <span>sendmail_path</span>.    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />mail</span><span style="color: #007700">(</span><span style="color: #DD0000">'nobody@example.com'</span><span style="color: #007700">, </span><span style="color: #DD0000">'the subject'</span><span style="color: #007700">, </span><span style="color: #DD0000">'the message'</span><span style="color: #007700">, </span><span style="color: #9876AA">null</span><span style="color: #007700">,<br />   </span><span style="color: #DD0000">'-fwebmaster@example.com'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>   <div class="example" id="">    <p><strong>示例 #5 Sending HTML email</strong></p>    <div class="example-contents"><p>     It is also possible to send HTML email with <span class="function"><strong style="color:#CC7832">mail()</strong></span>.    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// Multiple recipients<br /></span><span style="color: #9876AA">$to </span><span style="color: #007700">= </span><span style="color: #DD0000">'johny@example.com, sally@example.com'</span><span style="color: #007700">; </span><span style="color: #FF8000">// note the comma<br /><br />// Subject<br /></span><span style="color: #9876AA">$subject </span><span style="color: #007700">= </span><span style="color: #DD0000">'Birthday Reminders for August'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// Message<br /></span><span style="color: #9876AA">$message </span><span style="color: #007700">= </span><span style="color: #DD0000">'<br />&lt;html&gt;<br />&lt;head&gt;<br />  &lt;title&gt;Birthday Reminders for August&lt;/title&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />  &lt;p&gt;Here are the birthdays upcoming in August!&lt;/p&gt;<br />  &lt;table&gt;<br />    &lt;tr&gt;<br />      &lt;th&gt;Person&lt;/th&gt;&lt;th&gt;Day&lt;/th&gt;&lt;th&gt;Month&lt;/th&gt;&lt;th&gt;Year&lt;/th&gt;<br />    &lt;/tr&gt;<br />    &lt;tr&gt;<br />      &lt;td&gt;Johny&lt;/td&gt;&lt;td&gt;10th&lt;/td&gt;&lt;td&gt;August&lt;/td&gt;&lt;td&gt;1970&lt;/td&gt;<br />    &lt;/tr&gt;<br />    &lt;tr&gt;<br />      &lt;td&gt;Sally&lt;/td&gt;&lt;td&gt;17th&lt;/td&gt;&lt;td&gt;August&lt;/td&gt;&lt;td&gt;1973&lt;/td&gt;<br />    &lt;/tr&gt;<br />  &lt;/table&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br />'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// To send HTML mail, the Content-type header must be set<br /></span><span style="color: #9876AA">$headers</span><span style="color: #007700">[] = </span><span style="color: #DD0000">'MIME-Version: 1.0'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$headers</span><span style="color: #007700">[] = </span><span style="color: #DD0000">'Content-type: text/html; charset=iso-8859-1'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// Additional headers<br /></span><span style="color: #9876AA">$headers</span><span style="color: #007700">[] = </span><span style="color: #DD0000">'To: Mary &lt;mary@example.com&gt;, Kelly &lt;kelly@example.com&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$headers</span><span style="color: #007700">[] = </span><span style="color: #DD0000">'From: Birthday Reminder &lt;birthday@example.com&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$headers</span><span style="color: #007700">[] = </span><span style="color: #DD0000">'Cc: birthdayarchive@example.com'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$headers</span><span style="color: #007700">[] = </span><span style="color: #DD0000">'Bcc: birthdaycheck@example.com'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// Mail it<br /></span><span style="color: #9876AA">mail</span><span style="color: #007700">(</span><span style="color: #9876AA">$to</span><span style="color: #007700">, </span><span style="color: #9876AA">$subject</span><span style="color: #007700">, </span><span style="color: #9876AA">$message</span><span style="color: #007700">, </span><span style="color: #9876AA">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">"\r\n"</span><span style="color: #007700">, </span><span style="color: #9876AA">$headers</span><span style="color: #007700">));<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>     <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:       <p class="para">       If intending to send HTML or otherwise Complex mails, it is recommended       to use the PEAR package {@link &raquo;&nbsp;PEAR::Mail}.      </p>     </p></blockquote>    </p></div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 notes" id="refsect1-function.mail-notes">      <h3 class="title">注释</h3>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    The SMTP implementation (Windows only) of <span class="function"><strong style="color:#CC7832">mail()</strong></span> differs in many    ways from the sendmail implementation. First, it doesn&#039;t use a local binary    for composing messages but only operates on direct sockets which means a    <span>MTA</span> is needed listening on a network socket (which    can either on the localhost or a remote machine).   </p>   <p class="para">    Second, the custom headers like    <span>From:</span>,    <span>Cc:</span>,    <span>Bcc:</span> and    <span>Date:</span> are    <strong>not</strong> interpreted by the    <span>MTA</span> in the first place, but are parsed by PHP.   </p>   <p class="para">    As such, the <span class="parameter" style="color:#3A95FF">to</span> parameter should not be an address    in the form of &quot;Something &lt;someone@example.com&gt;&quot;. The    mail command may not parse this properly while talking with     the MTA.   </p>  </p></blockquote>    <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    值得注意的是，<span class="function"><strong style="color:#CC7832">mail()</strong></span> 不适合在循环中发送大量邮件。发送每封邮件，此函数为打开和关闭一个套接字，效率不高。   </p>   <p class="para">    要发送大量邮件，请参阅    {@link &raquo;&nbsp;PEAR::Mail} 和    {@link &raquo;&nbsp;PEAR::Mail_Queue} 包。   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    以下 RFC 可能有用：    <a href="http://www.faqs.org/rfcs/rfc1896" class="link external">&raquo;&nbsp;RFC 1896</a>、<a href="http://www.faqs.org/rfcs/rfc2045" class="link external">&raquo;&nbsp;RFC 2045</a>、    <a href="http://www.faqs.org/rfcs/rfc2046" class="link external">&raquo;&nbsp;RFC 2046</a>、<a href="http://www.faqs.org/rfcs/rfc2047" class="link external">&raquo;&nbsp;RFC 2047</a>、    <a href="http://www.faqs.org/rfcs/rfc2048" class="link external">&raquo;&nbsp;RFC 2048</a>、<a href="http://www.faqs.org/rfcs/rfc2049" class="link external">&raquo;&nbsp;RFC 2049</a> 和    <a href="http://www.faqs.org/rfcs/rfc2822" class="link external">&raquo;&nbsp;RFC 2822</a>。   </p>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.mail-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link mb_send_mail()} - 发送编码过的邮件</span></li>    <li class="member"><span class="function">{@link imap_mail()} - Send an email message</span></li>    <li class="member">{@link &raquo;&nbsp;PEAR::Mail}</li>    <li class="member">{@link &raquo;&nbsp;PEAR::Mail_Mime}</li>   </ul>  </span> </div></div>