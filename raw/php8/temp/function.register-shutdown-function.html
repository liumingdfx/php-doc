<div id="function.register-shutdown-function" class="refentry"> <div class="refnamediv">  <h1 class="refname">register_shutdown_function</h1>  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">register_shutdown_function</span> &mdash; <span class="dc-title">注册在关闭时执行的函数</span></p> </div>  <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.register-shutdown-function-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>register_shutdown_function</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.callable.php" class="type callable" style="color:#EAB766">callable</a></span> <span class="parameter" style="color:#3A95FF">$callback</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.declarations.php#language.types.declarations.mixed" class="type mixed" style="color:#EAB766">mixed</a></span> <span class="parameter" style="color:#3A95FF">...$args</span></span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div>  <p class="para rdfs-comment">   注册一个 <span class="parameter" style="color:#3A95FF">callback</span> ，它会在脚本执行完成或者 <span class="function">{@link exit()}</span> 后被调用。  </p>  <p class="para">   可以多次调用   <span class="function"><strong style="color:#CC7832">register_shutdown_function()</strong></span>，这些被注册的回调会按照他们注册时的顺序被依次调用。如果你在注册的方法内部调用   <span class="function">{@link exit()}</span>，那么所有处理会被中止，并且其他注册的中止回调也不会再被调用。  </p>  <p class="para">   关闭函数也可以调用 <span class="function"><strong style="color:#CC7832">register_shutdown_function()</strong></span> 来将关闭函数添加到队列的末尾。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.register-shutdown-function-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">callback</span></dt>     <dd>      <p class="para">       待注册的中止回调。      </p>      <p class="para">       中止回调是作为请求的一部分被执行的，因此可以在它们中进行输出或者读取输出缓冲区。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">args</span></dt>     <dd>      <p class="para">       可以通过传入额外的参数来将参数传给中止函数。      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.register-shutdown-function-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   没有返回值。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.register-shutdown-function-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 <span class="function"><strong style="color:#CC7832">register_shutdown_function()</strong></span> 例子</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #007700">function </span><span style="color: #9876AA">shutdown</span><span style="color: #007700">()<br />{<br />    </span><span style="color: #FF8000">// 这是关闭函数，在脚本完成前可以进行任何最后的操作。<br /><br />    </span><span style="color: #007700">echo </span><span style="color: #DD0000">'Script executed with success'</span><span style="color: #007700">, </span><span style="color: #9876AA">PHP_EOL</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #9876AA">register_shutdown_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'shutdown'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 notes" id="refsect1-function.register-shutdown-function-notes">  <h3 class="title">注释</h3>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    在某些 web 服务器（如 Apache）上，可以在中止函数内对脚本的工作目录进行修改。   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    如果进程被信号 SIGTERM 或 SIGKILL 杀死，那么中止函数将不会被调用。尽管你无法中断    SIGKILL，但你可以通过 <span class="function">{@link pcntl_signal()}</span> 来捕获    SIGTERM，通过在其中调用 <span class="function">{@link exit()}</span> 来进行一个正常的中止。   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    关闭函数与 <a href="https://www.php.net/manual/zh/info.configuration.php#ini.max-execution-time" class="link">max_execution_time</a>    追踪的时间分开运行。这意味着即使进程因为运行时间过长而终止，仍会调用关闭函数。此外，如果关闭函数运行时正好    <span>max_execution_time</span> 用完，也会被终止。   </p>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.register-shutdown-function-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><a href="https://www.php.net/manual/zh/ini.core.php#ini.auto-append-file" class="link">auto_append_file</a></li>    <li class="member"><span class="function">{@link exit()} - 输出一个消息并且退出当前脚本</span></li>    <li class="member"><span class="function">{@link fastcgi_finish_request()} - 冲刷(flush)所有响应的数据给客户端</span></li>    <li class="member"><a href="https://www.php.net/manual/zh/features.connection-handling.php" class="link">连接处理</a>节</li>   </ul>  </span> </div></div>