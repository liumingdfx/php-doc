<div id="class.mongodb-driver-manager" class="reference"> <h1 class="title">The MongoDB\Driver\Manager class</h1>  <div class="partintro"><p class="verinfo">(mongodb &gt;=1.0.0)</p>  <div class="section" id="mongodb-driver-manager.intro">   <h2 class="title">简介</h2>   <p class="para">    The <span class="classname"><strong class="classname">MongoDB\Driver\Manager</strong></span> is the main entry point    to the extension. It is responsible for maintaining connections to MongoDB    (be it standalone server, replica set, or sharded cluster).   </p>   <p class="para">    No connection to MongoDB is made upon instantiating the Manager.    This means the <span class="classname"><strong class="classname">MongoDB\Driver\Manager</strong></span> can always be    constructed, even though one or more MongoDB servers are down.   </p>   <p class="para">    Any write or query can throw connection exceptions as connections are created lazily.    A MongoDB server may also become unavailable during the life time of the script.    It is therefore important that all actions on the Manager to be wrapped in try/catch statements.   </p>  </div>  <div class="section" id="mongodb-driver-manager.synopsis">   <h2 class="title">类摘要</h2>   <div class="classsynopsis">    <span class="ooclass"><strong class="classname"></strong></span>    <div class="classsynopsisinfo">     <span class="modifier">final</span>     <span class="ooclass">      <span class="modifier">class</span> <strong class="classname">MongoDB\Driver\Manager</strong>     </span>     {</div>        <div class="classsynopsisinfo classsynopsisinfo_comment">// 方法 </div>    <div class="methodsynopsis dc-description">   <span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.addsubscriber.php" class="methodname" style="color:#CC7832">addSubscriber</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-monitoring-subscriber.php" class="type MongoDB\Driver\Monitoring\Subscriber" style="color:#EAB766">MongoDB\Driver\Monitoring\Subscriber</a></span> <span class="parameter" style="color:#3A95FF">$subscriber</span></span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.construct.php" class="methodname" style="color:#CC7832">__construct</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">string</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$uri</span><span class="initializer"> = <strong><span>null</span></strong></span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$uriOptions</span><span class="initializer"> = <strong><span>null</span></strong></span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$driverOptions</span><span class="initializer"> = <strong><span>null</span></strong></span></span>)</div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.createclientencryption.php" class="methodname" style="color:#CC7832">createClientEncryption</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">$options</span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-clientencryption.php" class="type MongoDB\Driver\ClientEncryption" style="color:#EAB766">MongoDB\Driver\ClientEncryption</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.executebulkwrite.php" class="methodname" style="color:#CC7832">executeBulkWrite</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$namespace</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-bulkwrite.php" class="type MongoDB\Driver\BulkWrite" style="color:#EAB766">MongoDB\Driver\BulkWrite</a></span> <span class="parameter" style="color:#3A95FF">$bulk</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-writeconcern.php" class="type MongoDB\Driver\WriteConcern" style="color:#EAB766">MongoDB\Driver\WriteConcern</a></span>|<span class="type" style="color:#EAB766">null</span></span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = <strong><span>null</span></strong></span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-writeresult.php" class="type MongoDB\Driver\WriteResult" style="color:#EAB766">MongoDB\Driver\WriteResult</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.executecommand.php" class="methodname" style="color:#CC7832">executeCommand</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$db</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-command.php" class="type MongoDB\Driver\Command" style="color:#EAB766">MongoDB\Driver\Command</a></span> <span class="parameter" style="color:#3A95FF">$command</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-readpreference.php" class="type MongoDB\Driver\ReadPreference" style="color:#EAB766">MongoDB\Driver\ReadPreference</a></span>|<span class="type" style="color:#EAB766">null</span></span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = <strong><span>null</span></strong></span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-cursor.php" class="type MongoDB\Driver\Cursor" style="color:#EAB766">MongoDB\Driver\Cursor</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.executequery.php" class="methodname" style="color:#CC7832">executeQuery</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$namespace</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-query.php" class="type MongoDB\Driver\Query" style="color:#EAB766">MongoDB\Driver\Query</a></span> <span class="parameter" style="color:#3A95FF">$query</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-readpreference.php" class="type MongoDB\Driver\ReadPreference" style="color:#EAB766">MongoDB\Driver\ReadPreference</a></span>|<span class="type" style="color:#EAB766">null</span></span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = <strong><span>null</span></strong></span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-cursor.php" class="type MongoDB\Driver\Cursor" style="color:#EAB766">MongoDB\Driver\Cursor</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.executereadcommand.php" class="methodname" style="color:#CC7832">executeReadCommand</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$db</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-command.php" class="type MongoDB\Driver\Command" style="color:#EAB766">MongoDB\Driver\Command</a></span> <span class="parameter" style="color:#3A95FF">$command</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = <strong><span>null</span></strong></span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-cursor.php" class="type MongoDB\Driver\Cursor" style="color:#EAB766">MongoDB\Driver\Cursor</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.executereadwritecommand.php" class="methodname" style="color:#CC7832">executeReadWriteCommand</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$db</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-command.php" class="type MongoDB\Driver\Command" style="color:#EAB766">MongoDB\Driver\Command</a></span> <span class="parameter" style="color:#3A95FF">$command</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = <strong><span>null</span></strong></span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-cursor.php" class="type MongoDB\Driver\Cursor" style="color:#EAB766">MongoDB\Driver\Cursor</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.executewritecommand.php" class="methodname" style="color:#CC7832">executeWriteCommand</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$db</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-command.php" class="type MongoDB\Driver\Command" style="color:#EAB766">MongoDB\Driver\Command</a></span> <span class="parameter" style="color:#3A95FF">$command</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = <strong><span>null</span></strong></span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-cursor.php" class="type MongoDB\Driver\Cursor" style="color:#EAB766">MongoDB\Driver\Cursor</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.getencryptedfieldsmap.php" class="methodname" style="color:#CC7832">getEncryptedFieldsMap</a></span>(): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766">object</span>|<span class="type" style="color:#EAB766">null</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.getreadconcern.php" class="methodname" style="color:#CC7832">getReadConcern</a></span>(): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-readconcern.php" class="type MongoDB\Driver\ReadConcern" style="color:#EAB766">MongoDB\Driver\ReadConcern</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.getreadpreference.php" class="methodname" style="color:#CC7832">getReadPreference</a></span>(): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-readpreference.php" class="type MongoDB\Driver\ReadPreference" style="color:#EAB766">MongoDB\Driver\ReadPreference</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.getservers.php" class="methodname" style="color:#CC7832">getServers</a></span>(): <span class="type" style="color:#EAB766">array</span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.getwriteconcern.php" class="methodname" style="color:#CC7832">getWriteConcern</a></span>(): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-writeconcern.php" class="type MongoDB\Driver\WriteConcern" style="color:#EAB766">MongoDB\Driver\WriteConcern</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.removesubscriber.php" class="methodname" style="color:#CC7832">removeSubscriber</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-monitoring-subscriber.php" class="type MongoDB\Driver\Monitoring\Subscriber" style="color:#EAB766">MongoDB\Driver\Monitoring\Subscriber</a></span> <span class="parameter" style="color:#3A95FF">$subscriber</span></span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.selectserver.php" class="methodname" style="color:#CC7832">selectServer</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-readpreference.php" class="type MongoDB\Driver\ReadPreference" style="color:#EAB766">MongoDB\Driver\ReadPreference</a></span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$readPreference</span><span class="initializer"> = <strong><span>null</span></strong></span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-server.php" class="type MongoDB\Driver\Server" style="color:#EAB766">MongoDB\Driver\Server</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/mongodb-driver-manager.startsession.php" class="methodname" style="color:#CC7832">startSession</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = <strong><span>null</span></strong></span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-session.php" class="type MongoDB\Driver\Session" style="color:#EAB766">MongoDB\Driver\Session</a></span></div>   }</div>  </div>  <div class="section" id="mongodb-driver-manager.examples">   <h2 class="title">示例</h2>   <div class="example" id="example-3893">    <p><strong>示例 #1 <span class="function">{@link MongoDB\Driver\Manager::__construct()}</span> basic example</strong></p>    <div class="example-contents"><p>     <span class="function">{@link var_dump()}</span>ing a     <span class="classname"><strong class="classname">MongoDB\Driver\Manager</strong></span> will print out various     details about the manager that are otherwise not normally exposed.     This can be useful to debug how the driver views your MongoDB setup, and      which options are used.    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$manager </span><span style="color: #007700">= new </span><span style="color: #9876AA">MongoDB\Driver\Manager</span><span style="color: #007700">(</span><span style="color: #DD0000">'mongodb://localhost:27017'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$manager</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例的输出类似于：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>object(MongoDB\Driver\Manager)#1 (2) {<br>  [&quot;uri&quot;]=&gt;<br>  string(26) &quot;mongodb://127.0.0.1:27017/&quot;<br>  [&quot;cluster&quot;]=&gt;<br>  array(0) {<br>  }<br>}<br></span></div>    </div>   </div>  </div> </div>        <h2>目录</h2><ul class="chunklist chunklist_reference"><li>{@link MongoDB\Driver\Manager::addSubscriber} — Registers a monitoring event subscriber with this Manager</li><li>{@link MongoDB\Driver\Manager::__construct} — Create new MongoDB Manager</li><li>{@link MongoDB\Driver\Manager::createClientEncryption} — Create a new ClientEncryption object</li><li>{@link MongoDB\Driver\Manager::executeBulkWrite} — Execute one or more write operations</li><li>{@link MongoDB\Driver\Manager::executeCommand} — Execute a database command</li><li>{@link MongoDB\Driver\Manager::executeQuery} — Execute a database query</li><li>{@link MongoDB\Driver\Manager::executeReadCommand} — Execute a database command that reads</li><li>{@link MongoDB\Driver\Manager::executeReadWriteCommand} — Execute a database command that reads and writes</li><li>{@link MongoDB\Driver\Manager::executeWriteCommand} — Execute a database command that writes</li><li>{@link MongoDB\Driver\Manager::getEncryptedFieldsMap} — Return the encryptedFieldsMap auto encryption option for the Manager</li><li>{@link MongoDB\Driver\Manager::getReadConcern} — Return the ReadConcern for the Manager</li><li>{@link MongoDB\Driver\Manager::getReadPreference} — Return the ReadPreference for the Manager</li><li>{@link MongoDB\Driver\Manager::getServers} — Return the servers to which this manager is connected</li><li>{@link MongoDB\Driver\Manager::getWriteConcern} — Return the WriteConcern for the Manager</li><li>{@link MongoDB\Driver\Manager::removeSubscriber} — Unregisters a monitoring event subscriber with this Manager</li><li>{@link MongoDB\Driver\Manager::selectServer} — Select a server matching a read preference</li><li>{@link MongoDB\Driver\Manager::startSession} — Start a new client session for use with this client</li></ul></div>