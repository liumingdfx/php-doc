<div id="function.imagettfbbox" class="refentry"> <div class="refnamediv">  <h1 class="refname">imagettfbbox</h1>  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">imagettfbbox</span> &mdash; <span class="dc-title">取得使用 TrueType 字体的文本的边界框</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.imagettfbbox-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>imagettfbbox</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">float</span> <span class="parameter" style="color:#3A95FF">$size</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">float</span> <span class="parameter" style="color:#3A95FF">$angle</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$font_filename</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$string</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = []</span></span><br>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   本函数计算并返回 TrueType 文本的边界框的像素大小。  </p>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    在 PHP 8.0.0 之前，<span class="function">{@link imageftbbox()}</span> 是 <span class="function"><strong style="color:#CC7832">imagettfbbox()</strong></span> 的扩展变体，额外支持    <span class="parameter" style="color:#3A95FF">extrainfo</span>。自 PHP 8.0.0 起，<span class="function"><strong style="color:#CC7832">imagettfbbox()</strong></span> 是 <span class="function">{@link imageftbbox()}</span> 的别名。   </p>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.imagettfbbox-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">size</span></dt>     <dd>      <p class="para">字体的尺寸，单位：点（磅）。</p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">angle</span></dt>     <dd>      <p class="para">       测量字符串的角度（以度为单位）。      </p>     </dd>                 <dt><span class="parameter" style="color:#3A95FF">fontfile</span></dt>     <dd>      <p class="para">       想要使用的 TrueType 字体的路径。      </p>      <p class="para">       根据 PHP 所使用的 GD 库版本，<em>当 <span class="parameter" style="color:#3A95FF">fontfile</span>       没有以 <span>/</span> 开头时则 <span>.ttf</span>       将追加</em>到文件名之后，并且会在库定义字体路径中尝试搜索该文件名。      </p>      <p class="para">       当使用的 GD 库版本低于 2.0.18 时，<span>space</span>        字符而不是分号将被用来作为不同字体文件的“路径分隔符”。不小心使用了此特性将会导致一条警告信息：<span>Warning:       Could not find/open font</span>。对受影响的版本来说唯一解决方案就是将字体移动到不包含空格的路径。      </p>      <p class="para">       很多情况下字体与使用字体的脚本在同一个目录中，下面的小技巧可以缓解 include 的问题。       <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// Set the environment variable for GD<br /></span><span style="color: #9876AA">putenv</span><span style="color: #007700">(</span><span style="color: #DD0000">'GDFONTPATH=' </span><span style="color: #007700">. </span><span style="color: #9876AA">realpath</span><span style="color: #007700">(</span><span style="color: #DD0000">'.'</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">// Name the font to be used (note the lack of the .ttf extension)<br /></span><span style="color: #9876AA">$font </span><span style="color: #007700">= </span><span style="color: #DD0000">'SomeFont'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>       </div>      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:        <p class="para">        注意 <a href="https://www.php.net/manual/zh/ini.core.php#ini.open-basedir" class="link">open_basedir</a>        <em>不</em> 适用于 <span class="parameter" style="color:#3A95FF">fontfile</span>。       </p>      </p></blockquote>     </dd>             <dt><span class="parameter" style="color:#3A95FF">string</span></dt>     <dd>      <p class="para">       要测量的字符串。      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.imagettfbbox-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   <span class="function"><strong style="color:#CC7832">imagettfbbox()</strong></span> 成功时返回包含 8 个元素的数组，代表构成文本边界框的四个点。失败时返回 <strong><span>false</span></strong>。   <table class="doctable informaltable">         <thead>      <tr>       <th>键</th>       <th>内容</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td>0</td>       <td>左下角,X 位置</td>      </tr>      <tr>       <td>1</td>       <td>左下角，Y 位置</td>      </tr>      <tr>       <td>2</td>       <td>右下角，X 位置</td>      </tr>      <tr>       <td>3</td>       <td>右下角，Y 位置</td>      </tr>      <tr>       <td>4</td>       <td>右上角，X 位置</td>      </tr>      <tr>       <td>5</td>       <td>右上角，Y 位置</td>      </tr>      <tr>       <td>6</td>       <td>左上角，X 位置</td>      </tr>      <tr>       <td>7</td>       <td>左上角，Y 位置</td>      </tr>     </tbody>       </table>  </p>  <p class="para">   这些点相对于 <em>text</em>，与 <span class="parameter" style="color:#3A95FF">angle</span> 无关，因此“左上角”意味着可以在左上角看到横排文本。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.imagettfbbox-changelog">  <h3 class="title">更新日志</h3>  <table class="doctable informaltable">       <thead>     <tr>      <th>版本</th>      <th>说明</th>     </tr>    </thead>    <tbody class="tbody">     <tr>      <td>8.0.0</td>      <td>       新增 <span class="parameter" style="color:#3A95FF">options</span>。      </td>     </tr>    </tbody>     </table> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.imagettfbbox-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 <span class="function"><strong style="color:#CC7832">imagettfbbox()</strong></span> 示例</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// 创建 300x150 图像<br /></span><span style="color: #9876AA">$im </span><span style="color: #007700">= </span><span style="color: #9876AA">imagecreatetruecolor</span><span style="color: #007700">(</span><span style="color: #9876AA">300</span><span style="color: #007700">, </span><span style="color: #9876AA">150</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$black </span><span style="color: #007700">= </span><span style="color: #9876AA">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">, </span><span style="color: #9876AA">0</span><span style="color: #007700">, </span><span style="color: #9876AA">0</span><span style="color: #007700">, </span><span style="color: #9876AA">0</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$white </span><span style="color: #007700">= </span><span style="color: #9876AA">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">, </span><span style="color: #9876AA">255</span><span style="color: #007700">, </span><span style="color: #9876AA">255</span><span style="color: #007700">, </span><span style="color: #9876AA">255</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// 设置白色背景色<br /></span><span style="color: #9876AA">imagefilledrectangle</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">, </span><span style="color: #9876AA">0</span><span style="color: #007700">, </span><span style="color: #9876AA">0</span><span style="color: #007700">, </span><span style="color: #9876AA">299</span><span style="color: #007700">, </span><span style="color: #9876AA">299</span><span style="color: #007700">, </span><span style="color: #9876AA">$white</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// 字体文件的路径<br /></span><span style="color: #9876AA">$font </span><span style="color: #007700">= </span><span style="color: #DD0000">'./arial.ttf'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// 首先为第一个文本创建边界框<br /></span><span style="color: #9876AA">$bbox </span><span style="color: #007700">= </span><span style="color: #9876AA">imagettfbbox</span><span style="color: #007700">(</span><span style="color: #9876AA">10</span><span style="color: #007700">, </span><span style="color: #9876AA">45</span><span style="color: #007700">, </span><span style="color: #9876AA">$font</span><span style="color: #007700">, </span><span style="color: #DD0000">'Powered by PHP ' </span><span style="color: #007700">. </span><span style="color: #9876AA">phpversion</span><span style="color: #007700">());<br /><br /></span><span style="color: #FF8000">// 这是 X 坐标和 Y 坐标<br /></span><span style="color: #9876AA">$x </span><span style="color: #007700">= </span><span style="color: #9876AA">$bbox</span><span style="color: #007700">[</span><span style="color: #9876AA">0</span><span style="color: #007700">] + (</span><span style="color: #9876AA">imagesx</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">) / </span><span style="color: #9876AA">2</span><span style="color: #007700">) - (</span><span style="color: #9876AA">$bbox</span><span style="color: #007700">[</span><span style="color: #9876AA">4</span><span style="color: #007700">] / </span><span style="color: #9876AA">2</span><span style="color: #007700">) - </span><span style="color: #9876AA">25</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$y </span><span style="color: #007700">= </span><span style="color: #9876AA">$bbox</span><span style="color: #007700">[</span><span style="color: #9876AA">1</span><span style="color: #007700">] + (</span><span style="color: #9876AA">imagesy</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">) / </span><span style="color: #9876AA">2</span><span style="color: #007700">) - (</span><span style="color: #9876AA">$bbox</span><span style="color: #007700">[</span><span style="color: #9876AA">5</span><span style="color: #007700">] / </span><span style="color: #9876AA">2</span><span style="color: #007700">) - </span><span style="color: #9876AA">5</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// 写入<br /></span><span style="color: #9876AA">imagettftext</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">, </span><span style="color: #9876AA">10</span><span style="color: #007700">, </span><span style="color: #9876AA">45</span><span style="color: #007700">, </span><span style="color: #9876AA">$x</span><span style="color: #007700">, </span><span style="color: #9876AA">$y</span><span style="color: #007700">, </span><span style="color: #9876AA">$black</span><span style="color: #007700">, </span><span style="color: #9876AA">$font</span><span style="color: #007700">, </span><span style="color: #DD0000">'Powered by PHP ' </span><span style="color: #007700">. </span><span style="color: #9876AA">phpversion</span><span style="color: #007700">());<br /><br /></span><span style="color: #FF8000">// 为第二个文本创建边界框<br /></span><span style="color: #9876AA">$bbox </span><span style="color: #007700">= </span><span style="color: #9876AA">imagettfbbox</span><span style="color: #007700">(</span><span style="color: #9876AA">10</span><span style="color: #007700">, </span><span style="color: #9876AA">45</span><span style="color: #007700">, </span><span style="color: #9876AA">$font</span><span style="color: #007700">, </span><span style="color: #DD0000">'and Zend Engine ' </span><span style="color: #007700">. </span><span style="color: #9876AA">zend_version</span><span style="color: #007700">());<br /><br /></span><span style="color: #FF8000">// 设置坐标，使其位于第一个字的旁边<br /></span><span style="color: #9876AA">$x </span><span style="color: #007700">= </span><span style="color: #9876AA">$bbox</span><span style="color: #007700">[</span><span style="color: #9876AA">0</span><span style="color: #007700">] + (</span><span style="color: #9876AA">imagesx</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">) / </span><span style="color: #9876AA">2</span><span style="color: #007700">) - (</span><span style="color: #9876AA">$bbox</span><span style="color: #007700">[</span><span style="color: #9876AA">4</span><span style="color: #007700">] / </span><span style="color: #9876AA">2</span><span style="color: #007700">) + </span><span style="color: #9876AA">10</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$y </span><span style="color: #007700">= </span><span style="color: #9876AA">$bbox</span><span style="color: #007700">[</span><span style="color: #9876AA">1</span><span style="color: #007700">] + (</span><span style="color: #9876AA">imagesy</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">) / </span><span style="color: #9876AA">2</span><span style="color: #007700">) - (</span><span style="color: #9876AA">$bbox</span><span style="color: #007700">[</span><span style="color: #9876AA">5</span><span style="color: #007700">] / </span><span style="color: #9876AA">2</span><span style="color: #007700">) - </span><span style="color: #9876AA">5</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// 写入<br /></span><span style="color: #9876AA">imagettftext</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">, </span><span style="color: #9876AA">10</span><span style="color: #007700">, </span><span style="color: #9876AA">45</span><span style="color: #007700">, </span><span style="color: #9876AA">$x</span><span style="color: #007700">, </span><span style="color: #9876AA">$y</span><span style="color: #007700">, </span><span style="color: #9876AA">$black</span><span style="color: #007700">, </span><span style="color: #9876AA">$font</span><span style="color: #007700">, </span><span style="color: #DD0000">'and Zend Engine ' </span><span style="color: #007700">. </span><span style="color: #9876AA">zend_version</span><span style="color: #007700">());<br /><br /></span><span style="color: #FF8000">// 输出到浏览器<br /></span><span style="color: #9876AA">header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-Type: image/png'</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">imagepng</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">imagedestroy</span><span style="color: #007700">(</span><span style="color: #9876AA">$im</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 notes" id="refsect1-function.imagettfbbox-notes">  <h3 class="title">注释</h3>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>: <span class="simpara">此函数仅在PHP 编译时加入 freetype 支持时有效（<strong class="option configure">--with-freetype-dir=DIR</strong>）。</span></p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.imagettfbbox-seealso">  <h3 class="title">参见</h3>  <ul class="simplelist">   <li class="member"><span class="function">{@link imagettftext()} - 用 TrueType 字体向图像写入文本</span></li>   <li class="member"><span class="function">{@link imageftbbox()} - 通过 freetype2 使用字体给出文本的边界框</span></li>  </ul> </div></div>