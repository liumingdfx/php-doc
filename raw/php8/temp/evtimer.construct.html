<div id="evtimer.construct" class="refentry"> <div class="refnamediv">  <h1 class="refname">EvTimer::__construct</h1>  <p class="verinfo">(PECL ev &gt;= 0.2.0)</p><p class="refpurpose"><span class="refname">EvTimer::__construct</span> &mdash; <span class="dc-title">Constructs an EvTimer watcher object</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-evtimer.construct-description">  <h3 class="title">说明</h3>  <div class="constructorsynopsis dc-description">   <span class="modifier">public</span>   <span class="methodname" style="color:#CC7832"><strong>EvTimer::__construct</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766">float</span>     <span class="parameter" style="color:#3A95FF">$after</span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766">float</span>     <span class="parameter" style="color:#3A95FF">$repeat</span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.callable.php" class="type callable" style="color:#EAB766">callable</a></span>     <span class="parameter" style="color:#3A95FF">$callback</span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.declarations.php#language.types.declarations.mixed" class="type mixed" style="color:#EAB766">mixed</a></span>     <span class="parameter" style="color:#3A95FF">$data</span>    <span class="initializer"> = <strong><span>null</span></strong></span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766">int</span>     <span class="parameter" style="color:#3A95FF">$priority</span>    <span class="initializer"> = 0</span>   </span><br>)</div>  <p class="para rdfs-comment">   Constructs an EvTimer watcher object.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-evtimer.construct-parameters">  <h3 class="title">参数</h3>  <dl>       <dt>     <span class="parameter" style="color:#3A95FF">after</span>    </dt>    <dd>     <span>      Configures the timer to trigger after      <span class="parameter" style="color:#3A95FF">after</span>      seconds.     </span>    </dd>          <dt>     <span class="parameter" style="color:#3A95FF">repeat</span>    </dt>    <dd>     <p class="para">      If repeat is      <strong><span>0.0</span></strong>      , then it will automatically be stopped once the timeout is reached. If      it is positive, then the timer will automatically be configured to      trigger again every repeat seconds later, until stopped manually.     </p>    </dd>          <dt>     <span class="parameter" style="color:#3A95FF">callback</span>    </dt>    <dd>     <p class="para">      See      <a href="https://www.php.net/manual/zh/ev.watcher-callbacks.php" class="link">Watcher callbacks</a>      .     </p>    </dd>          <dt>     <span class="parameter" style="color:#3A95FF">data</span>    </dt>    <dd>     <p class="para">      Custom data associated with the watcher.     </p>    </dd>          <dt>     <span class="parameter" style="color:#3A95FF">priority</span>    </dt>    <dd>     <p class="para">      <a href="https://www.php.net/manual/zh/class.ev.php#ev.constants.watcher-pri" class="link">Watcher priority</a>     </p>    </dd>     </dl> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-evtimer.construct-examples">  <h3 class="title">示例</h3> <div class="example" id="">   <p><strong>示例 #1 Simple timers</strong></p>   <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// Create and start timer firing after 2 seconds<br /></span><span style="color: #9876AA">$w1 </span><span style="color: #007700">= new </span><span style="color: #9876AA">EvTimer</span><span style="color: #007700">(</span><span style="color: #9876AA">2</span><span style="color: #007700">, </span><span style="color: #9876AA">0</span><span style="color: #007700">, function () {<br />    echo </span><span style="color: #DD0000">"2 seconds elapsed\n"</span><span style="color: #007700">;<br />});<br /><br /></span><span style="color: #FF8000">// Create and launch timer firing after 2 seconds repeating each second<br />// until we manually stop it<br /></span><span style="color: #9876AA">$w2 </span><span style="color: #007700">= new </span><span style="color: #9876AA">EvTimer</span><span style="color: #007700">(</span><span style="color: #9876AA">2</span><span style="color: #007700">, </span><span style="color: #9876AA">1</span><span style="color: #007700">, function (</span><span style="color: #9876AA">$w</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"is called every second, is launched after 2 seconds\n"</span><span style="color: #007700">;<br />    echo </span><span style="color: #DD0000">"iteration = "</span><span style="color: #007700">, </span><span style="color: #9876AA">Ev</span><span style="color: #007700">::</span><span style="color: #9876AA">iteration</span><span style="color: #007700">(), </span><span style="color: #9876AA">PHP_EOL</span><span style="color: #007700">;<br /><br />    </span><span style="color: #FF8000">// Stop the watcher after 5 iterations<br />    </span><span style="color: #9876AA">Ev</span><span style="color: #007700">::</span><span style="color: #9876AA">iteration</span><span style="color: #007700">() == </span><span style="color: #9876AA">5 </span><span style="color: #007700">and </span><span style="color: #9876AA">$w</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">stop</span><span style="color: #007700">();<br />    </span><span style="color: #FF8000">// Stop the watcher if further calls cause more than 10 iterations<br />    </span><span style="color: #9876AA">Ev</span><span style="color: #007700">::</span><span style="color: #9876AA">iteration</span><span style="color: #007700">() &gt;= </span><span style="color: #9876AA">10 </span><span style="color: #007700">and </span><span style="color: #9876AA">$w</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">stop</span><span style="color: #007700">();<br />});<br /><br /></span><span style="color: #FF8000">// Create stopped timer. It will be inactive until we start it ourselves<br /></span><span style="color: #9876AA">$w_stopped </span><span style="color: #007700">= </span><span style="color: #9876AA">EvTimer</span><span style="color: #007700">::</span><span style="color: #9876AA">createStopped</span><span style="color: #007700">(</span><span style="color: #9876AA">10</span><span style="color: #007700">, </span><span style="color: #9876AA">5</span><span style="color: #007700">, function(</span><span style="color: #9876AA">$w</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"Callback of a timer created as stopped\n"</span><span style="color: #007700">;<br /><br />    </span><span style="color: #FF8000">// Stop the watcher after 2 iterations<br />    </span><span style="color: #9876AA">Ev</span><span style="color: #007700">::</span><span style="color: #9876AA">iteration</span><span style="color: #007700">() &gt;= </span><span style="color: #9876AA">2 </span><span style="color: #007700">and </span><span style="color: #9876AA">$w</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">stop</span><span style="color: #007700">();<br />});<br /><br /></span><span style="color: #FF8000">// Loop until Ev::stop() is called or all of watchers stop<br /></span><span style="color: #9876AA">Ev</span><span style="color: #007700">::</span><span style="color: #9876AA">run</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// Start and look if it works<br /></span><span style="color: #9876AA">$w_stopped</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">start</span><span style="color: #007700">();<br />echo </span><span style="color: #DD0000">"Run single iteration\n"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">Ev</span><span style="color: #007700">::</span><span style="color: #9876AA">run</span><span style="color: #007700">(</span><span style="color: #9876AA">Ev</span><span style="color: #007700">::</span><span style="color: #9876AA">RUN_ONCE</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #DD0000">"Restart the second watcher and try to handle the same events, but don't block\n"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$w2</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">again</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">Ev</span><span style="color: #007700">::</span><span style="color: #9876AA">run</span><span style="color: #007700">(</span><span style="color: #9876AA">Ev</span><span style="color: #007700">::</span><span style="color: #9876AA">RUN_NOWAIT</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$w </span><span style="color: #007700">= new </span><span style="color: #9876AA">EvTimer</span><span style="color: #007700">(</span><span style="color: #9876AA">10</span><span style="color: #007700">, </span><span style="color: #9876AA">0</span><span style="color: #007700">, function() {});<br />echo </span><span style="color: #DD0000">"Running a blocking loop\n"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">Ev</span><span style="color: #007700">::</span><span style="color: #9876AA">run</span><span style="color: #007700">();<br />echo </span><span style="color: #DD0000">"END\n"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>   </div>  <div class="example-contents"><p>以上示例的输出类似于：</p></div>  <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>2 seconds elapsed<br>is called every second, is launched after 2 seconds<br>iteration = 1<br>is called every second, is launched after 2 seconds<br>iteration = 2<br>is called every second, is launched after 2 seconds<br>iteration = 3<br>is called every second, is launched after 2 seconds<br>iteration = 4<br>is called every second, is launched after 2 seconds<br>iteration = 5<br>Run single iteration<br>Callback of a timer created as stopped<br>Restart the second watcher and try to handle the same events, but don&#039;t block<br>Running a blocking loop<br>is called every second, is launched after 2 seconds<br>iteration = 8<br>is called every second, is launched after 2 seconds<br>iteration = 9<br>is called every second, is launched after 2 seconds<br>iteration = 10<br>END<br></span></div>  </div>  </div> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-evtimer.construct-seealso">  <h3 class="title">参见</h3>  <ul class="simplelist">   <li class="member">    <span class="methodname" style="color:#CC7832">{@link EvTimer::createStopped()} - Creates EvTimer stopped watcher object</span>   </li>   <li class="member">    <span class="classname"><a href="https://www.php.net/manual/zh/class.evperiodic.php" class="classname">EvPeriodic</a></span>   </li>   <li class="member">    <a href="http://pod.tst.eu/http://cvs.schmorp.de/libev/ev.pod#code_ev_timer_code_relative_and_opti" class="link external">&raquo;&nbsp;ev_timer - relative and optionally repeating timeouts</a>   </li>   <li class="member">    <a href="http://pod.tst.eu/http://cvs.schmorp.de/libev/ev.pod#Be_smart_about_timeouts" class="link external">&raquo;&nbsp;Be smart about timeouts</a>   </li>  </ul> </div></div>