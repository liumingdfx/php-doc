<div id="function.socket-recvfrom" class="refentry"> <div class="refnamediv">  <h1 class="refname">socket_recvfrom</h1>  <p class="verinfo">(PHP 4 &gt;= 4.1.0, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">socket_recvfrom</span> &mdash; <span class="dc-title">从套接字接收数据，无论它是否是面向连接的</span></p> </div>  <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.socket-recvfrom-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>socket_recvfrom</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.socket.php" class="type Socket" style="color:#EAB766">Socket</a></span> <span class="parameter" style="color:#3A95FF">$socket</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">&$data</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$length</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$flags</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">&$address</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">&$port</span><span class="initializer"> = <strong><span>null</span></strong></span></span><br>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">int</span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   函数 <span class="function"><strong style="color:#CC7832">socket_recvfrom()</strong></span> 使用 <span class="parameter" style="color:#3A95FF">socket</span>    从 <span class="parameter" style="color:#3A95FF">address</span> 的 <span class="parameter" style="color:#3A95FF">port</span>    端口上接收 <span class="parameter" style="color:#3A95FF">length</span> 字节数据到 <span class="parameter" style="color:#3A95FF">data</span>    中（如果套接字不是 <strong><span>AF_UNIX</span></strong> 类型）。<span class="function"><strong style="color:#CC7832">socket_recvfrom()</strong></span>    可用于从已连接或未连接的套接字上收集数据。另外，可以指定一个或多个标志来修改函数的行为。  </p>  <p class="para">   <span class="parameter" style="color:#3A95FF">address</span> 和 <span class="parameter" style="color:#3A95FF">port</span>    必须是引用传递。如果套接字不是面向连接的，<span class="parameter" style="color:#3A95FF">address</span>    将设置为远程主机的互联网协议地址或 UNIX 套接字路径。如果套接字是面向连接的，<span class="parameter" style="color:#3A95FF">address</span>    是 <strong><span>null</span></strong>。另外，在 <strong><span>AF_INET</span></strong> 或 <strong><span>AF_INET6</span></strong>    套接字未连接的情况下，<span class="parameter" style="color:#3A95FF">port</span> 将包含远程主机的端口号。  </p>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>: <span class="simpara">此函数可安全用于二进制对象。</span></p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.socket-recvfrom-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">socket</span></dt>     <dd>      <p class="para">       <span class="parameter" style="color:#3A95FF">socket</span> 必须是先前由 socket_create() 创建的 <span class="classname"><a href="https://www.php.net/manual/zh/class.socket.php" class="classname">Socket</a></span> 实例。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">data</span></dt>     <dd>      <p class="para">       收到的数据将提取到 <span class="parameter" style="color:#3A95FF">data</span> 指定的变量。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">length</span></dt>     <dd>      <p class="para">       最多可从远程主机获取的 <span class="parameter" style="color:#3A95FF">length</span> 字节数。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">flags</span></dt>     <dd>      <p class="para">       <span class="parameter" style="color:#3A95FF">flags</span> 的值可以是下列任意 flag 的组合。使用按位或运算符（<span>|</span>）来组合不同的 flag。      </p>            <table class="doctable table">       <caption><strong><span class="parameter" style="color:#3A95FF">flags</span> 可用值</strong></caption>               <thead>         <tr>          <th>Flag</th>          <th>描述</th>         </tr>        </thead>        <tbody class="tbody">         <tr>          <td><strong><span>MSG_OOB</span></strong></td>          <td>           处理带外数据。          </td>         </tr>         <tr>          <td><strong><span>MSG_PEEK</span></strong></td>          <td>           从接收队列的起始位置接收数据，但不将他们从接收队列中移除。          </td>         </tr>         <tr>          <td><strong><span>MSG_WAITALL</span></strong></td>          <td>           在接受到至少 <span class="parameter" style="color:#3A95FF">length</span>            字节数据前阻塞。但是，如果接收到中断信号，或远程主机断开链接，函数可能返回不足 <span class="parameter" style="color:#3A95FF">length</span> 字节的数据。          </td>         </tr>         <tr>          <td><strong><span>MSG_DONTWAIT</span></strong></td>          <td>           如果指定了该 flag，即使原有套接字是阻塞的，此函数也不会阻塞。          </td>         </tr>        </tbody>             </table>     </dd>             <dt><span class="parameter" style="color:#3A95FF">address</span></dt>     <dd>      <p class="para">       如果套接字是 <strong><span>AF_UNIX</span></strong> 类型，<span class="parameter" style="color:#3A95FF">address</span>        是文件路径。否则，对于未连接的套接字，<span class="parameter" style="color:#3A95FF">address</span>        是远程主机的 IP 地址，如果套接字是面向连接的，是 <strong><span>null</span></strong>。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">port</span></dt>     <dd>      <p class="para">       此参数只适用于 <strong><span>AF_INET</span></strong> 和 <strong><span>AF_INET6</span></strong>        类型的套接字，并指定接收数据的远程端口。如果套接字是面向连接的，<span class="parameter" style="color:#3A95FF">port</span>        是 <strong><span>null</span></strong>。      </p>     </dd>           </dl>  </span> </div>  <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.socket-recvfrom-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   <span class="function"><strong style="color:#CC7832">socket_recvfrom()</strong></span> 返回接收到的字节数，发生错误时返回 <strong><span>false</span></strong>。可以通过调用 <span class="function">{@link socket_last_error()}</span>    来检索实际的错误代码。此错误码可以传递给 <span class="function">{@link socket_strerror()}</span> 获得错误的文本解释。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.socket-recvfrom-changelog">  <h3 class="title">更新日志</h3>  <table class="doctable informaltable">       <thead>     <tr>      <th>版本</th>      <th>说明</th>     </tr>    </thead>    <tbody class="tbody">     <tr>  <td>8.0.0</td>  <td>   现在 <span class="parameter" style="color:#3A95FF">socket</span> 是 <span class="classname"><a href="https://www.php.net/manual/zh/class.socket.php" class="classname">Socket</a></span> 实例，   之前是 <span class="type" style="color:#EAB766">resource</span>。  </td> </tr>    </tbody>     </table> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.socket-recvfrom-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 <span class="function"><strong style="color:#CC7832">socket_recvfrom()</strong></span> 示例</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$socket </span><span style="color: #007700">= </span><span style="color: #9876AA">socket_create</span><span style="color: #007700">(</span><span style="color: #9876AA">AF_INET</span><span style="color: #007700">, </span><span style="color: #9876AA">SOCK_DGRAM</span><span style="color: #007700">, </span><span style="color: #9876AA">SOL_UDP</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">socket_bind</span><span style="color: #007700">(</span><span style="color: #9876AA">$socket</span><span style="color: #007700">, </span><span style="color: #DD0000">'127.0.0.1'</span><span style="color: #007700">, </span><span style="color: #9876AA">1223</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$from </span><span style="color: #007700">= </span><span style="color: #DD0000">''</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$port </span><span style="color: #007700">= </span><span style="color: #9876AA">0</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">socket_recvfrom</span><span style="color: #007700">(</span><span style="color: #9876AA">$socket</span><span style="color: #007700">, </span><span style="color: #9876AA">$buf</span><span style="color: #007700">, </span><span style="color: #9876AA">12</span><span style="color: #007700">, </span><span style="color: #9876AA">0</span><span style="color: #007700">, </span><span style="color: #9876AA">$from</span><span style="color: #007700">, </span><span style="color: #9876AA">$port</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #DD0000">"Received </span><span style="color: #9876AA">$buf</span><span style="color: #DD0000"> from remote address </span><span style="color: #9876AA">$from</span><span style="color: #DD0000"> and remote port </span><span style="color: #9876AA">$port</span><span style="color: #DD0000">" </span><span style="color: #007700">. </span><span style="color: #9876AA">PHP_EOL</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>     此示例将在 127.0.0.1 的 1233 端口上初始化 UDP 套接字，并打印从远程主机收到的至少 12 个字符。    </p></div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.socket-recvfrom-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link socket_recv()} - 从已连接的 socket 接收数据</span></li>    <li class="member"><span class="function">{@link socket_send()} - 向已连接的套接字发送数据</span></li>    <li class="member"><span class="function">{@link socket_sendto()} - 向套接字发送消息，无论它是否已建立连接</span></li>    <li class="member"><span class="function">{@link socket_create()} - 创建一个套接字（通讯节点）</span></li>   </ul>  </span> </div></div>