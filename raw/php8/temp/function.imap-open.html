<div id="function.imap-open" class="refentry"> <div class="refnamediv">  <h1 class="refname">imap_open</h1>  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">imap_open</span> &mdash; <span class="dc-title">Open an <abbr title="Internet Message Access Protocol">IMAP</abbr> stream to a mailbox</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.imap-open-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>imap_open</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$mailbox</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$user</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$password</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$flags</span><span class="initializer"> = 0</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$retries</span><span class="initializer"> = 0</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = []</span></span><br>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.imap-connection.php" class="type IMAP\Connection" style="color:#EAB766">IMAP\Connection</a></span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   Opens an <abbr title="Internet Message Access Protocol">IMAP</abbr> stream to a <span class="parameter" style="color:#3A95FF">mailbox</span>.  </p>  <p class="para">   This function can also be used to open streams to <abbr title="Post Office Protocol version 3">POP3</abbr> and   <abbr title="Network News Transfer Protocol">NNTP</abbr> servers, but some functions and features are only   available on <abbr title="Internet Message Access Protocol">IMAP</abbr> servers.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.imap-open-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">mailbox</span></dt>     <dd>      <p class="para">       A mailbox name consists of a server and a mailbox path on this server.       The special name <span>INBOX</span> stands for the current users       personal mailbox. Mailbox names that contain international characters       besides those in the printable ASCII space have to be encoded with       <span class="function">{@link imap_utf7_encode()}</span>.      </p>      <div class="warning"><strong class="warning">警告</strong><p class="simpara">Passing untrusted data to this parameter is <em>insecure</em>, unless<a href="https://www.php.net/manual/zh/imap.configuration.php#ini.imap.enable-insecure-rsh" class="link">imap.enable_insecure_rsh</a> is disabled.</p></div>      <p class="para">       The server part, which is enclosed in &#039;{&#039; and &#039;}&#039;, consists of the servers       name or ip address, an optional port (prefixed by &#039;:&#039;), and an optional       protocol specification (prefixed by &#039;/&#039;).       </p>      <p class="para">       The server part is mandatory in all mailbox       parameters.       </p>      <p class="para">       All names which start with <span>{</span> are remote names, and are       in the form <span>&quot;{&quot; remote_system_name [&quot;:&quot; port] [flags] &quot;}&quot;       [mailbox_name]</span> where:       <ul class="itemizedlist">        <li class="listitem">         <span class="simpara">          <span>remote_system_name</span> - Internet domain name or          bracketed IP address of server.         </span>        </li>        <li class="listitem">         <span class="simpara">          <span>port</span> - optional TCP port number, default is the          default port for that service         </span>        </li>        <li class="listitem">         <span class="simpara">          <span>flags</span> - optional flags, see following table.         </span>        </li>        <li class="listitem">         <span class="simpara">          <span>mailbox_name</span> - remote mailbox name, default is INBOX         </span>        </li>       </ul>      </p>      <p class="para">       <table class="doctable table">        <caption><strong>Optional flags for names</strong></caption>                 <thead>          <tr>           <th>Flag</th>           <th>Description</th>          </tr>         </thead>         <tbody class="tbody">          <tr>           <td><span>/service=</span><em>service</em></td>           <td>mailbox access service, default is &quot;imap&quot;</td>          </tr>          <tr>           <td><span>/user=</span><em>user</em></td>           <td>remote user name for login on the server</td>          </tr>          <tr>           <td><span>/authuser=</span><em>user</em></td>           <td>remote authentication user; if specified this is the user name            whose password is used (e.g. administrator)</td>          </tr>          <tr>           <td><span>/anonymous</span></td>           <td>remote access as anonymous user</td>          </tr>          <tr>           <td><span>/debug</span></td>           <td>record protocol telemetry in application&#039;s debug log</td>          </tr>          <tr>           <td><span>/secure</span></td>           <td>do not transmit a plaintext password over the network</td>          </tr>          <tr>           <td><span>/imap</span>, <span>/imap2</span>,            <span>/imap2bis</span>, <span>/imap4</span>,            <span>/imap4rev1</span></td>           <td>equivalent to <span>/service=imap</span></td>          </tr>          <tr>           <td><span>/pop3</span></td>           <td>equivalent to <span>/service=pop3</span></td>          </tr>          <tr>           <td><span>/nntp</span></td>           <td>equivalent to <span>/service=nntp</span></td>          </tr>          <tr>           <td><span>/norsh</span></td>           <td>do not use rsh or ssh to establish a preauthenticated IMAP            session</td>          </tr>          <tr>           <td><span>/ssl</span></td>           <td>use the <span>Secure Socket Layer</span> to encrypt the session</td>          </tr>          <tr>           <td><span>/validate-cert</span></td>           <td>validate certificates from TLS/SSL server (this is the default            behavior)</td>          </tr>          <tr>           <td><span>/novalidate-cert</span></td>           <td>do not validate certificates from TLS/SSL server, needed if            server uses self-signed certificates</td>          </tr>          <tr>           <td><span>/tls</span></td>           <td>force use of <span>start-TLS</span> to encrypt the session, and reject            connection to servers that do not support it</td>          </tr>          <tr>           <td><span>/notls</span></td>           <td>do not do <span>start-TLS</span> to encrypt the session, even with servers            that support it</td>          </tr>          <tr>           <td><span>/readonly</span></td>           <td>request read-only mailbox open (IMAP only; ignored on NNTP, and            an error with SMTP and POP3)</td>          </tr>         </tbody>               </table>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">user</span></dt>     <dd>      <p class="para">       The user name      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">password</span></dt>     <dd>      <p class="para">       The password associated with the <span class="parameter" style="color:#3A95FF">user</span>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">flags</span></dt>     <dd>      <p class="para">       The <span class="parameter" style="color:#3A95FF">flags</span> are a bit mask with one or more of       the following:       <ul class="itemizedlist">        <li class="listitem">         <span class="simpara">          <strong><span>OP_READONLY</span></strong> - Open mailbox read-only         </span>        </li>        <li class="listitem">         <span class="simpara">          <strong><span>OP_ANONYMOUS</span></strong> - Don&#039;t use or update a          <var class="filename">.newsrc</var> for news (NNTP only)         </span>        </li>        <li class="listitem">         <span class="simpara">          <strong><span>OP_HALFOPEN</span></strong> - For <abbr title="Internet Message Access Protocol">IMAP</abbr>          and <abbr title="Network News Transfer Protocol">NNTP</abbr> names, open a connection but          don&#039;t open a mailbox.         </span>        </li>        <li class="listitem">         <span class="simpara">          <strong><span>CL_EXPUNGE</span></strong> - Expunge mailbox automatically upon mailbox close          (see also <span class="function">{@link imap_delete()}</span> and          <span class="function">{@link imap_expunge()}</span>)         </span>        </li>        <li class="listitem">         <span class="simpara">          <strong><span>OP_DEBUG</span></strong> - Debug protocol negotiations         </span>        </li>        <li class="listitem">         <span class="simpara">          <strong><span>OP_SHORTCACHE</span></strong> - Short (<span>elt</span>-only) caching         </span>        </li>        <li class="listitem">         <span class="simpara">          <strong><span>OP_SILENT</span></strong> - Don&#039;t pass up events (internal use)         </span>        </li>        <li class="listitem">         <span class="simpara">          <strong><span>OP_PROTOTYPE</span></strong> - Return driver prototype         </span>        </li>        <li class="listitem">         <span class="simpara">          <strong><span>OP_SECURE</span></strong> - Don&#039;t do non-secure authentication         </span>        </li>       </ul>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">retries</span></dt>     <dd>      <p class="para">       Number of maximum connect attempts      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">options</span></dt>     <dd>      <p class="para">       Connection parameters, the following (string) keys maybe used        to set one or more connection parameters:       <ul class="itemizedlist">        <li class="listitem">         <span class="simpara">          <span>DISABLE_AUTHENTICATOR</span> - Disable authentication properties         </span>        </li>       </ul>      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.imap-open-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   Returns an <span class="classname"><a href="https://www.php.net/manual/zh/class.imap-connection.php" class="classname">IMAP\Connection</a></span> instance on success, 或者在失败时返回 <strong><span>false</span></strong>.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.imap-open-changelog">  <h3 class="title">更新日志</h3>  <table class="doctable informaltable">       <thead>     <tr>      <th>版本</th>      <th>说明</th>     </tr>    </thead>    <tbody class="tbody">     <tr>      <td>8.1.0</td>      <td>       Returns an <span class="classname"><a href="https://www.php.net/manual/zh/class.imap-connection.php" class="classname">IMAP\Connection</a></span> instance now;       previously, a <a href="https://www.php.net/manual/zh/language.types.resource.php" class="link">resource</a> was returned.      </td>     </tr>    </tbody>     </table> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.imap-open-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 Different use of <span class="function"><strong style="color:#CC7832">imap_open()</strong></span></strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// To connect to an IMAP server running on port 143 on the local machine,<br />// do the following:<br /></span><span style="color: #9876AA">$mbox </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_open</span><span style="color: #007700">(</span><span style="color: #DD0000">"{localhost:143}INBOX"</span><span style="color: #007700">, </span><span style="color: #DD0000">"user_id"</span><span style="color: #007700">, </span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// To connect to a POP3 server on port 110 on the local server, use:<br /></span><span style="color: #9876AA">$mbox </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_open </span><span style="color: #007700">(</span><span style="color: #DD0000">"{localhost:110/pop3}INBOX"</span><span style="color: #007700">, </span><span style="color: #DD0000">"user_id"</span><span style="color: #007700">, </span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// To connect to an SSL IMAP or POP3 server, add /ssl after the protocol<br />// specification:<br /></span><span style="color: #9876AA">$mbox </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_open </span><span style="color: #007700">(</span><span style="color: #DD0000">"{localhost:993/imap/ssl}INBOX"</span><span style="color: #007700">, </span><span style="color: #DD0000">"user_id"</span><span style="color: #007700">, </span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// To connect to an SSL IMAP or POP3 server with a self-signed certificate,<br />// add /ssl/novalidate-cert after the protocol specification:<br /></span><span style="color: #9876AA">$mbox </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_open </span><span style="color: #007700">(</span><span style="color: #DD0000">"{localhost:995/pop3/ssl/novalidate-cert}"</span><span style="color: #007700">, </span><span style="color: #DD0000">"user_id"</span><span style="color: #007700">, </span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// To connect to an NNTP server on port 119 on the local server, use:<br /></span><span style="color: #9876AA">$nntp </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_open </span><span style="color: #007700">(</span><span style="color: #DD0000">"{localhost:119/nntp}comp.test"</span><span style="color: #007700">, </span><span style="color: #DD0000">""</span><span style="color: #007700">, </span><span style="color: #DD0000">""</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">// To connect to a remote server replace "localhost" with the name or the<br />// IP address of the server you want to connect to.<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>   <div class="example" id="">    <p><strong>示例 #2 <span class="function"><strong style="color:#CC7832">imap_open()</strong></span> example</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$mbox </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_open</span><span style="color: #007700">(</span><span style="color: #DD0000">"{imap.example.org:143}"</span><span style="color: #007700">, </span><span style="color: #DD0000">"username"</span><span style="color: #007700">, </span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #DD0000">"&lt;h1&gt;Mailboxes&lt;/h1&gt;\n"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$folders </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_listmailbox</span><span style="color: #007700">(</span><span style="color: #9876AA">$mbox</span><span style="color: #007700">, </span><span style="color: #DD0000">"{imap.example.org:143}"</span><span style="color: #007700">, </span><span style="color: #DD0000">"*"</span><span style="color: #007700">);<br /><br />if (</span><span style="color: #9876AA">$folders </span><span style="color: #007700">== </span><span style="color: #9876AA">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"Call failed&lt;br /&gt;\n"</span><span style="color: #007700">;<br />} else {<br />    foreach (</span><span style="color: #9876AA">$folders </span><span style="color: #007700">as </span><span style="color: #9876AA">$val</span><span style="color: #007700">) {<br />        echo </span><span style="color: #9876AA">$val </span><span style="color: #007700">. </span><span style="color: #DD0000">"&lt;br /&gt;\n"</span><span style="color: #007700">;<br />    }<br />}<br /><br />echo </span><span style="color: #DD0000">"&lt;h1&gt;Headers in INBOX&lt;/h1&gt;\n"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$headers </span><span style="color: #007700">= </span><span style="color: #9876AA">imap_headers</span><span style="color: #007700">(</span><span style="color: #9876AA">$mbox</span><span style="color: #007700">);<br /><br />if (</span><span style="color: #9876AA">$headers </span><span style="color: #007700">== </span><span style="color: #9876AA">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"Call failed&lt;br /&gt;\n"</span><span style="color: #007700">;<br />} else {<br />    foreach (</span><span style="color: #9876AA">$headers </span><span style="color: #007700">as </span><span style="color: #9876AA">$val</span><span style="color: #007700">) {<br />        echo </span><span style="color: #9876AA">$val </span><span style="color: #007700">. </span><span style="color: #DD0000">"&lt;br /&gt;\n"</span><span style="color: #007700">;<br />    }<br />}<br /><br /></span><span style="color: #9876AA">imap_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$mbox</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.imap-open-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link imap_close()} - Close an IMAP stream</span></li>   </ul>  </span> </div></div>