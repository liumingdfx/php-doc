<div id="function.eio-readdir" class="refentry"> <div class="refnamediv">  <h1 class="refname">eio_readdir</h1>  <p class="verinfo">(PECL eio &gt;= 0.0.1dev)</p><p class="refpurpose"><span class="refname">eio_readdir</span> &mdash; <span class="dc-title">Reads through a whole directory</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.eio-readdir-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>eio_readdir</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$path</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$flags</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$pri</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.callable.php" class="type callable" style="color:#EAB766">callable</a></span> <span class="parameter" style="color:#3A95FF">$callback</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$data</span><span class="initializer"> = NULL</span></span><br>): <span class="type" style="color:#EAB766">resource</span></div>  <p class="para rdfs-comment">   Reads through a whole directory(via the <span>opendir</span>, <span>readdir</span> and   <span>closedir</span> system calls) and returns either the names or an array in   <span class="parameter" style="color:#3A95FF">result</span> argument of <span class="parameter" style="color:#3A95FF">callback</span>   function, depending on the <span class="parameter" style="color:#3A95FF">flags</span> argument.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.eio-readdir-parameters">  <h3 class="title">参数</h3>  <dl>       <dt><span class="parameter" style="color:#3A95FF">path</span></dt>    <dd>     <span>      Directory path.     </span>    </dd>          <dt><span class="parameter" style="color:#3A95FF">flags</span></dt>    <dd>     <p class="para">      Combination of <em>EIO_READDIR_*</em> constants.     </p>    </dd>          <dt><span class="parameter" style="color:#3A95FF">pri</span></dt>    <dd>     <p class="para">请求的优先级：<strong><span>EIO_PRI_DEFAULT</span></strong>，<strong><span>EIO_PRI_MIN</span></strong>，<strong><span>EIO_PRI_MAX</span></strong> 或 <strong><span>null</span></strong>。如果是<strong><span>null</span></strong>，<span class="parameter" style="color:#3A95FF">pri</span> 将设为<strong><span>EIO_PRI_DEFAULT</span></strong>。</p>    </dd>          <dt><span class="parameter" style="color:#3A95FF">callback</span></dt>    <dd>      <p class="para"><span class="parameter" style="color:#3A95FF">callback</span>函数在请求完成时被调用。其应匹配一下原型：<div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000">void callback(mixed $data, int $result[, resource $req]);</span></span></div></div><dl>   <dt><span class="parameter" style="color:#3A95FF">data</span></dt>  <dd><p class="para">传递给请求的用户数据。</p></dd>    <dt><span class="parameter" style="color:#3A95FF">result</span></dt>  <dd><p class="para">针对请求的结果的值。通常是相应的系统调用返回的值。</p></dd>    <dt><span class="parameter" style="color:#3A95FF">req</span></dt>  <dd><p class="para">可选的请求资源，可被 <span class="function">{@link eio_get_last_error()}</span>   之类的函数使用。</p></dd> </dl></p>    </dd>          <dt><span class="parameter" style="color:#3A95FF">data</span></dt>    <dd>     <p class="para">      Arbitrary variable passed to <span class="parameter" style="color:#3A95FF">callback</span>.     </p>    </dd>     </dl> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.eio-readdir-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   <span class="function"><strong style="color:#CC7832">eio_readdir()</strong></span> returns request resource on success, 或者在失败时返回 <strong><span>false</span></strong>.    Sets <span class="parameter" style="color:#3A95FF">result</span> argument of   <span class="parameter" style="color:#3A95FF">callback</span> function according to   <span class="parameter" style="color:#3A95FF">flags</span>:  </p>  <p class="para">   <dl>             <dt>      <strong><span>EIO_READDIR_DENTS</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">       <span class="function"><strong style="color:#CC7832">eio_readdir()</strong></span> flag. If specified, the result argument of the callback       becomes an array with the following keys:       <span>&#039;names&#039;</span> - array of directory names       <span>&#039;dents&#039;</span> - array of <span>struct       eio_dirent</span>-like arrays having the following keys each:       <span>&#039;name&#039;</span> - the directory name;       <span>&#039;type&#039;</span> - one of <em>EIO_DT_*</em>       constants;       <span>&#039;inode&#039;</span> - the inode number, if available, otherwise       unspecified;      </span>     </dd>             <dt>      <strong><span>EIO_READDIR_DIRS_FIRST</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      When this flag is specified, the names will be returned in an order      where likely directories come first, in optimal stat order.      </span>     </dd>             <dt>      <strong><span>EIO_READDIR_STAT_ORDER</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      When this flag is specified, then the names will be returned in an order      suitable for <span>stat</span>&#039;ing each one. When planning to      <span class="function">{@link stat()}</span> all files in the given directory, the      returned order will likely be      fastest.      </span>     </dd>             <dt>      <strong><span>EIO_READDIR_FOUND_UNKNOWN</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      </span>     </dd>       </dl>  </p>  <p class="para">Node types:   <dl>         <dt>      <strong><span>EIO_DT_UNKNOWN</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Unknown node type(very common). Further <span class="function">{@link stat()}</span> needed.      </span>     </dd>             <dt>      <strong><span>EIO_DT_FIFO</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      FIFO node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_CHR</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_MPC</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Multiplexed char device (v7+coherent) node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_DIR</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Directory node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_NAM</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Xenix special named file node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_BLK</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_MPB</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Multiplexed block device (v7+coherent)      </span>     </dd>             <dt>      <strong><span>EIO_DT_REG</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_NWK</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      </span>     </dd>             <dt>      <strong><span>EIO_DT_CMP</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      HP-UX network special node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_LNK</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Link node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_SOCK</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Socket node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_DOOR</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Solaris door node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_WHT</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Node type      </span>     </dd>             <dt>      <strong><span>EIO_DT_MAX</span></strong>      (<span class="type" style="color:#EAB766">int</span>)     </dt>     <dd>      <span class="simpara">      Highest node type value      </span>     </dd>          </dl>  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.eio-readdir-examples">  <h3 class="title">示例</h3>  <div class="example" id="">   <p><strong>示例 #1 <span class="function"><strong style="color:#CC7832">eio_readdir()</strong></span> example</strong></p>   <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// Is called when eio_readdir() finishes <br /></span><span style="color: #007700">function </span><span style="color: #9876AA">my_readdir_callback</span><span style="color: #007700">(</span><span style="color: #9876AA">$data</span><span style="color: #007700">, </span><span style="color: #9876AA">$result</span><span style="color: #007700">) {<br />    echo </span><span style="color: #9876AA">__FUNCTION__</span><span style="color: #007700">, </span><span style="color: #DD0000">" called\n"</span><span style="color: #007700">;<br />    echo </span><span style="color: #DD0000">"data: "</span><span style="color: #007700">; </span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$data</span><span style="color: #007700">);<br />    echo </span><span style="color: #DD0000">"result: "</span><span style="color: #007700">; </span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$result</span><span style="color: #007700">);<br />    echo </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #9876AA">eio_readdir</span><span style="color: #007700">(</span><span style="color: #DD0000">"/var/spool/news"</span><span style="color: #007700">, </span><span style="color: #9876AA">EIO_READDIR_STAT_ORDER </span><span style="color: #007700">| </span><span style="color: #9876AA">EIO_READDIR_DIRS_FIRST</span><span style="color: #007700">,<br />  </span><span style="color: #9876AA">EIO_PRI_DEFAULT</span><span style="color: #007700">, </span><span style="color: #DD0000">"my_readdir_callback"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">eio_event_loop</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>   </div>   <div class="example-contents"><p>以上示例的输出类似于：</p></div>   <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>my_readdir_callback called<br>data: NULL<br>result: array(2) {<br> [&quot;names&quot;]=&gt;<br>  array(7) {<br>   [0]=&gt;<br>    string(7) &quot;archive&quot;<br>    [1]=&gt;<br>    string(8) &quot;articles&quot;<br>    [2]=&gt;<br>    string(8) &quot;incoming&quot;<br>    [3]=&gt;<br>    string(7) &quot;innfeed&quot;<br>    [4]=&gt;<br>    string(8) &quot;outgoing&quot;<br>    [5]=&gt;<br>    string(8) &quot;overview&quot;<br>    [6]=&gt;<br>    string(3) &quot;tmp&quot;<br>  }<br> [&quot;dents&quot;]=&gt;<br>  array(7) {<br>   [0]=&gt;<br>    array(3)<br>    {<br>     [&quot;name&quot;]=&gt;<br>      string(7)<br>      &quot;archive&quot;<br>      [&quot;type&quot;]=&gt;<br>      int(4)<br>      [&quot;inode&quot;]=&gt;<br>      int(393265)<br>    }<br>   [1]=&gt;<br>    array(3)<br>    {<br>     [&quot;name&quot;]=&gt;<br>      string(8)<br>      &quot;articles&quot;<br>      [&quot;type&quot;]=&gt;<br>      int(4)<br>      [&quot;inode&quot;]=&gt;<br>      int(393266)<br>    }<br>   [2]=&gt;<br>    array(3)<br>    {<br>     [&quot;name&quot;]=&gt;<br>      string(8)<br>      &quot;incoming&quot;<br>      [&quot;type&quot;]=&gt;<br>      int(4)<br>      [&quot;inode&quot;]=&gt;<br>      int(393267)<br>    }<br>   [3]=&gt;<br>    array(3)<br>    {<br>     [&quot;name&quot;]=&gt;<br>      string(7)<br>      &quot;innfeed&quot;<br>      [&quot;type&quot;]=&gt;<br>      int(4)<br>      [&quot;inode&quot;]=&gt;<br>      int(393269)<br>    }<br>   [4]=&gt;<br>    array(3)<br>    {<br>     [&quot;name&quot;]=&gt;<br>      string(8)<br>      &quot;outgoing&quot;<br>      [&quot;type&quot;]=&gt;<br>      int(4)<br>      [&quot;inode&quot;]=&gt;<br>      int(393270)<br>    }<br>   [5]=&gt;<br>    array(3)<br>    {<br>     [&quot;name&quot;]=&gt;<br>      string(8)<br>      &quot;overview&quot;<br>      [&quot;type&quot;]=&gt;<br>      int(4)<br>      [&quot;inode&quot;]=&gt;<br>      int(393271)<br>    }<br>   [6]=&gt;<br>    array(3)<br>    {<br>     [&quot;name&quot;]=&gt;<br>      string(3)<br>      &quot;tmp&quot;<br>      [&quot;type&quot;]=&gt;<br>      int(4)<br>      [&quot;inode&quot;]=&gt;<br>      int(393272)<br>    }<br>  }<br>}<br></span></div>   </div>  </div> </div></div>