<div id="class.yaf-controller-abstract" class="reference"> <h1 class="title">Yaf_Controller_Abstract 类</h1>  <div class="partintro"><p class="verinfo">(Yaf &gt;=1.0.0)</p>  <div class="section" id="yaf-controller-abstract.intro">   <h2 class="title">简介</h2>   <p class="para">    <span class="classname"><strong class="classname">Yaf_Controller_Abstract</strong></span> 是 Yaf 系统的 MVC 体系的核心部分。MVC    是指 Model-View-Controller，是一个用于分离应用逻辑和表现逻辑的设计模式。   </p>   <p class="para">    每个自定义 controller 都应当继承 <span class="classname"><strong class="classname">Yaf_Controller_Abstract</strong></span>。   </p>   <p class="para">    自定义 controller 中无法定义 __construct 方法。因此，<span class="classname"><strong class="classname">Yaf_Controller_Abstract</strong></span>    提供了一个魔术方法 <span class="methodname" style="color:#CC7832">{@link Yaf_Controller_Abstract::init()}</span>。   </p>   <p class="para">    如果自定义 controller 里已经定义了 init() 方法，当实例化 controller 的时候，它将被调用。   </p>   <p class="para">    Action 可能需要参数，当请求来到的时候，在路由中如果请求的参数有相同名称的变量（例如：<span class="methodname" style="color:#CC7832">{@link Yaf_Request_Abstract::getParam()}</span>），Yaf    将把他们传递给 action 方法（参阅 <span class="methodname" style="color:#CC7832">{@link Yaf_Action_Abstract::execute()}</span>）。    <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:      <p class="para">      这些参数是直接获取的，没有过滤，使用他们之前应该仔细处理。     </p>    </p></blockquote>   </p>  </div>  <div class="section" id="yaf-controller-abstract.synopsis">   <h2 class="title">类摘要</h2>   <div class="classsynopsis">    <span class="ooclass"><strong class="classname"></strong></span>    <div class="classsynopsisinfo">     <span class="ooclass">      <span class="modifier">abstract</span>      <span class="modifier">class</span> <strong class="classname">Yaf_Controller_Abstract</strong>     </span>     {</div>    <div class="classsynopsisinfo classsynopsisinfo_comment">// 属性 </div>    <div class="fieldsynopsis">     <span class="modifier">public</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.yaf-controller-abstract.php#yaf-controller-abstract.props.actions">$<var class="varname">actions</var></a></var>;</div>    <div class="fieldsynopsis"><span class="modifier">protected</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.yaf-controller-abstract.php#yaf-controller-abstract.props.module">$<var class="varname">_module</var></a></var>;</div>    <div class="fieldsynopsis"><span class="modifier">protected</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.yaf-controller-abstract.php#yaf-controller-abstract.props.name">$<var class="varname">_name</var></a></var>;</div>    <div class="fieldsynopsis"><span class="modifier">protected</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.yaf-controller-abstract.php#yaf-controller-abstract.props.request">$<var class="varname">_request</var></a></var>;</div>    <div class="fieldsynopsis"><span class="modifier">protected</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.yaf-controller-abstract.php#yaf-controller-abstract.props.response">$<var class="varname">_response</var></a></var>;</div>    <div class="fieldsynopsis"><span class="modifier">protected</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.yaf-controller-abstract.php#yaf-controller-abstract.props.invoke-args">$<var class="varname">_invoke_args</var></a></var>;</div>    <div class="fieldsynopsis"><span class="modifier">protected</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.yaf-controller-abstract.php#yaf-controller-abstract.props.view">$<var class="varname">_view</var></a></var>;</div>        <div class="classsynopsisinfo classsynopsisinfo_comment">// 方法 </div>    <div class="constructorsynopsis dc-description">   <span class="modifier">final</span> <span class="modifier">private</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.construct.php" class="methodname" style="color:#CC7832">__construct</a></span>()</div>    <div class="methodsynopsis dc-description"><span class="modifier">protected</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.display.php" class="methodname" style="color:#CC7832">display</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$tpl</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">$parameters</span><span class="initializer"> = ?</span></span>): <span class="type" style="color:#EAB766">bool</span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.forward.php" class="methodname" style="color:#CC7832">forward</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$action</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">$paramters</span><span class="initializer"> = ?</span></span>): <span class="type" style="color:#EAB766">bool</span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.getinvokearg.php" class="methodname" style="color:#CC7832">getInvokeArg</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$name</span></span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.getinvokeargs.php" class="methodname" style="color:#CC7832">getInvokeArgs</a></span>(): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.getmodulename.php" class="methodname" style="color:#CC7832">getModuleName</a></span>(): <span class="type" style="color:#EAB766">string</span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.getname.php" class="methodname" style="color:#CC7832">getName</a></span>(): <span class="type" style="color:#EAB766">string</span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.getrequest.php" class="methodname" style="color:#CC7832">getRequest</a></span>(): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.yaf-request-abstract.php" class="type Yaf_Request_Abstract" style="color:#EAB766">Yaf_Request_Abstract</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.getresponse.php" class="methodname" style="color:#CC7832">getResponse</a></span>(): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.yaf-response-abstract.php" class="type Yaf_Response_Abstract" style="color:#EAB766">Yaf_Response_Abstract</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.getview.php" class="methodname" style="color:#CC7832">getView</a></span>(): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.yaf-view-interface.php" class="type Yaf_View_Interface" style="color:#EAB766">Yaf_View_Interface</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.getviewpath.php" class="methodname" style="color:#CC7832">getViewpath</a></span>(): <span class="type" style="color:#EAB766">string</span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.init.php" class="methodname" style="color:#CC7832">init</a></span>(): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.initview.php" class="methodname" style="color:#CC7832">initView</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = ?</span></span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.redirect.php" class="methodname" style="color:#CC7832">redirect</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$url</span></span>): <span class="type" style="color:#EAB766">bool</span></div><div class="methodsynopsis dc-description"><span class="modifier">protected</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.render.php" class="methodname" style="color:#CC7832">render</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$tpl</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">$parameters</span><span class="initializer"> = ?</span></span>): <span class="type" style="color:#EAB766">string</span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/yaf-controller-abstract.setviewpath.php" class="methodname" style="color:#CC7832">setViewpath</a></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$view_directory</span></span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div>   }</div>  </div>    <div class="section" id="yaf-controller-abstract.props">   <h2 class="title">属性</h2>   <dl>         <dt id="yaf-controller-abstract.props.actions"><var class="varname">actions</var></dt>     <dd>      <p class="para">       也可以通过使用此属性和 <span class="classname"><a href="https://www.php.net/manual/zh/class.yaf-action-abstract.php" class="classname">Yaf_Action_Abstract</a></span> 在一个单独的 PHP 脚本中定义 action 方法。      <div class="example" id="">       <p><strong>示例 #1 在单独的文件中定义 action</strong></p>        <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #9876AA">IndexController </span><span style="color: #007700">extends </span><span style="color: #9876AA">Yaf_Controller_Abstract </span><span style="color: #007700">{<br />    protected </span><span style="color: #9876AA">$actions </span><span style="color: #007700">= array(<br />        </span><span style="color: #FF8000">//* now dummyAction is defined in a separate file <br />        </span><span style="color: #DD0000">"dummy" </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"actions/Dummy_action.php"</span><span style="color: #007700">,<br />    );<br /><br />    </span><span style="color: #FF8000">// action method may have arguments <br />    </span><span style="color: #007700">public function </span><span style="color: #9876AA">indexAction</span><span style="color: #007700">(</span><span style="color: #9876AA">$name</span><span style="color: #007700">, </span><span style="color: #9876AA">$id</span><span style="color: #007700">) {<br />       </span><span style="color: #FF8000">// $name and $id are unsafe raw data <br />       </span><span style="color: #9876AA">assert</span><span style="color: #007700">(</span><span style="color: #9876AA">$name </span><span style="color: #007700">== </span><span style="color: #9876AA">$this</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">getRequest</span><span style="color: #007700">()-&gt;</span><span style="color: #9876AA">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">"name"</span><span style="color: #007700">));<br />       </span><span style="color: #9876AA">assert</span><span style="color: #007700">(</span><span style="color: #9876AA">$id   </span><span style="color: #007700">== </span><span style="color: #9876AA">$this</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">_request</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">getParam</span><span style="color: #007700">(</span><span style="color: #DD0000">"id"</span><span style="color: #007700">));<br />    }<br />}<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>        </div>      </div>      <div class="example" id="">       <p><strong>示例 #2 Dummy_action.php</strong></p>        <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #9876AA">DummyAction </span><span style="color: #007700">extends </span><span style="color: #9876AA">Yaf_Action_Abstract </span><span style="color: #007700">{<br />    </span><span style="color: #FF8000">// an action class shall define this method as the entry point <br />    </span><span style="color: #007700">public function </span><span style="color: #9876AA">execute</span><span style="color: #007700">() {<br />    }<br />}<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>        </div>      </div>      </p>     </dd>             <dt id="yaf-controller-abstract.props.module"><var class="varname">_module</var></dt>     <dd>      <p class="para">        模块名      </p>     </dd>             <dt id="yaf-controller-abstract.props.name"><var class="varname">_name</var></dt>     <dd>      <p class="para">        控制器名      </p>     </dd>             <dt id="yaf-controller-abstract.props.request"><var class="varname">_request</var></dt>     <dd>      <p class="para">       当前请求实例      </p>     </dd>             <dt id="yaf-controller-abstract.props.response"><var class="varname">_response</var></dt>     <dd>      <p class="para">       当前响应对象      </p>     </dd>             <dt id="yaf-controller-abstract.props.invoke-args"><var class="varname">_invoke_args</var></dt>     <dd>      <p class="para"/>     </dd>             <dt id="yaf-controller-abstract.props.view"><var class="varname">_view</var></dt>     <dd>      <p class="para">      视图引擎      </p>     </dd>       </dl>  </div> </div> <h2>目录</h2><ul class="chunklist chunklist_reference"><li>{@link Yaf_Controller_Abstract::__construct} — Yaf_Controller_Abstract 构造方法</li><li>{@link Yaf_Controller_Abstract::display} — The display purpose</li><li>{@link Yaf_Controller_Abstract::forward} — 转发到另一个动作</li><li>{@link Yaf_Controller_Abstract::getInvokeArg} — The getInvokeArg purpose</li><li>{@link Yaf_Controller_Abstract::getInvokeArgs} — The getInvokeArgs purpose</li><li>{@link Yaf_Controller_Abstract::getModuleName} — 获取当前控制器所属的模块名</li><li>{@link Yaf_Controller_Abstract::getName} — Get self name</li><li>{@link Yaf_Controller_Abstract::getRequest} — 检索当前请求对象</li><li>{@link Yaf_Controller_Abstract::getResponse} — 检索当前响应对象</li><li>{@link Yaf_Controller_Abstract::getView} — 获取当前的视图引擎</li><li>{@link Yaf_Controller_Abstract::getViewpath} — The getViewpath purpose</li><li>{@link Yaf_Controller_Abstract::init} — 控制器初始化</li><li>{@link Yaf_Controller_Abstract::initView} — The initView purpose</li><li>{@link Yaf_Controller_Abstract::redirect} — 重定向到 URL</li><li>{@link Yaf_Controller_Abstract::render} — 渲染视图模板</li><li>{@link Yaf_Controller_Abstract::setViewpath} — The setViewpath purpose</li></ul></div>