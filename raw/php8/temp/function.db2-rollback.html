<div id="function.db2-rollback" class="refentry"> <div class="refnamediv">  <h1 class="refname">db2_rollback</h1>  <p class="verinfo">(PECL ibm_db2 &gt;= 1.0.0)</p><p class="refpurpose"><span class="refname">db2_rollback</span> &mdash; <span class="dc-title">   Rolls back a transaction  </span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.db2-rollback-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>db2_rollback</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">resource</span> <span class="parameter" style="color:#3A95FF">$connection</span></span>): <span class="type" style="color:#EAB766">bool</span></div>  <p class="para rdfs-comment">   Rolls back an in-progress transaction on the specified connection resource and   begins a new transaction. PHP applications normally default to AUTOCOMMIT   mode, so <span class="function"><strong style="color:#CC7832">db2_rollback()</strong></span> normally has no effect unless   AUTOCOMMIT has been turned off for the connection resource.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.db2-rollback-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">connection</span></dt>     <dd>      <p class="para">       A valid database connection resource variable as returned from       <span class="function">{@link db2_connect()}</span> or <span class="function">{@link db2_pconnect()}</span>.      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.db2-rollback-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   成功时返回 <strong><span>true</span></strong>， 或者在失败时返回 <strong><span>false</span></strong>。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.db2-rollback-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="example-3863">    <p><strong>示例 #1 Rolling back a DELETE statement</strong></p>    <div class="example-contents"><p>     In the following example, we count the number of rows in a table, turn     off AUTOCOMMIT mode on a database connection, delete all of the rows in     the table and return the count of <span>0</span> to prove that the     rows have been removed. We then issue <span class="function"><strong style="color:#CC7832">db2_rollback()</strong></span>     and return the updated count of rows in the table to show that the number     is the same as before we issued the DELETE statement. The return to the     original state of the table demonstrates that the roll back of the     transaction succeeded.    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_connect</span><span style="color: #007700">(</span><span style="color: #9876AA">$database</span><span style="color: #007700">, </span><span style="color: #9876AA">$user</span><span style="color: #007700">, </span><span style="color: #9876AA">$password</span><span style="color: #007700">);<br /><br />if (</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$stmt </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_exec</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT count(*) FROM animals"</span><span style="color: #007700">);<br />    </span><span style="color: #9876AA">$res </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_fetch_array</span><span style="color: #007700">( </span><span style="color: #9876AA">$stmt </span><span style="color: #007700">);<br />    echo </span><span style="color: #9876AA">$res</span><span style="color: #007700">[</span><span style="color: #9876AA">0</span><span style="color: #007700">] . </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />    <br />    </span><span style="color: #FF8000">// Turn AUTOCOMMIT off<br />    </span><span style="color: #9876AA">db2_autocommit</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">DB2_AUTOCOMMIT_OFF</span><span style="color: #007700">);<br />   <br />    </span><span style="color: #FF8000">// Delete all rows from ANIMALS<br />    </span><span style="color: #9876AA">db2_exec</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"DELETE FROM animals"</span><span style="color: #007700">);<br />    <br />    </span><span style="color: #9876AA">$stmt </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_exec</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT count(*) FROM animals"</span><span style="color: #007700">);<br />    </span><span style="color: #9876AA">$res </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_fetch_array</span><span style="color: #007700">( </span><span style="color: #9876AA">$stmt </span><span style="color: #007700">);<br />    echo </span><span style="color: #9876AA">$res</span><span style="color: #007700">[</span><span style="color: #9876AA">0</span><span style="color: #007700">] . </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />    <br />    </span><span style="color: #FF8000">// Roll back the DELETE statement<br />    </span><span style="color: #9876AA">db2_rollback</span><span style="color: #007700">( </span><span style="color: #9876AA">$conn </span><span style="color: #007700">);<br />    <br />    </span><span style="color: #9876AA">$stmt </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_exec</span><span style="color: #007700">( </span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT count(*) FROM animals" </span><span style="color: #007700">);<br />    </span><span style="color: #9876AA">$res </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_fetch_array</span><span style="color: #007700">( </span><span style="color: #9876AA">$stmt </span><span style="color: #007700">);<br />    echo </span><span style="color: #9876AA">$res</span><span style="color: #007700">[</span><span style="color: #9876AA">0</span><span style="color: #007700">] . </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />    </span><span style="color: #9876AA">db2_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br />}<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例会输出：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>7<br>0<br>7<br></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.db2-rollback-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link db2_autocommit()} - Returns or sets the AUTOCOMMIT state for a database connection</span></li>    <li class="member"><span class="function">{@link db2_commit()} - Commits a transaction</span></li>   </ul>  </span> </div></div>