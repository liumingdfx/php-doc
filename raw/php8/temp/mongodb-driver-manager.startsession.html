<div id="mongodb-driver-manager.startsession" class="refentry"> <div class="refnamediv">  <h1 class="refname">MongoDB\Driver\Manager::startSession</h1>  <p class="verinfo">(mongodb &gt;=1.4.0)</p><p class="refpurpose"><span class="refname">MongoDB\Driver\Manager::startSession</span> &mdash; <span class="dc-title">Start a new client session for use with this client</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-mongodb-driver-manager.startsession-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="modifier">final</span> <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><strong>MongoDB\Driver\Manager::startSession</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = <strong><span>null</span></strong></span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mongodb-driver-session.php" class="type MongoDB\Driver\Session" style="color:#EAB766">MongoDB\Driver\Session</a></span></div>  <p class="para rdfs-comment">   Creates a <span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-session.php" class="classname">MongoDB\Driver\Session</a></span> for the given   options. The session may then be specified when executing commands, queries,   and write operations.  </p>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <span class="simpara">    A <span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-session.php" class="classname">MongoDB\Driver\Session</a></span> can only be used with the    <span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-manager.php" class="classname">MongoDB\Driver\Manager</a></span> from which it was created.   </span>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-mongodb-driver-manager.startsession-parameters">  <h3 class="title">参数</h3>  <dl>       <dt><span class="parameter" style="color:#3A95FF">options</span></dt>    <dd>     <span>      <table class="doctable table">       <caption><strong>options</strong></caption>               <thead>         <tr>          <th>Option</th>          <th>Type</th>          <th>Description</th>          <th>Default</th>         </tr>        </thead>        <tbody class="tbody">         <tr>          <td>causalConsistency</td>          <td><span class="type" style="color:#EAB766">bool</span></td>          <td>           <p class="para">            Configure causal consistency in a session. If <strong><span>true</span></strong>, each operation            in the session will be causally ordered after the previous read or            write operation. Set to <strong><span>false</span></strong> to disable causal consistency.           </p>           <p class="para">            See            <a href="https://www.php.net/manual/zh/https://www.mongodb.com/docs/manual/core/read-isolation-consistency-recency/#causal-consistency" class="link external">&raquo;&nbsp;Casual Consistency</a>            in the MongoDB manual for more information.           </p>          </td>          <td><strong><span>true</span></strong></td>         </tr>         <tr>          <td>defaultTransactionOptions</td>          <td><span class="type" style="color:#EAB766">array</span></td>          <td>           <p class="para">            Default options to apply to newly created transactions. These            options are used unless they are overridden when a transaction is            started with different value for each option.           </p>           <p class="para">            <table class="doctable table">             <caption><strong>options</strong></caption>                           <thead>               <tr>                <th>Option</th>                <th>Type</th>                <th>Description</th>               </tr>              </thead>              <tbody class="tbody">                        <tr>          <td>maxCommitTimeMS</td>          <td>integer</td>          <td>           <p class="para">            The maximum amount of time in milliseconds to allow a single            <span>commitTransaction</span> command to run.           </p>           <p class="para">            If specified, <span>maxCommitTimeMS</span> must be a signed            32-bit integer greater than or equal to zero.           </p>          </td>         </tr>                        <tr>          <td>readConcern</td>          <td><span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-readconcern.php" class="classname">MongoDB\Driver\ReadConcern</a></span></td>          <td>           <p class="para">            A read concern to apply to the operation.           </p>           <p class="para">            This option is available in MongoDB 3.2+ and will result in an            exception at execution time if specified for an older server            version.           </p>          </td>         </tr>                        <tr>          <td>readPreference</td>          <td><span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-readpreference.php" class="classname">MongoDB\Driver\ReadPreference</a></span></td>          <td>           <p class="para">            A read preference to use for selecting a server for the operation.           </p>          </td>         </tr>                        <tr>          <td>writeConcern</td>          <td><span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-writeconcern.php" class="classname">MongoDB\Driver\WriteConcern</a></span></td>          <td>           <p class="para">            A write concern to apply to the operation.           </p>          </td>         </tr>              </tbody>                         </table>           </p>           <p class="para">            This option is available in MongoDB 4.0+.           </p>          </td>          <td><span>[]</span></td>         </tr>         <tr>          <td>snapshot</td>          <td><span class="type" style="color:#EAB766">bool</span></td>          <td>           <p class="para">            Configure snapshot reads in a session. If <strong><span>true</span></strong>, a timestamp will            be obtained from the first supported read operation in the session            (i.e. <span>find</span>, <span>aggregate</span>, or            unsharded <span>distinct</span>). Subsequent read operations            within the session will then utilize a <span>&quot;snapshot&quot;</span>            read concern level to read majority-committed data from that            timestamp. Set to <strong><span>false</span></strong> to disable snapshot reads.           </p>           <p class="para">            Snapshot reads require MongoDB 5.0+ and cannot be used with causal            consistency, transactions, or write operations. If            <span>&quot;snapshot&quot;</span> is <strong><span>true</span></strong>,            <span>&quot;causalConsistency&quot;</span> will default to <strong><span>false</span></strong>.           </p>           <p class="para">            See            <a href="https://www.php.net/manual/zh/https://www.mongodb.com/docs/manual/reference/read-concern-snapshot/#read-concern-and-atclustertime" class="link external">&raquo;&nbsp;Read Concern &quot;snapshot&quot;</a>            in the MongoDB manual for more information.           </p>          </td>          <td><strong><span>false</span></strong></td>         </tr>        </tbody>             </table>     </span>    </dd>     </dl> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-mongodb-driver-manager.startsession-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   Returns a <span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-session.php" class="classname">MongoDB\Driver\Session</a></span>.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 errors" id="refsect1-mongodb-driver-manager.startsession-errors">  <h3 class="title">错误／异常</h3>  <ul class="simplelist">   <li class="member">Throws <span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-exception-invalidargumentexception.php" class="classname">MongoDB\Driver\Exception\InvalidArgumentException</a></span> on argument parsing errors.</li>   <li class="member">Throws <span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-exception-invalidargumentexception.php" class="classname">MongoDB\Driver\Exception\InvalidArgumentException</a></span> if the <span>&quot;causalConsistency&quot;</span> and <span>&quot;snapshot&quot;</span> options are both <strong><span>true</span></strong>.</li>   <li class="member">Throws <span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-exception-runtimeexception.php" class="classname">MongoDB\Driver\Exception\RuntimeException</a></span> if the session could not be created (e.g. libmongoc does not support crypto).</li>  </ul> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-mongodb-driver-manager.startsession-changelog">  <h3 class="title">更新日志</h3>  <span>   <table class="doctable informaltable">         <thead>      <tr>       <th>版本</th>       <th>说明</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td>PECL mongodb 1.11.0</td>       <td>        <p class="para">         The <span>&quot;snapshot&quot;</span> option was added.        </p>       </td>      </tr>      <tr>       <td>PECL mongodb 1.6.0</td>       <td>        <p class="para">         The <span>&quot;maxCommitTimeMS&quot;</span> option was added to         <span>&quot;defaultTransactionOptions&quot;</span>.        </p>       </td>      </tr>      <tr>       <td>PECL mongodb 1.5.0</td>       <td>        <p class="para">         The <span>&quot;defaultTransactionOptions&quot;</span> option was added.        </p>       </td>      </tr>     </tbody>       </table>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-mongodb-driver-manager.startsession-seealso">  <h3 class="title">参见</h3>  <ul class="simplelist">   <li class="member"><span class="classname"><a href="https://www.php.net/manual/zh/class.mongodb-driver-session.php" class="classname">MongoDB\Driver\Session</a></span></li>   <li class="member"><a href="https://www.php.net/manual/zh/https://www.mongodb.com/docs/manual/core/read-isolation-consistency-recency/#causal-consistency" class="link external">&raquo;&nbsp;Casual Consistency</a> in the MongoDB manual</li>  </ul> </div></div>