<div id="function.shmop-open" class="refentry"> <div class="refnamediv">  <h1 class="refname">shmop_open</h1>  <p class="verinfo">(PHP 4 &gt;= 4.0.4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">shmop_open</span> &mdash; <span class="dc-title">Create or open shared memory block</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.shmop-open-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>shmop_open</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$key</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$mode</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$permissions</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$size</span></span><br>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.shmop.php" class="type Shmop" style="color:#EAB766">Shmop</a></span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   <span class="function"><strong style="color:#CC7832">shmop_open()</strong></span> can create or open a shared memory block.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.shmop-open-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">key</span></dt>     <dd>      <p class="para">       System&#039;s id for the shared memory block.       Can be passed as a decimal or hex.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">mode</span></dt>     <dd>      <p class="para">       The flags that you can use:       <ul class="itemizedlist">        <li class="listitem">         <span class="simpara">          &quot;a&quot; for access (sets SHM_RDONLY for shmat)          use this flag when you need to open an existing shared memory          segment for read only         </span>        </li>        <li class="listitem">         <span class="simpara">          &quot;c&quot; for create (sets IPC_CREATE)          use this flag when you need to create a new shared memory segment          or if a segment with the same key exists, try to open it for read          and write         </span>        </li>        <li class="listitem">         <span class="simpara">          &quot;w&quot; for read &amp; write access          use this flag when you need to read and write to a shared memory          segment, use this flag in most cases.         </span>        </li>        <li class="listitem">         <span class="simpara">          &quot;n&quot; create a new memory segment (sets IPC_CREATE|IPC_EXCL)          use this flag when you want to create a new shared memory segment          but if one already exists with the same flag, fail. This is useful          for security purposes, using this you can prevent race condition          exploits.         </span>        </li>       </ul>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">permissions</span></dt>     <dd>      <p class="para">       The permissions that you wish to assign to your memory segment, those       are the same as permission for a file. Permissions need to be passed       in octal form, like for example <span>0644</span>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">size</span></dt>     <dd>      <p class="para">       The size of the shared memory block you wish to create in bytes      </p>     </dd>       </dl>   <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:     <p class="para">     Note: the 3rd and 4th should be entered as 0 if you are opening an     existing memory segment.    </p>   </span></blockquote>  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.shmop-open-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   On success <span class="function"><strong style="color:#CC7832">shmop_open()</strong></span> will return a <span class="classname"><a href="https://www.php.net/manual/zh/class.shmop.php" class="classname">Shmop</a></span> instance that you can   use to access the shared memory segment you&#039;ve created. <strong><span>false</span></strong> is   returned on failure.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 errors" id="refsect1-function.shmop-open-errors">  <h3 class="title">错误／异常</h3>  <p class="para">   If <span class="parameter" style="color:#3A95FF">mode</span> is invalid, or <span class="parameter" style="color:#3A95FF">size</span> is less than or equal to zero,   a <span class="classname"><a href="https://www.php.net/manual/zh/class.valueerror.php" class="classname">ValueError</a></span> is thrown.   On other failures, <strong><span>E_WARNING</span></strong> is emitted.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.shmop-open-changelog">  <h3 class="title">更新日志</h3>  <table class="doctable informaltable">       <thead>     <tr>      <th>版本</th>      <th>说明</th>     </tr>    </thead>    <tbody class="tbody">     <tr>      <td>8.0.0</td>      <td>       On success, this function returns an <span class="classname"><a href="https://www.php.net/manual/zh/class.shmop.php" class="classname">Shmop</a></span> instance now;       previously, a <span class="type" style="color:#EAB766">resource</span> was returned.      </td>     </tr>     <tr>      <td>8.0.0</td>      <td>       If <span class="parameter" style="color:#3A95FF">mode</span> is invalid, or <span class="parameter" style="color:#3A95FF">size</span> is less than or equal to zero,       a <span class="classname"><a href="https://www.php.net/manual/zh/class.valueerror.php" class="classname">ValueError</a></span> is thrown; previously <strong><span>E_WARNING</span></strong> was emitted instead,       and the function returned <strong><span>false</span></strong>.      </td>     </tr>    </tbody>     </table> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.shmop-open-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 Create a new shared memory block</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$shm_key </span><span style="color: #007700">= </span><span style="color: #9876AA">ftok</span><span style="color: #007700">(</span><span style="color: #9876AA">__FILE__</span><span style="color: #007700">, </span><span style="color: #DD0000">'t'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$shm_id </span><span style="color: #007700">= </span><span style="color: #9876AA">shmop_open</span><span style="color: #007700">(</span><span style="color: #9876AA">$shm_key</span><span style="color: #007700">, </span><span style="color: #DD0000">"c"</span><span style="color: #007700">, </span><span style="color: #9876AA">0644</span><span style="color: #007700">, </span><span style="color: #9876AA">100</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span>  <p class="para">   This example opened a shared memory block with a system id returned by   <span class="function">{@link ftok()}</span>.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.shmop-open-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link shmop_close()} - Close shared memory block</span></li>    <li class="member"><span class="function">{@link shmop_delete()} - Delete shared memory block</span></li>   </ul>  </span> </div></div>