<div id="com.construct" class="refentry"> <div class="refnamediv">  <h1 class="refname">com::__construct</h1>  <p class="verinfo">(PHP 4 &gt; 4.1.0, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">com::__construct</span> &mdash; <span class="dc-title">com class constructor</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-com.construct-description">  <h3 class="title">说明</h3>  <div class="constructorsynopsis dc-description">   <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><strong>com::__construct</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$module_name</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766">string</span>|<span class="type" style="color:#EAB766">null</span></span> <span class="parameter" style="color:#3A95FF">$server_name</span><span class="initializer"> = <strong><span>null</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$codepage</span><span class="initializer"> = <strong><span>CP_ACP</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$typelib</span><span class="initializer"> = &quot;&quot;</span></span><br>)</div>  <p class="para rdfs-comment">   Constructs a new com object.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-com.construct-parameters">  <h3 class="title">参数</h3>  <dl>       <dt><span class="parameter" style="color:#3A95FF">module_name</span></dt>    <dd>     <span class="simpara">      Can be a ProgID, Class ID or Moniker that names the component to load.     </span>     <span class="simpara">      A ProgID is typically the application or DLL name, followed by a period,      followed by the object name. e.g: <span>Word.Application</span>.     </span>     <span class="simpara">      A Class ID is the UUID that uniquely identifies a given class.     </span>     <span class="simpara">      A Moniker is a special form of naming, similar in concept to a URL      scheme, that identifies a resource and specifies how it should be      loaded.  As an example, you could load up Word and get an object      representing a word document by specifying the full path to the word      document as the module name, or you can use <span>LDAP:</span> as      a moniker to use the ADSI interface to LDAP.     </span>    </dd>          <dt><span class="parameter" style="color:#3A95FF">server_name</span></dt>    <dd>     <span class="simpara">      The name of the DCOM server on which the component should be loaded and      run.  If <strong><span>null</span></strong>, the object is run using the default for the      application.  The default is typically to run it on the local machine,      although the administrator might have configured the application to      launch on a different machine.     </span>     <span class="simpara">      If a non-<strong><span>null</span></strong> value is specified for server, PHP will refuse to load      the object unless the <a href="https://www.php.net/manual/zh/com.configuration.php#ini.com.allow-dcom" class="link">com.allow_dcom</a> <var class="filename">php.ini</var> option      is set to <strong><span>true</span></strong>.     </span>     <span>      If <span class="parameter" style="color:#3A95FF">server_name</span> is an array, it should contain the      following elements (case sensitive!).  Note that they are all optional      (although you need to specify both Username and Password together); if      you omit the Server setting, the default server will be used (as      mentioned above), and the instantiation of the object will not be      affected by the <a href="https://www.php.net/manual/zh/com.configuration.php#ini.com.allow-dcom" class="link">com.allow_dcom</a>      <var class="filename">php.ini</var> directive.      <table class="doctable table">       <caption><strong>DCOM server name</strong></caption>               <thead>         <tr>          <th>key</th>          <th>type</th>          <th>description</th>         </tr>        </thead>        <tbody class="tbody">         <tr>          <td>Server</td>          <td>string</td>          <td>The name of the server.</td>         </tr>         <tr>          <td>Username</td>          <td>string</td>          <td>The username to connect as.</td>         </tr>         <tr>          <td>Password</td>          <td>string</td>          <td>The password for <span>Username</span>.</td>         </tr>         <tr>          <td>Domain</td>          <td>string</td>          <td>The domain of <span>server</span>.</td>         </tr>         <tr>          <td>Flags</td>          <td>integer</td>          <td>One or more of the following constants, logically OR&#039;d together:           <strong><span>CLSCTX_INPROC_SERVER</span></strong>,           <strong><span>CLSCTX_INPROC_HANDLER</span></strong>,           <strong><span>CLSCTX_LOCAL_SERVER</span></strong>,           <strong><span>CLSCTX_REMOTE_SERVER</span></strong>,           <strong><span>CLSCTX_SERVER</span></strong> and           <strong><span>CLSCTX_ALL</span></strong>.  The default value if not           specified here is <strong><span>CLSCTX_SERVER</span></strong> if you also           omit <span>Server</span>, or           <strong><span>CLSCTX_REMOTE_SERVER</span></strong> if you do specify a           server.  You should consult the Microsoft documentation for           CoCreateInstance for more information on the meaning of these           constants; you will typically never have to use them.          </td>         </tr>        </tbody>             </table>     </span>    </dd>          <dt><span class="parameter" style="color:#3A95FF">codepage</span></dt>    <dd>     <span class="simpara">      Specifies the codepage that is used to convert strings to      unicode-strings and vice versa.  The conversion is applied whenever a      PHP string is passed as a parameter or returned from a method of this      COM object.  The code page is sticky, which means that it will      propagate to objects and variants returned from the object.     </span>     <span class="simpara">      Possible values are      <strong><span>CP_ACP</span></strong> (use system default ANSI code page - the      default if this parameter is omitted),      <strong><span>CP_MACCP</span></strong>,      <strong><span>CP_OEMCP</span></strong>, <strong><span>CP_SYMBOL</span></strong>,      <strong><span>CP_THREAD_ACP</span></strong> (use codepage/locale set for the      current executing thread), <strong><span>CP_UTF7</span></strong>      and <strong><span>CP_UTF8</span></strong>.  You may also use the number for a      given codepage; consult the Microsoft documentation for more details on      codepages and their numeric values.     </span>    </dd>     </dl> </div></div>