<div id="phar.using.object" class="section"> <h2 class="title">Using Phar Archives: the Phar and PharData class</h2> <p class="para">  The <span class="classname"><a href="https://www.php.net/manual/zh/class.phar.php" class="classname">Phar</a></span> class supports reading and manipulation  of Phar archives, as well as iteration through inherited functionality of  the <span class="classname"><a href="https://www.php.net/manual/zh/class.recursivedirectoryiterator.php" class="classname">RecursiveDirectoryIterator</a></span>  class.  With support for the <span class="classname"><a href="https://www.php.net/manual/zh/class.arrayaccess.php" class="classname">ArrayAccess</a></span>  interface, files inside a Phar archive can be accessed as if they were  part of an associative array. </p> <p class="para">  The <span class="classname"><a href="https://www.php.net/manual/zh/class.phardata.php" class="classname">PharData</a></span> class extends the <span class="classname"><a href="https://www.php.net/manual/zh/class.phar.php" class="classname">Phar</a></span>, and  allows creating and modifying non-executable (data) tar and zip archives even if  <span>phar.readonly</span>=1 in php.ini.  As such,  <span class="function">{@link PharData::setAlias()}</span> and <span class="function">{@link PharData::setStub()}</span>  are both disabled as the concept of alias and stub are unique to executable phar  archives. </p> <p class="para">  It is important to note that when creating a Phar archive, the full path  should be passed to the <span class="classname"><a href="https://www.php.net/manual/zh/class.phar.php" class="classname">Phar</a></span> object constructor.  Relative paths will fail to initialize. </p> <p class="para">  Assuming that <span>$p</span> is a Phar object initialized as follows: </p> <p class="para">  <div class="informalexample">   <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$p </span><span style="color: #007700">= new </span><span style="color: #9876AA">Phar</span><span style="color: #007700">(</span><span style="color: #DD0000">'/path/to/myphar.phar'</span><span style="color: #007700">, </span><span style="color: #9876AA">0</span><span style="color: #007700">, </span><span style="color: #DD0000">'myphar.phar'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>   </div>  </div> </p> <p class="para">  An empty Phar archive will be created at <span>/path/to/myphar.phar</span>,  or if <span>/path/to/myphar.phar</span> already exists, it will be opened  again.  The literal <span>myphar.phar</span> demonstrates the concept of an alias  that can be used to reference <span>/path/to/myphar.phar</span> in URLs as in: </p> <p class="para">  <div class="informalexample">   <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// these two calls to file_get_contents() are equivalent if<br />// /path/to/myphar.phar has an explicit alias of "myphar.phar"<br />// in its manifest, or if the phar was initialized with the<br />// previous example's Phar object setup<br /></span><span style="color: #9876AA">$f </span><span style="color: #007700">= </span><span style="color: #9876AA">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'phar:///path/to/myphar.phar/whatever.txt'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$f </span><span style="color: #007700">= </span><span style="color: #9876AA">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'phar://myphar.phar/whatever.txt'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>   </div>  </div> </p> <p class="para">  With the newly created <span>$p</span> <span class="classname"><a href="https://www.php.net/manual/zh/class.phar.php" class="classname">Phar</a></span> object,  the following is possible:  <ul class="itemizedlist">   <li class="listitem">    <span class="simpara">     <span>$a = $p[&#039;file.php&#039;]</span> creates a <span class="classname"><a href="https://www.php.net/manual/zh/class.pharfileinfo.php" class="classname">PharFileInfo</a></span>     class that refers to the contents of <span>phar://myphar.phar/file.php</span>    </span>   </li>   <li class="listitem">    <span class="simpara">     <span>$p[&#039;file.php&#039;] = $v</span> creates a new file     (<span>phar://myphar.phar/file.php</span>), or overwrites     an existing file within <span>myphar.phar</span>.  <span>$v</span>     can be either a string or an open file pointer, in which case the entire     contents of the file will be used to create the new file.  Note that     <span>$p-&gt;addFromString(&#039;file.php&#039;, $v)</span> is functionally     equivalent to the above.  Also possible is to add the contents of a file     with <span>$p-&gt;addFile(&#039;/path/to/file.php&#039;, &#039;file.php&#039;)</span>.     Lastly, an empty directory can be created with     <span>$p-&gt;addEmptyDir(&#039;empty&#039;)</span>.    </span>   </li>   <li class="listitem">    <span class="simpara">     <span>isset($p[&#039;file.php&#039;])</span> can be used to determine     whether <span>phar://myphar.phar/file.php</span> exists within     <span>myphar.phar</span>.    </span>   </li>   <li class="listitem">    <span class="simpara">     <span>unset($p[&#039;file.php&#039;])</span> erases     <span>phar://myphar.phar/file.php</span> from     <span>myphar.phar</span>.    </span>   </li>  </ul> </p> <p class="para">  In addition, the <span class="classname"><a href="https://www.php.net/manual/zh/class.phar.php" class="classname">Phar</a></span> object is the only way to access  Phar-specific metadata, through  <span class="function">{@link Phar::getMetadata()}</span>,  and the only way to set or retrieve a Phar archive&#039;s PHP loader stub through  <span class="function">{@link Phar::getStub()}</span> and  <span class="function">{@link Phar::setStub()}</span>.  Additionally, compression for the entire Phar archive at once can only be manipulated  using the <span class="classname"><a href="https://www.php.net/manual/zh/class.phar.php" class="classname">Phar</a></span> class. </p> <p class="para">  The full list of <span class="classname"><a href="https://www.php.net/manual/zh/class.phar.php" class="classname">Phar</a></span> object functionality is documented  below. </p> <p class="para">  The <span class="classname"><a href="https://www.php.net/manual/zh/class.pharfileinfo.php" class="classname">PharFileInfo</a></span> class extends the  <span class="classname"><a href="https://www.php.net/manual/zh/class.splfileinfo.php" class="classname">SplFileInfo</a></span>  class, and adds several methods for manipulating Phar-specific details of a file  contained within a Phar, such as manipulating compression and metadata. </p></div>