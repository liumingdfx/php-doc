<div id="class.evtimer" class="reference"> <h1 class="title">The EvTimer class</h1>  <div class="partintro"><p class="verinfo">(PECL ev &gt;= 0.2.0)</p>  <div class="section" id="evtimer.intro">   <h2 class="title">简介</h2>   <p class="para">    <span class="classname"><strong class="classname">EvTimer</strong></span>    watchers are simple relative timers that generate an event after a given    time, and optionally repeating in regular intervals after that.   </p>   <p class="para">    The timers are based on real time, that is, if one registers an event that    times out after an hour and resets the system clock to    <em>January last year</em>    , it will still time out after(roughly) one hour. &quot;Roughly&quot; because    detecting time jumps is hard, and some inaccuracies are unavoidable.   </p>   <p class="para">    The callback is guaranteed to be invoked only after its timeout has passed    (not at, so on systems with very low-resolution clocks this might    introduce a small delay). If multiple timers become ready during the same    loop iteration then the ones with earlier time-out values are invoked    before ones of the same priority with later time-out values (but this is    no longer true when a callback calls    <span class="methodname" style="color:#CC7832">{@link EvLoop::run()}</span>    recursively).   </p>   <p class="para">    The timer itself will do a best-effort at avoiding drift, that is, if a    timer is configured to trigger every    <strong><span>10</span></strong>    seconds, then it will normally trigger at exactly    <strong><span>10</span></strong>    second intervals. If, however, the script cannot keep up with the timer    because it takes longer than those    <strong><span>10</span></strong>    seconds to do) the timer will not fire more than once per event loop    iteration.   </p>  </div>  <div class="section" id="evtimer.synopsis">   <h2 class="title">类摘要</h2>   <div class="classsynopsis">    <span class="ooclass">     <strong class="classname"></strong>    </span>    <div class="classsynopsisinfo">     <span class="ooclass">      <span class="modifier">class</span> <strong class="classname">EvTimer</strong>     </span>     <span class="ooclass">      <span class="modifier">extends</span>       <a href="https://www.php.net/manual/zh/class.evwatcher.php" class="classname">EvWatcher</a>     </span>     {</div>    <div class="classsynopsisinfo classsynopsisinfo_comment">// 属性 </div>    <div class="fieldsynopsis">     <span class="modifier">public</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.evtimer.php#evtimer.props.repeat">$<var class="varname">repeat</var></a></var>;</div>    <div class="fieldsynopsis"><span class="modifier">public</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.evtimer.php#evtimer.props.remaining">$<var class="varname">remaining</var></a></var>;</div>    <div class="classsynopsisinfo classsynopsisinfo_comment">// 继承的属性 </div>    <div class="fieldsynopsis"><span class="modifier">public</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.evwatcher.php#evwatcher.props.is-active">$<var class="varname">is_active</var></a></var>;</div><div class="fieldsynopsis"><span class="modifier">public</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.evwatcher.php#evwatcher.props.data">$<var class="varname">data</var></a></var>;</div><div class="fieldsynopsis"><span class="modifier">public</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.evwatcher.php#evwatcher.props.is-pending">$<var class="varname">is_pending</var></a></var>;</div><div class="fieldsynopsis"><span class="modifier">public</span>      <var class="varname"><a href="https://www.php.net/manual/zh/class.evwatcher.php#evwatcher.props.priority">$<var class="varname">priority</var></a></var>;</div>    <div class="classsynopsisinfo classsynopsisinfo_comment">// 方法 </div>    <div class="constructorsynopsis dc-description">   <span class="modifier">public</span>   <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/evtimer.construct.php" class="methodname" style="color:#CC7832">__construct</a></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766">float</span>     <span class="parameter" style="color:#3A95FF">$after</span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766">float</span>     <span class="parameter" style="color:#3A95FF">$repeat</span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.callable.php" class="type callable" style="color:#EAB766">callable</a></span>     <span class="parameter" style="color:#3A95FF">$callback</span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.declarations.php#language.types.declarations.mixed" class="type mixed" style="color:#EAB766">mixed</a></span>     <span class="parameter" style="color:#3A95FF">$data</span>    <span class="initializer"> = <strong><span>null</span></strong></span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766">int</span>     <span class="parameter" style="color:#3A95FF">$priority</span>    <span class="initializer"> = 0</span>   </span><br>)</div>    <div class="methodsynopsis dc-description"><span class="modifier">public</span>   <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/evtimer.again.php" class="methodname" style="color:#CC7832">again</a></span>(): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">final</span>   <span class="modifier">public</span>   <span class="modifier">static</span>   <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/evtimer.createstopped.php" class="methodname" style="color:#CC7832">createStopped</a></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766">float</span>     <span class="parameter" style="color:#3A95FF">$after</span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766">float</span>     <span class="parameter" style="color:#3A95FF">$repeat</span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.callable.php" class="type callable" style="color:#EAB766">callable</a></span>     <span class="parameter" style="color:#3A95FF">$callback</span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.declarations.php#language.types.declarations.mixed" class="type mixed" style="color:#EAB766">mixed</a></span>     <span class="parameter" style="color:#3A95FF">$data</span>    <span class="initializer"> = <strong><span>null</span></strong></span>   </span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam">    <span class="type" style="color:#EAB766">int</span>     <span class="parameter" style="color:#3A95FF">$priority</span>    <span class="initializer"> = 0</span>   </span><br>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.evtimer.php" class="type EvTimer" style="color:#EAB766">EvTimer</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span>   <span class="methodname" style="color:#CC7832"><a href="https://www.php.net/manual/zh/evtimer.set.php" class="methodname" style="color:#CC7832">set</a></span>(<span class="methodparam">    <span class="type" style="color:#EAB766">float</span>     <span class="parameter" style="color:#3A95FF">$after</span>   </span>, <span class="methodparam">    <span class="type" style="color:#EAB766">float</span>     <span class="parameter" style="color:#3A95FF">$repeat</span>   </span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div>    <div class="classsynopsisinfo classsynopsisinfo_comment">// 继承的方法 </div>    <div class="methodsynopsis dc-description"><span class="modifier">public</span>   <span class="methodname" style="color:#CC7832">{@link EvWatcher::clear}</span>(): <span class="type" style="color:#EAB766">int</span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span>   <span class="methodname" style="color:#CC7832">{@link EvWatcher::feed}</span>(<span class="methodparam">    <span class="type" style="color:#EAB766">int</span>     <span class="parameter" style="color:#3A95FF">$revents</span>   </span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span>   <span class="methodname" style="color:#CC7832">{@link EvWatcher::getLoop}</span>(): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.evloop.php" class="type EvLoop" style="color:#EAB766">EvLoop</a></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span>   <span class="methodname" style="color:#CC7832">{@link EvWatcher::invoke}</span>(<span class="methodparam">    <span class="type" style="color:#EAB766">int</span>     <span class="parameter" style="color:#3A95FF">$revents</span>   </span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span>   <span class="methodname" style="color:#CC7832">{@link EvWatcher::keepalive}</span>(<span class="methodparam">    <span class="type" style="color:#EAB766">bool</span>     <span class="parameter" style="color:#3A95FF">$value</span>   <span class="initializer"> = ?</span></span>): <span class="type" style="color:#EAB766">bool</span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span>   <span class="methodname" style="color:#CC7832">{@link EvWatcher::setCallback}</span>(<span class="methodparam">    <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/language.types.callable.php" class="type callable" style="color:#EAB766">callable</a></span>     <span class="parameter" style="color:#3A95FF">$callback</span>   </span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span>   <span class="methodname" style="color:#CC7832">{@link EvWatcher::start}</span>(): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div><div class="methodsynopsis dc-description"><span class="modifier">public</span>   <span class="methodname" style="color:#CC7832">{@link EvWatcher::stop}</span>(): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div>   }</div>  </div>  <div class="section" id="evtimer.props">   <h2 class="title">属性</h2>   <dl>         <dt id="evtimer.props.repeat">      <var class="varname">repeat</var>     </dt>     <dd>      <p class="para">       If repeat is       <strong><span>0.0</span></strong>       , then it will automatically be stopped once the timeout is reached. If       it is positive, then the timer will automatically be configured to       trigger again every repeat seconds later, until stopped manually.      </p>     </dd>             <dt id="evtimer.props.remaining">      <var class="varname">remaining</var>     </dt>     <dd>      <p class="para">       Returns the remaining time until a timer fires. If the timer is active,       then this time is relative to the current event loop time, otherwise       it&#039;s the timeout value currently configured.      </p>      <p class="para">       That is, after instanciating an       <span class="classname"><strong class="classname">EvTimer</strong></span>       with an       <span class="parameter" style="color:#3A95FF">after</span>       value of       <strong><span>5.0</span></strong>       and       <span class="parameter" style="color:#3A95FF">repeat</span>       value of       <strong><span>7.0</span></strong>       ,       <var class="varname">remaining</var>       returns       <strong><span>5.0</span></strong>       . When the timer is started and one second passes,       <var class="varname">remaining</var>       will return       <strong><span>4.0</span></strong>       . When the timer expires and is restarted, it will return roughly       <strong><span>7.0</span></strong>       (likely slightly less as callback invocation takes some time too), and       so on.      </p>     </dd>       </dl>  </div> </div> <h2>目录</h2><ul class="chunklist chunklist_reference"><li>{@link EvTimer::again} — Restarts the timer watcher</li><li>{@link EvTimer::__construct} — Constructs an EvTimer watcher object</li><li>{@link EvTimer::createStopped} — Creates EvTimer stopped watcher object</li><li>{@link EvTimer::set} — Configures the watcher</li></ul></div>