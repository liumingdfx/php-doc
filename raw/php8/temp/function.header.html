<div id="function.header" class="refentry"> <div class="refnamediv">  <h1 class="refname">header</h1>  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">header</span> &mdash; <span class="dc-title">发送原生 HTTP 头</span></p> </div>  <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.header-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>header</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$string</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">bool</span> <span class="parameter" style="color:#3A95FF">$replace</span><span class="initializer"> = true</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$response_code</span><span class="initializer"> = ?</span></span>): <span class="type" style="color:#EAB766"><span class="type void" style="color:#EAB766">void</span></span></div>  <p class="para rdfs-comment">   <span class="function"><strong style="color:#CC7832">header()</strong></span> 用于发送原生的 <abbr title="Hypertext Transfer Protocol">HTTP</abbr>   头。关于 <abbr title="Hypertext Transfer Protocol">HTTP</abbr> 头的更多信息请参考 <a href="http://www.faqs.org/rfcs/rfc2616" class="link external">&raquo;&nbsp;HTTP/1.1 specification</a>。  </p>  <p class="para">   请注意 <span class="function"><strong style="color:#CC7832">header()</strong></span> 必须在任何实际输出之前调用，不管是普通的 HTML 标签，还是文件或 PHP 输出的空行，空格。这是个常见的错误，在通过<span class="function">{@link include}</span>，<span class="function">{@link require}</span>，或者其访问其他文件里面的函数的时候，如果在<span class="function"><strong style="color:#CC7832">header()</strong></span>被调用之前，其中有空格或者空行。   同样的问题也存在于单独的 PHP/HTML 文件中。   <div class="informalexample">    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000">&lt;html&gt;<br /><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// This will give an error. Note the output<br /> * above, which is before the header() call <br /></span><span style="color: #9876AA">header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Location: http://www.example.com/'</span><span style="color: #007700">);<br />exit;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.header-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">string</span></dt>     <dd>      <p class="para">       头字符串。      </p>      <p class="para">       有两种特别的头。第一种以“<span>HTTP/</span>”开头的 (case is not       significant)，将会被用来计算出将要发送的HTTP状态码。        例如在 Apache 服务器上用 PHP 脚本来处理不存在文件的请求（使用 <span>ErrorDocument</span> 指令）， 就会希望脚本响应了正确的状态码。      </p>      <p class="para">       <div class="informalexample">        <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// 本示例演示了 "HTTP/" 的特殊例子，典型用法的最佳实践，包括：<br />// 1. header($_SERVER["SERVER_PROTOCOL"] . " 404 Not Found");<br />//    （覆盖 http 状态消息，兼容还在使用 HTTP/1.0 的客户端）<br />// 2. http_response_code(404); （使用默认消息）<br /></span><span style="color: #9876AA">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"HTTP/1.1 404 Not Found"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>        </div>       </div>      </p>      <p class="para">       第二种特殊情况是“Location:”的头信息。它不仅把报文发送给浏览器，而且还将返回给浏览器一个 <span>REDIRECT</span>（302）的状态码，除非状态码已经事先被设置为了<span>201</span>或者<span>3xx</span>。      </p>      <p class="para">       <div class="informalexample">        <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location: http://www.example.com/"</span><span style="color: #007700">); </span><span style="color: #FF8000">// Redirect browser <br /><br />// Make sure that code below does not get executed when we redirect. <br /></span><span style="color: #007700">exit;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>        </div>       </div>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">replace</span></dt>     <dd>      <p class="para">       可选参数 <span class="parameter" style="color:#3A95FF">replace</span> 表明是否用后面的头替换前面相同类型的头。              默认情况下会替换。如果传入 <strong><span>false</span></strong>，就可以强制使相同的头信息并存。例如：      </p>      <p class="para">       <div class="informalexample">        <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />header</span><span style="color: #007700">(</span><span style="color: #DD0000">'WWW-Authenticate: Negotiate'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">header</span><span style="color: #007700">(</span><span style="color: #DD0000">'WWW-Authenticate: NTLM'</span><span style="color: #007700">, </span><span style="color: #9876AA">false</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>        </div>       </div>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">response_code</span></dt>     <dd>      <p class="para">       强制指定 HTTP 响应的值。注意，这个参数只有在报文字符串（<span class="parameter" style="color:#3A95FF">header</span>）不为空的情况下才有效。      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.header-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   没有返回值。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 errors" id="refsect1-function.header-errors">  <h3 class="title">错误／异常</h3>  <p class="para">   当 header 发送失败时，<span class="function"><strong style="color:#CC7832">header()</strong></span> 会抛出 <strong><span>E_WARNING</span></strong> 级别的错误  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.header-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 下载对话框</strong></p>    <div class="example-contents"><p>     如果你想提醒用户去保存你发送的数据，例如保存一个生成的PDF文件。你可以使用<a href="http://www.faqs.org/rfcs/rfc2183" class="link external">&raquo;&nbsp;Content-Disposition</a>的报文信息来提供一个推荐的文件名，并且强制浏览器显示一个文件下载的对话框。    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// 输出 PDF 文件<br /></span><span style="color: #9876AA">header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-type: application/pdf'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// 名称为 downloaded.pdf<br /></span><span style="color: #9876AA">header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-Disposition: attachment; filename="downloaded.pdf"'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// 该 PDF 来源于 original.pdf<br /></span><span style="color: #9876AA">readfile</span><span style="color: #007700">(</span><span style="color: #DD0000">'original.pdf'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span>  <p class="para">   <div class="example" id="">    <p><strong>示例 #2 缓存指令</strong></p>    <div class="example-contents"><p>     PHP 脚本经常生成一些动态内容，它不该被客户端、服务器与浏览器之间的代理缓存。     许多代理与客户端都支持这样强制禁用缓存：    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Cache-Control: no-cache, must-revalidate"</span><span style="color: #007700">); </span><span style="color: #FF8000">// HTTP/1.1<br /></span><span style="color: #9876AA">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Expires: Sat, 26 Jul 1997 05:00:00 GMT"</span><span style="color: #007700">); </span><span style="color: #FF8000">// 过去的日期<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>     <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:       <p class="para">       也许你会遇到这样的情况，那就是即使你没使用上面这段代码，你的页面也没有被缓存。大多数情况是因为用户可以自己设置他们的浏览器从而改变浏览器默认的缓存行为。一旦发送了上面这段报文信息，那么你就应该重写那些可能用到缓存了的代码。      </p>      <p class="para">       此外，在启用session的情况下，<span class="function">{@link session_cache_limiter()}</span>和<span>session.cache_limiter</span>的配置可以用来自动地生成正确的缓存相关的头信息。      </p>     </p></blockquote>    </p></div>   </div>  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 notes" id="refsect1-function.header-notes">  <h3 class="title">注释</h3>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>: <p class="para"> 数据头只会在SAPI支持时得到处理和输出。</p></p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    你所有需要输出到浏览器的数据将会一直缓存在服务器端，直到你发送他们，这将造成比较大的资源开销。你可以是用输出缓冲来避开这个问题。你可以通过在脚本里使用<span class="function">{@link ob_start()}</span>和<span class="function">{@link ob_end_flush()}</span>或者直接在你的<var class="filename">php.ini</var>文件里设置<span>output_buffering</span>，也可以直接在服务器的配置文件里设置。   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    HTTP状态信息的报文永远都是最新被发送到客户端的，而不管<span class="function"><strong style="color:#CC7832">header()</strong></span>是否是在最先发送的。报文状态码可能会被重写，当调用<span class="function"><strong style="color:#CC7832">header()</strong></span>来设定新的状态码，除非HTTP报文已经被发送了。   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    绝大多数现代浏览器的 <a href="http://tools.ietf.org/html/rfc7231#section-7.1.2" class="link external">&raquo;&nbsp;Location:</a>    都支持相对 <abbr title="Uniform Resource Identifier">URI</abbr>，但也有一些旧浏览器需要绝对 URI：包含协议、主机名、绝对路径。    一般情况下，可以借助 <var class="varname"><a href="https://www.php.net/manual/zh/reserved.variables.server.php" class="classname">$_SERVER['HTTP_HOST']</a></var>、<var class="varname"><a href="https://www.php.net/manual/zh/reserved.variables.server.php" class="classname">$_SERVER['PHP_SELF']</a></var>、    <span class="function">{@link dirname()}</span> 将相对地址组合成绝对 URI：    <div class="informalexample">     <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// 根据当前请求所在的目录，重定向到不同的页面 <br /></span><span style="color: #9876AA">$host  </span><span style="color: #007700">= </span><span style="color: #9876AA">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_HOST'</span><span style="color: #007700">];<br /></span><span style="color: #9876AA">$uri   </span><span style="color: #007700">= </span><span style="color: #9876AA">rtrim</span><span style="color: #007700">(</span><span style="color: #9876AA">dirname</span><span style="color: #007700">(</span><span style="color: #9876AA">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'PHP_SELF'</span><span style="color: #007700">]), </span><span style="color: #DD0000">'/\\'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$extra </span><span style="color: #007700">= </span><span style="color: #DD0000">'mypage.php'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Location: http://</span><span style="color: #9876AA">$host$uri</span><span style="color: #DD0000">/</span><span style="color: #9876AA">$extra</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br />exit;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>     </div>    </div>   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    在执行Location header跳转的时候，Session ID无法通传递的，即使<a href="https://www.php.net/manual/zh/session.configuration.php#ini.session.use-trans-sid" class="link">session.use_trans_sid</a>是激活状态的。只能通过手动传递using <strong><span>SID</span></strong>的值来实现。   </p>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.header-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link headers_sent()} - 检测消息头是否已经发送</span></li>    <li class="member"><span class="function">{@link setcookie()} - 发送 Cookie</span></li>    <li class="member"><span class="function">{@link http_response_code()} - 获取/设置响应的 HTTP 状态码</span></li>    <li class="member"><span class="function">{@link header_remove()} - 删除之前设置的 HTTP 头</span></li>    <li class="member"><span class="function">{@link headers_list()} - 返回已发送的 HTTP 响应头（或准备发送的）</span></li>    <li class="member">     The section on <a href="https://www.php.net/manual/zh/features.http-auth.php" class="link">HTTP     authentication</a>    </li>   </ul>  </span> </div></div>