<div id="function.msg-send" class="refentry"> <div class="refnamediv">  <h1 class="refname">msg_send</h1>  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">msg_send</span> &mdash; <span class="dc-title">Send a message to a message queue</span></p> </div>  <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.msg-send-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>msg_send</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.sysvmessagequeue.php" class="type SysvMessageQueue" style="color:#EAB766">SysvMessageQueue</a></span> <span class="parameter" style="color:#3A95FF">$queue</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$message_type</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">string</span>|<span class="type" style="color:#EAB766">int</span>|<span class="type" style="color:#EAB766">float</span>|<span class="type" style="color:#EAB766">bool</span></span> <span class="parameter" style="color:#3A95FF">$message</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">bool</span> <span class="parameter" style="color:#3A95FF">$serialize</span><span class="initializer"> = <strong><span>true</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">bool</span> <span class="parameter" style="color:#3A95FF">$blocking</span><span class="initializer"> = <strong><span>true</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">&$error_code</span><span class="initializer"> = <strong><span>null</span></strong></span></span><br>): <span class="type" style="color:#EAB766">bool</span></div>  <p class="para rdfs-comment">   <span class="function"><strong style="color:#CC7832">msg_send()</strong></span> sends a <span class="parameter" style="color:#3A95FF">message</span> of type   <span class="parameter" style="color:#3A95FF">message_type</span> (which MUST be greater than 0) to   the message queue specified by <span class="parameter" style="color:#3A95FF">queue</span>.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.msg-send-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">queue</span></dt>     <dd>      <p class="para">       The message queue.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">message_type</span></dt>     <dd>      <p class="para">       The type of the message (MUST be greater than 0)      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">message</span></dt>     <dd>      <p class="para">       The body of the message.      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:        <p class="para">        If <span class="parameter" style="color:#3A95FF">serialize</span> set to <strong><span>false</span></strong> is supplied,        MUST be of type: <span class="type" style="color:#EAB766">string</span>, <span class="type" style="color:#EAB766">int</span>, <span class="type" style="color:#EAB766">float</span>         or <span class="type" style="color:#EAB766">bool</span>. In other case a warning will be issued.       </p>      </p></blockquote>     </dd>             <dt><span class="parameter" style="color:#3A95FF">serialize</span></dt>     <dd>      <p class="para">       The optional <span class="parameter" style="color:#3A95FF">serialize</span> controls how the       <span class="parameter" style="color:#3A95FF">message</span> is sent.  <span class="parameter" style="color:#3A95FF">serialize</span>       defaults to <strong><span>true</span></strong> which means that the <span class="parameter" style="color:#3A95FF">message</span> is       serialized using the same mechanism as the session module before being       sent to the queue.  This allows complex arrays and objects to be sent to       other PHP scripts, or if you are using the WDDX serializer, to any WDDX       compatible client.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">blocking</span></dt>     <dd>      <p class="para">       If the message is too large to fit in the queue, your script will wait       until another process reads messages from the queue and frees enough       space for your message to be sent.       This is called blocking; you can prevent blocking by setting the       optional <span class="parameter" style="color:#3A95FF">blocking</span> parameter to <strong><span>false</span></strong>, in which       case <span class="function"><strong style="color:#CC7832">msg_send()</strong></span> will immediately return <strong><span>false</span></strong> if the       message is too big for the queue, and set the optional       <span class="parameter" style="color:#3A95FF">error_code</span> to <strong><span>MSG_EAGAIN</span></strong>,       indicating that you should try to send your message again a little       later on.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">error_code</span></dt>     <dd>      <p class="para">       If the function fails, the optional errorcode will be set to the value of the system errno variable.      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.msg-send-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   成功时返回 <strong><span>true</span></strong>， 或者在失败时返回 <strong><span>false</span></strong>。  </p>  <p class="para">   Upon successful completion the message queue data structure is updated as   follows: <span class="parameter" style="color:#3A95FF">msg_lspid</span> is set to the process-ID of the   calling process, <span class="parameter" style="color:#3A95FF">msg_qnum</span> is incremented by 1 and   <span class="parameter" style="color:#3A95FF">msg_stime</span> is set to the current time.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.msg-send-changelog">  <h3 class="title">更新日志</h3>  <span>   <table class="doctable informaltable">         <thead>      <tr>       <th>版本</th>       <th>说明</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td>8.0.0</td>       <td>        <span class="parameter" style="color:#3A95FF">queue</span> expects a <span class="classname"><a href="https://www.php.net/manual/zh/class.sysvmessagequeue.php" class="classname">SysvMessageQueue</a></span>        instance now; previously, a <span class="type" style="color:#EAB766">resource</span> was expected.       </td>      </tr>     </tbody>       </table>  </span> </div>  <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.msg-send-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link msg_remove_queue()} - Destroy a message queue</span></li>    <li class="member"><span class="function">{@link msg_receive()} - Receive a message from a message queue</span></li>    <li class="member"><span class="function">{@link msg_stat_queue()} - Returns information from the message queue data structure</span></li>    <li class="member"><span class="function">{@link msg_set_queue()} - Set information in the message queue data structure</span></li>   </ul>  </span> </div>  </div>