<div id="memcache.getextendedstats" class="refentry"> <div class="refnamediv">  <h1 class="refname">Memcache::getExtendedStats</h1>  <p class="verinfo">(PECL memcache &gt;= 2.0.0)</p><p class="refpurpose"><span class="refname">Memcache::getExtendedStats</span> &mdash; <span class="dc-title">缓存服务器池中所有服务器统计信息</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-memcache.getextendedstats-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>Memcache::getExtendedStats</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$type</span><span class="initializer"> = ?</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$slabid</span><span class="initializer"> = ?</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$limit</span><span class="initializer"> = 100</span></span>): <span class="type" style="color:#EAB766">array</span></div>  <p class="para rdfs-comment">   <span class="function"><strong style="color:#CC7832">Memcache::getExtendedStats()</strong></span> 返回一个二维关联数据的服务器统计信息。数组的key由host:port方式   组成，无效的服务器返回的统计信息被设置为false，同样的，你可以使用函数 <span class="function"><strong style="color:#CC7832">memcache_get_extended_stats()</strong></span>。  </p>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    这个函数在 Memcache 2.0.0 版本加入。   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    (译注)获取 Memcache 内所有数据方法：首先使用 getExtendedStats(&#039;slabs&#039;) 获取到每个服务器上活动 slabs 分块的 id， 然后    使用 getExtendedStats(&#039;cachedump&#039;, $slabid, $limit) 来获取每个 slab 里面缓存的项，其中 $slabid 是 slab 分块 id， $limit 指    期望获取其中的多少条记录。   </p>  </p></blockquote>  </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-memcache.getextendedstats-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">type</span></dt>     <dd>      <p class="para">      期望抓取的统计信息类型，可以使用的值有 {reset, malloc, maps, cachedump, slabs, items, sizes}。      通过 memcached 协议指定这些附加参数是为了方便 memcache 开发者（检查其中的变动）。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">slabid</span></dt>     <dd>      <p class="para">      用于与参数 <span class="parameter" style="color:#3A95FF">type</span> 联合从指定 slab 分块拷贝数据，cachedump 命令会完全占用服务器通常用于      比较严格的调试。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">limit</span></dt>     <dd>      <p class="para">      用于和参数<span class="parameter" style="color:#3A95FF">type</span>联合来设置 cachedump 时从服务端获取的实体条数。      </p>     </dd>       </dl>   <div class="warning"><strong class="warning">警告</strong>    <p class="simpara">     出于安全原因，cachedump stat 类型已经从 memcached 守护程序中移除。    </p>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-memcache.getextendedstats-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">  返回一个二维关联数组的服务器统计信息或者在失败时返回 <strong><span>false</span></strong>。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-memcache.getextendedstats-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 <span class="function"><strong style="color:#CC7832">Memcache::getExtendedStats()</strong></span> 示例</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />    $memcache_obj </span><span style="color: #007700">= new </span><span style="color: #9876AA">Memcache</span><span style="color: #007700">;<br />    </span><span style="color: #9876AA">$memcache_obj</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">addServer</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">, </span><span style="color: #9876AA">11211</span><span style="color: #007700">);<br />    </span><span style="color: #9876AA">$memcache_obj</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">addServer</span><span style="color: #007700">(</span><span style="color: #DD0000">'failed_host'</span><span style="color: #007700">, </span><span style="color: #9876AA">11211</span><span style="color: #007700">);<br />    <br />    </span><span style="color: #9876AA">$stats </span><span style="color: #007700">= </span><span style="color: #9876AA">$memcache_obj</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">getExtendedStats</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$stats</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例会输出：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>Array<br>(<br>    [memcache_host:11211] =&gt; Array<br>        (<br>            [pid] =&gt; 3756<br>            [uptime] =&gt; 603011<br>            [time] =&gt; 1133810435<br>            [version] =&gt; 1.1.12<br>            [rusage_user] =&gt; 0.451931<br>            [rusage_system] =&gt; 0.634903<br>            [curr_items] =&gt; 2483<br>            [total_items] =&gt; 3079<br>            [bytes] =&gt; 2718136<br>            [curr_connections] =&gt; 2<br>            [total_connections] =&gt; 807<br>            [connection_structures] =&gt; 13<br>            [cmd_get] =&gt; 9748<br>            [cmd_set] =&gt; 3096<br>            [get_hits] =&gt; 5976<br>            [get_misses] =&gt; 3772<br>            [bytes_read] =&gt; 3448968<br>            [bytes_written] =&gt; 2318883<br>            [limit_maxbytes] =&gt; 33554432<br>        )<br><br>    [failed_host:11211] =&gt; false<br>)<br></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-memcache.getextendedstats-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link Memcache::getVersion()} - 返回服务器版本信息</span></li>    <li class="member"><span class="function">{@link Memcache::getStats()} - 获取服务器统计信息</span></li>   </ul>  </span> </div></div>