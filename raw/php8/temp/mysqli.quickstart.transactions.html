<div id="mysqli.quickstart.transactions" class="section">  <h2 class="title">API support for transactions</h2>  <p class="para">   The MySQL server supports transactions depending on the storage engine used.   Since MySQL 5.5, the default storage engine is InnoDB.   InnoDB has full ACID transaction support.  </p>  <p class="para">   Transactions can either be controlled using SQL or API calls.   It is recommended to use API calls for enabling and disabling the   <span>autocommit</span> mode and for committing and rolling back transactions.  </p>  <p class="para">   <div class="example" id="example-4331">    <p><strong>示例 #1 Setting <span>autocommit</span> mode with SQL and through the API</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />mysqli_report</span><span style="color: #007700">(</span><span style="color: #9876AA">MYSQLI_REPORT_ERROR </span><span style="color: #007700">| </span><span style="color: #9876AA">MYSQLI_REPORT_STRICT</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$mysqli </span><span style="color: #007700">= new </span><span style="color: #9876AA">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">, </span><span style="color: #DD0000">"user"</span><span style="color: #007700">, </span><span style="color: #DD0000">"password"</span><span style="color: #007700">, </span><span style="color: #DD0000">"database"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Recommended: using API to control transactional settings <br /></span><span style="color: #9876AA">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">autocommit</span><span style="color: #007700">(</span><span style="color: #9876AA">false</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Won't be monitored and recognized by the replication and the load balancing plugin <br /></span><span style="color: #9876AA">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">query</span><span style="color: #007700">(</span><span style="color: #DD0000">'SET AUTOCOMMIT = 0'</span><span style="color: #007700">);</span></span></span></div>    </div>   </div>  </p>  <p class="para">   Optional feature packages, such as the replication and load balancing plugin,   can easily monitor API calls. The replication plugin offers transaction   aware load balancing, if transactions are controlled with API calls.   Transaction aware load balancing is not available if SQL statements are   used for setting <span>autocommit</span> mode, committing or rolling back a transaction.  </p>  <p class="para">   <div class="example" id="example-4334">    <p><strong>示例 #2 Commit and rollback</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />mysqli_report</span><span style="color: #007700">(</span><span style="color: #9876AA">MYSQLI_REPORT_ERROR </span><span style="color: #007700">| </span><span style="color: #9876AA">MYSQLI_REPORT_STRICT</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$mysqli </span><span style="color: #007700">= new </span><span style="color: #9876AA">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">, </span><span style="color: #DD0000">"user"</span><span style="color: #007700">, </span><span style="color: #DD0000">"password"</span><span style="color: #007700">, </span><span style="color: #DD0000">"database"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">autocommit</span><span style="color: #007700">(</span><span style="color: #9876AA">false</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"INSERT INTO test(id) VALUES (1)"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">rollback</span><span style="color: #007700">();<br /><br /></span><span style="color: #9876AA">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"INSERT INTO test(id) VALUES (2)"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">commit</span><span style="color: #007700">();</span></span></span></div>    </div>   </div>  </p>  <p class="para">   Please note, that the MySQL server cannot roll back all statements.   Some statements cause an implicit commit.  </p>  <p class="para">   <strong>See also</strong>  </p>  <p class="para">   <ul class="simplelist">    <li class="member"><span class="methodname" style="color:#CC7832">{@link mysqli::autocommit()}</span></li>    <li class="member"><span class="methodname" style="color:#CC7832">{@link mysqli::begin_transaction()}</span></li>    <li class="member"><span class="methodname" style="color:#CC7832">{@link mysqli::commit()}</span></li>    <li class="member"><span class="methodname" style="color:#CC7832">{@link mysqli::rollback()}</span></li>   </ul>  </p> </div>