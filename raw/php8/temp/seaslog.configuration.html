<div id="seaslog.configuration" class="section"> <h2 class="title">运行时配置</h2> <p class="simpara">这些函数的行为受 <var class="filename">php.ini</var> 中的设置影响。</p> <p class="para">  <table class="doctable table">   <caption><strong>Seaslog 配置选项</strong></caption>       <thead>     <tr>      <th>名字</th>      <th>默认</th>      <th>可修改范围</th>      <th>更新日志</th>     </tr>    </thead>    <tbody class="tbody">     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.appender" class="link">seaslog.appender</a></td>      <td>1</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.appender-retry" class="link">seaslog.appender_retry</a></td>      <td>0</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.level" class="link">seaslog.level</a></td>      <td>8</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.remote-host" class="link">seaslog.remote_host</a></td>      <td>127.0.0.1</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.remote-port" class="link">seaslog.remote_port</a></td>      <td>514</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.remote-timeout" class="link">seaslog.remote_timeout</a></td>      <td>1</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>             <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.default-basepath" class="link">seaslog.default_basepath</a></td>      <td>/var/log/www</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.default-logger" class="link">seaslog.default_logger</a></td>      <td>default</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.default-template" class="link">seaslog.default_template</a></td>      <td>%T | %L | %P | %Q | %t | %M</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.default-datetime-format" class="link">seaslog.default_datetime_format</a></td>      <td>Y-m-d H:i:s</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.trace-error" class="link">seaslog.trace_error</a></td>      <td>1</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.trace-exception" class="link">seaslog.trace_exception</a></td>      <td>0</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.trace-notice" class="link">seaslog.trace_notice</a></td>      <td>0</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.trace-warning" class="link">seaslog.trace_warning</a></td>      <td>0</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.use-buffer" class="link">seaslog.use_buffer</a></td>      <td>0</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.buffer-size" class="link">seaslog.buffer_size</a></td>      <td>0</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.buffer-disabled-in-cli" class="link">seaslog.buffer_disabled_in_cli</a></td>      <td>0</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.disting-type" class="link">seaslog.disting_type</a></td>      <td>0</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.disting-folder" class="link">seaslog.disting_folder</a></td>      <td>1</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.disting-by-hour" class="link">seaslog.disting_by_hour</a></td>      <td>0</td>      <td>PHP_INI_SYSTEM</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.recall-depth" class="link">seaslog.recall_depth</a></td>      <td>0</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.trim-wrap" class="link">seaslog.trim_wrap</a></td>      <td>0</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.ignore-warning" class="link">seaslog.ignore_warning</a></td>      <td>1</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>     <tr>      <td><a href="https://www.php.net/manual/zh/seaslog.configuration.php#ini.seaslog.throw-exception" class="link">seaslog.throw_exception</a></td>      <td>1</td>      <td>PHP_INI_ALL</td>      <td></td>     </tr>    </tbody>     </table> </p> <p class="para">这是配置指令的简短说明。</p> <p class="para">  <dl>        <dt id="ini.seaslog.appender">      <span class="parameter" style="color:#3A95FF">seaslog.appender</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       日志存储介质的切换选型。1File 2TCP 3UDP (默认为1)      </p>      <p class="para">       当 <em>seaslog.appender</em> 被切换至 <span>2 (TCP)</span> 或 <span>3 (UDP)</span> 时，        SeasLog 会将日志发送至 tcp://remote_host:remote_port 或者 udp://remote_host:remote_port 服务器。      </p>      <p class="para">        当 <em>SeasLog</em> 将日志发往 TCP/UDP 时，格式遵守 RFC5424 规范。        此时 <span>{logInfo}</span> 受配置项中 <em>seaslog.default_template</em> 的影响。      </p>      <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;">    <div class="cdata"><span>The log style finally formatted such as:<br>&lt;15&gt;1 2017-08-27T01:24:59+08:00 vagrant-ubuntu-trusty test/logger[27171]: 2016-06-25 00:59:43 | DEBUG | 21423 | 599157af4e937 | 1466787583.322 | this is a neeke debug<br>&lt;14&gt;1 2017-08-27T01:24:59+08:00 vagrant-ubuntu-trusty test/logger[27171]: 2016-06-25 00:59:43 | INFO | 21423 | 599157af4e937 | 1466787583.323 | this is a info log<br>&lt;13&gt;1 2017-08-27T01:24:59+08:00 vagrant-ubuntu-trusty test/logger[27171]: 2016-06-25 00:59:43 | NOTICE | 21423 | 599157af4e937 | 1466787583.324 | this is a notice log<br>    </span></div>      </div>     </dd>             <dt id="ini.seaslog.appender-retry">      <span class="parameter" style="color:#3A95FF">seaslog.appender_retry</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       记录日志时的重试次数。       默认为 0 (不重试)      </p>     </dd>             <dt id="ini.seaslog.buffer-disabled-in-cli">      <span class="parameter" style="color:#3A95FF">seaslog.buffer_disabled_in_cli</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       在 CLI 模式下是否关闭 Buffer 的选项。 1-Y 0-N(默认值)      </p>      <p class="para">       在配置中留有 buffer_disabled_in_cli 的开关项。        默认情况下，这个选项是关闭的。        如果将 buffer_disabled_in_cli 设为开启，并且运行在 CLI 时，        配置中的 seaslog.use_buffer 设置将是被忽略的，此时 Seaslog 将立即把日志信息写往存储介质。      </p>     </dd>             <dt id="ini.seaslog.buffer-size">      <span class="parameter" style="color:#3A95FF">seaslog.buffer_size</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       可以通过该配置项将内存中 Buffer 的条数修改为 100 条。        配置项中 buffer_size 默认值为 0， 这意味着将不使用 Buffer。        如果 buffer_size &gt; 0，SeasLog 将预先将日志写入内存 Buffer，并在 Buffer 的条数大于或等于该值时，写往存储介质，然后刷新内存中的 Buffer。      </p>     </dd>             <dt id="ini.seaslog.default-basepath">      <span class="parameter" style="color:#3A95FF">seaslog.default_basepath</span>      <span class="type" style="color:#EAB766">string</span>     </dt>     <dd>      <p class="para">       日志存储的默认根路径。默认值为 &quot;/var/log/www&quot;。      </p>     </dd>             <dt id="ini.seaslog.default-datetime-format">      <span class="parameter" style="color:#3A95FF">seaslog.default_datetime_format</span>      <span class="type" style="color:#EAB766">string</span>     </dt>     <dd>      <p class="para">       时间的格式。默认值为 &quot;Y-m-d H:i:s&quot;。      </p>     </dd>             <dt id="ini.seaslog.default-logger">      <span class="parameter" style="color:#3A95FF">seaslog.default_logger</span>      <span class="type" style="color:#EAB766">string</span>     </dt>     <dd>      <p class="para">       日志记录的默认 Logger。默认值为 &quot;default&quot;。      </p>     </dd>             <dt id="ini.seaslog.disting-by-hour">      <span class="parameter" style="color:#3A95FF">seaslog.disting_by_hour</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       是否按每小时一个记录进行区分。1-Y 0-N(默认值)      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:         <p class="para">         当 <em>seaslog.disting_by_hour = 1</em> 时，会将日志区分小时记录。         这意味着，SeasLog 将每隔一个小时创建一个文件。        </p>      </p></blockquote>     </dd>             <dt id="ini.seaslog.disting-folder">      <span class="parameter" style="color:#3A95FF">seaslog.disting_folder</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       是否按目录进行区分。1-Y(默认值) 0-N      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:         <p class="para">         当 <em>seaslog.disting_folder = 1</em> 时，按目录区分地使用 Logger。         这意味着，SeasLog 将为每一个 Logger 创建一个单独的目录进行区分，比如 default/20180211.log，         而当该选项关闭时，SeasLog 将使用下划线连接 Logger 与时间，比如 default_20180211.log。        </p>      </p></blockquote>     </dd>             <dt id="ini.seaslog.disting-type">      <span class="parameter" style="color:#3A95FF">seaslog.disting_type</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       是否按日志级别进行区分。1-Y 0-N(默认值)      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:         <p class="para">         当 <em>seaslog.disting_type = 1</em> 时，按日志级别使用 Logger。         这意味着，SeasLog 将在创建日志文件时，使用 info/warn/error 或其他级别进行区分。        </p>      </p></blockquote>     </dd>             <dt id="ini.seaslog.ignore-warning">      <span class="parameter" style="color:#3A95FF">seaslog.ignore_warning</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       是否忽略 SeasLog 警告。1-On(默认值) 0-Off      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:         <p class="para">         当 <em>seaslog.ignore_warning = 1</em> 时，忽略 SeasLog 自身的警告，         此时日志目录权限不足、或从远端 Server 端口不能正常响应等导致的警告，将被忽略；         而当关闭该选项时，警告将会出现。        </p>      </p></blockquote>     </dd>             <dt id="ini.seaslog.level">      <span class="parameter" style="color:#3A95FF">seaslog.level</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       允许日志被记录的级别。默认为 8 (全部日志)。       0-EMERGENCY 1-ALERT 2-CRITICAL 3-ERROR 4-WARNING 5-NOTICE 6-INFO 7-DEBUG 8-ALL      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:         <p class="para">          提示: 该配置项从 1.7.0 版本开始有所改变。          在 1.7.0 之前的版本中，越小的值将代表越多的级别日志被记录下来：           0-all 1-debug 2-info 3-notice 4-warning 5-error 6-critical 7-alert 8-emergency          在 1.7.0 之前的版本中，默认值是 0 (全部日志)。        </p>      </p></blockquote>     </dd>             <dt id="ini.seaslog.recall-depth">      <span class="parameter" style="color:#3A95FF">seaslog.recall_depth</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       日志函数所在的层级。这将影响变量 <span>%F</span> 中的 <span>LineNo</span>。       默认值为 0。      </p>     </dd>             <dt id="ini.seaslog.remote-host">      <span class="parameter" style="color:#3A95FF">seaslog.remote_host</span>      <span class="type" style="color:#EAB766">string</span>     </dt>     <dd>      <p class="para">       如果要使用 TCP 或者 UDP 为存储介质，需要配置远端的 IP。默认值为 &quot;127.0.0.1&quot;      </p>     </dd>             <dt id="ini.seaslog.remote-port">      <span class="parameter" style="color:#3A95FF">seaslog.remote_port</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       如果要使用 TCP 或者 UDP 为存储介质，需要配置远端服务的端口号。默认值为 514      </p>     </dd>             <dt id="ini.seaslog.remote-timeout">      <span class="parameter" style="color:#3A95FF">seaslog.remote_timeout</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       如果要使用 TCP 或者 UDP 为存储介质，需要配置超时时间。默认值为 1 秒。      </p>     </dd>             <dt id="ini.seaslog.throw-exception">      <span class="parameter" style="color:#3A95FF">seaslog.throw_exception</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       是否接受 SeasLog 抛出异常。1-On(默认值) 0-Off      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:         <p class="para">         当<em>seaslog.throw_exception = 1</em>时，接受 SeasLog 抛出自身的异常，         此时由于日志目录权限问题、或者从远端 Server 端口不能正常响应而导致的中断，         将抛出一个异常；而当关闭该选项时，将不抛出异常。        </p>      </p></blockquote>     </dd>             <dt id="ini.seaslog.trace-error">      <span class="parameter" style="color:#3A95FF">seaslog.trace_error</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       自动将 PHP 的 Final Error 记录在默认 Logger中。1-Y(默认值) 0-N      </p>     </dd>             <dt id="ini.seaslog.trace-exception">      <span class="parameter" style="color:#3A95FF">seaslog.trace_exception</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       自动将 PHP 的异常记录在默认 Logger中。1-Y 0-N(默认值)      </p>     </dd>             <dt id="ini.seaslog.trace-notice">      <span class="parameter" style="color:#3A95FF">seaslog.trace_notice</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       自动将 PHP 的 Notice 记录在默认 Logger中。1-Y 0-N(默认值)      </p>     </dd>             <dt id="ini.seaslog.trace-warning">      <span class="parameter" style="color:#3A95FF">seaslog.trace_warning</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       自动将 PHP 的 Warning 记录在默认 Logger中。1-Y 0-N(默认值)      </p>     </dd>             <dt id="ini.seaslog.trim-wrap">      <span class="parameter" style="color:#3A95FF">seaslog.trim_wrap</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       自动地 Trim 掉日志信息中的 \n 和 \r。1-On 0-Off(默认值)      </p>     </dd>             <dt id="ini.seaslog.use-buffer">      <span class="parameter" style="color:#3A95FF">seaslog.use_buffer</span>      <span class="type" style="color:#EAB766">int</span>     </dt>     <dd>      <p class="para">       开启使用内存中的日志 Buffer。1-Y 0-N(默认值)      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:         <p class="para">         当<em>seaslog.use_buffer = 1</em>时，开启使用内存 Buffer。         默认情况下，内存 Buffer 是关闭的。         如果 Buffer 是开启状态，SeasLog 会将日志预先记录在内存中，         并且在请求结束时、或 PHP 进程结束时（PHP RSHUTGOWN 或 PHP MSHUTDOWN）时写往存储介质。        </p>      </p></blockquote>     </dd>             <dt id="ini.seaslog.default-template">      <span class="parameter" style="color:#3A95FF">seaslog.default_template</span>      <span class="type" style="color:#EAB766">string</span>     </dt>     <dd>      <p class="para">       默认日志模板。        默认值是 &quot;%T | %L | %P | %Q | %t | %M&quot;.      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:         <p class="para">         提供了一系列的默认变量，可以在日志模板中使用，并在最终日志生成时，这些变量的占位符会被替换成对应的值。        </p>        <p class="para">         默认的日志模板是：<span>seaslog.default_template = &quot;%T | %L | %P | %Q | %t | %M&quot;</span>，         这意味着，默认的日志格式会是：<span>{dateTime} | {level} | {pid} | {uniqid} | {timeStamp} | {logInfo}</span>        </p>        <p class="para">         如果修改了日志模板，比如：<span>seaslog.default_template = &quot;[%T]:%L %P %Q %t %M&quot;</span>，         这意味着，日志的格式将会成改变为：<span>[{dateTime}]:{level} {pid} {uniqid} {timeStamp} {logInfo}</span>        </p>        <table class="doctable table">          <caption><strong>Seaslog 内置变量表</strong></caption>                      <thead>              <tr>                <th>变量名</th>                <th>描述</th>              </tr>            </thead>            <tbody class="tbody">              <tr>                <td>%L</td>                <td>日志级别。</td>              </tr>              <tr>                <td>%M</td>                <td>日志信息。</td>              </tr>              <tr>                <td>%T</td>                <td>时间。 比如：<span>2017-08-16 19:15:02</span>，受配置项 <span>seaslog.default_datetime_format</span> 的影响。</td>              </tr>              <tr>                <td>%t</td>                <td>时间戳。比如：<span>1502882102.862</span>，精确到毫秒。</td>              </tr>              <tr>                <td>%Q</td>                <td>                 请求ID。用于区分每一个请求，                  如果没有调用 <span>SeasLog::setRequestId($string)</span> 函数，                 将在请求初始化的时候，使用 PHP 内置函数 <span>static char *get_uniqid ()</span> 来生成 Unique ID。               </td>              </tr>              <tr>                <td>%H</td>                <td>主机名。</td>              </tr>              <tr>                <td>%P</td>                <td>进程ID。</td>              </tr>              <tr>                <td>%D</td>                <td>域名:端口号。比如：<span>www.cloudwise.com:80</span>；在 CLI 下运行时，该值为 <span>cli</span>。</td>              </tr>              <tr>                <td>%R</td>                <td>                 请求 URI。比如：<span>/app/user/signin</span>。                 在 CLI 下运行时，值为 Index Script 名称，比如：<span>CliIndex.php</span>。               </td>              </tr>              <tr>                <td>%m</td>                <td>                 请求 Method。比如：<span>Get</span>。                 在 CLI 下运行时，值为 Command Script，比如：<span>/bin/bash</span>。               </td>              </tr>              <tr>                <td>%I</td>                <td>                 客户端IP；在 CLI 下运行时，值为 <span>local</span>。                 取值优先级为：HTTP_X_REAL_IP &gt; HTTP_X_FORWARDED_FOR &gt; REMOTE_ADDR               </td>              </tr>              <tr>                <td>%F</td>                <td>                 文件名:行号。比如：<span>UserService.php:118</span>。                </td>              </tr>              <tr>                <td>%U</td>                <td>                 内存使用量。单位为 byte。                 调用 PHP 内置方法 <span>zend_memory_usage</span> 得到该值。                </td>              </tr>              <tr>                <td>%u</td>                <td>                 最大内存使用峰值。单位为 byte。                 调用 PHP 内置方法 <span>zend_memory_peak_usage</span> 得到该值。                </td>              </tr>              <tr>                <td>%C</td>                <td>                 <span>TODO</span> Class::Action。比如 <span>UserService::getUserInfo</span>                </td>              </tr>            </tbody>                    </table>      </p></blockquote>     </dd>      </dl> </p></div>