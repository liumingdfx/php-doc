<div id="function.dba-open" class="refentry"> <div class="refnamediv">  <h1 class="refname">dba_open</h1>  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">dba_open</span> &mdash; <span class="dc-title">Open database</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.dba-open-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>dba_open</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$path</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$mode</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">string</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$handler</span><span class="initializer"> = <strong><span>null</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$permission</span><span class="initializer"> = 0644</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$map_size</span><span class="initializer"> = 0</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">int</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$flags</span><span class="initializer"> = <strong><span>null</span></strong></span></span><br>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">resource</span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   <span class="function"><strong style="color:#CC7832">dba_open()</strong></span> establishes a database instance for   <span class="parameter" style="color:#3A95FF">path</span> with <span class="parameter" style="color:#3A95FF">mode</span> using   <span class="parameter" style="color:#3A95FF">handler</span>.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.dba-open-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">path</span></dt>     <dd>      <p class="para">       Commonly a regular path in your filesystem.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">mode</span></dt>     <dd>      <p class="para">       It is <span>r</span> for read access, <span>w</span> for       read/write access to an already existing database, <span>c</span>       for read/write access and database creation if it doesn&#039;t currently exist,       and <span>n</span> for create, truncate and read/write access.       The database is created in BTree mode, other modes (like Hash or Queue)       are not supported.      </p>      <p class="para">       Additionally you can set the database lock method with the next char.        Use <span>l</span> to lock the database with a <var class="filename">.lck</var>       file or <span>d</span> to lock the databasefile itself. It is        important that all of your applications do this consistently.      </p>      <p class="para">       If you want to test the access and do not want to wait for the lock        you can add <span>t</span> as third character. When you are        absolutely sure that you do not require database locking you can do        so by using <span>-</span> instead of <span>l</span> or       <span>d</span>. When none of <span>d</span>,        <span>l</span> or <span>-</span> is used, dba will lock       on the database file as it would with <span>d</span>.      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:        <p class="para">        There can only be one writer for one database file. When you use dba on         a web server and more than one request requires write operations they can        only be done one after another. Also read during write is not allowed.        The dba extension uses locks to prevent this. See the following table:        <table class="doctable table">         <caption><strong>DBA locking</strong></caption>                   <thead>           <tr>            <th>already open</th>            <th><span class="parameter" style="color:#3A95FF">mode</span> = &quot;rl&quot;</th>            <th><span class="parameter" style="color:#3A95FF">mode</span> = &quot;rlt&quot;</th>            <th><span class="parameter" style="color:#3A95FF">mode</span> = &quot;wl&quot;</th>            <th><span class="parameter" style="color:#3A95FF">mode</span> = &quot;wlt&quot;</th>            <th><span class="parameter" style="color:#3A95FF">mode</span> = &quot;rd&quot;</th>            <th><span class="parameter" style="color:#3A95FF">mode</span> = &quot;rdt&quot;</th>            <th><span class="parameter" style="color:#3A95FF">mode</span> = &quot;wd&quot;</th>            <th><span class="parameter" style="color:#3A95FF">mode</span> = &quot;wdt&quot;</th>           </tr>          </thead>          <tbody class="tbody">           <tr>            <td>not open</td>            <td>ok</td>            <td>ok</td>            <td>ok</td>            <td>ok</td>            <td>ok</td>            <td>ok</td>            <td>ok</td>            <td>ok</td>           </tr>           <tr>            <td><span class="parameter" style="color:#3A95FF">mode</span> = &quot;rl&quot;</td>            <td>ok</td>            <td>ok</td>            <td>wait</td>            <td>false</td>            <td>illegal</td>            <td>illegal</td>            <td>illegal</td>            <td>illegal</td>           </tr>           <tr>            <td><span class="parameter" style="color:#3A95FF">mode</span> = &quot;wl&quot;</td>            <td>wait</td>            <td>false</td>            <td>wait</td>            <td>false</td>            <td>illegal</td>            <td>illegal</td>            <td>illegal</td>            <td>illegal</td>           </tr>           <tr>            <td><span class="parameter" style="color:#3A95FF">mode</span> = &quot;rd&quot;</td>            <td>illegal</td>            <td>illegal</td>            <td>illegal</td>            <td>illegal</td>            <td>ok</td>            <td>ok</td>            <td>wait</td>            <td>false</td>           </tr>           <tr>            <td><span class="parameter" style="color:#3A95FF">mode</span> = &quot;wd&quot;</td>            <td>illegal</td>            <td>illegal</td>            <td>illegal</td>            <td>illegal</td>            <td>wait</td>            <td>false</td>            <td>wait</td>            <td>false</td>           </tr>          </tbody>                 </table>        <ul class="simplelist">         <li class="member">ok: the second call will be successful.</li>         <li class="member">wait: the second call waits until <span class="function">{@link dba_close()}</span> is called for the first.</li>         <li class="member">false: the second call returns false.</li>         <li class="member">illegal: you must not mix <span>&quot;l&quot;</span> and <span>&quot;d&quot;</span> modifiers for <span class="parameter" style="color:#3A95FF">mode</span> parameter.</li>        </ul>       </p>      </p></blockquote>     </dd>             <dt><span class="parameter" style="color:#3A95FF">handler</span></dt>     <dd>      <p class="para">       The name of the <a href="https://www.php.net/manual/zh/dba.requirements.php" class="link">handler</a> which       shall be used for accessing <span class="parameter" style="color:#3A95FF">path</span>. It is passed       all optional parameters given to <span class="function"><strong style="color:#CC7832">dba_open()</strong></span> and       can act on behalf of them. If <span class="parameter" style="color:#3A95FF">handler</span> is <strong><span>null</span></strong>,       then the default handler is invoked.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">permission</span></dt>     <dd>      <p class="para">       Optional <span class="type" style="color:#EAB766">int</span> parameter which is passed to the driver. It has the same meaning as       the <span class="parameter" style="color:#3A95FF">permissions</span> parameter of <span class="function">{@link chmod()}</span>,       and defaults to <span>0644</span>.      </p>      <p class="para">       The <span>db1</span>, <span>db2</span>, <span>db3</span>,       <span>db4</span>, <span>dbm</span>, <span>gdbm</span>,       <span>ndbm</span>, and <span>lmdb</span> drivers support the       <span class="parameter" style="color:#3A95FF">permission</span> parameter.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">map_size</span></dt>     <dd>      <p class="para">       Optional <span class="type" style="color:#EAB766">int</span> parameter which is passed to the driver. Its value should be a multiple of the       page size of the OS, or zero, to use the default map size.      </p>      <p class="para">       Only the <span>lmdb</span> driver accepts the <span class="parameter" style="color:#3A95FF">map_size</span> parameter.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">flags</span></dt>     <dd>      <p class="para">       Flags to pass to the database drivers. If <strong><span>null</span></strong> the default flags will be provided.       Currently, only the LMDB driver supports the following flags       <strong><span>DBA_LMDB_USE_SUB_DIR</span></strong> and       <strong><span>DBA_LMDB_NO_SUB_DIR</span></strong>.      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.dba-open-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   Returns a positive handle on success 或者在失败时返回 <strong><span>false</span></strong>.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 errors" id="refsect1-function.dba-open-errors">  <h3 class="title">错误／异常</h3>  <p class="para">   <strong><span>false</span></strong> is returned and an <strong><span>E_WARNING</span></strong> level error is issued when   <span class="parameter" style="color:#3A95FF">handler</span> is <strong><span>null</span></strong>, but there is no default handler.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.dba-open-changelog">  <h3 class="title">更新日志</h3>  <table class="doctable informaltable">       <thead>     <tr>      <th>版本</th>      <th>说明</th>     </tr>    </thead>    <tbody class="tbody">     <tr>      <td>8.2.0</td>      <td>       <span class="parameter" style="color:#3A95FF">flags</span> is added.      </td>     </tr>     <tr>      <td>8.2.0</td>      <td>       <span class="parameter" style="color:#3A95FF">handler</span> is now nullable.      </td>     </tr>     <tr>      <td>7.3.14, 7.4.2</td>      <td>       The <span>lmdb</span> driver now supports an additional <span class="parameter" style="color:#3A95FF">map_size</span>       parameter.      </td>     </tr>    </tbody>     </table> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.dba-open-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link dba_popen()} - Open database persistently</span></li>    <li class="member"><span class="function">{@link dba_close()} - Close a DBA database</span></li>   </ul>  </span> </div></div>