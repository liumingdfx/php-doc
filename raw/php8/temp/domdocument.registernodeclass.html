<div id="domdocument.registernodeclass" class="refentry"> <div class="refnamediv">  <h1 class="refname">DOMDocument::registerNodeClass</h1>  <p class="verinfo">(PHP 5 &gt;= 5.2.0, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">DOMDocument::registerNodeClass</span> &mdash; <span class="dc-title">Register extended class used to create base node type</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-domdocument.registernodeclass-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><strong>DOMDocument::registerNodeClass</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$baseClass</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">string</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$extendedClass</span></span>): <span class="type" style="color:#EAB766">bool</span></div>  <p class="para rdfs-comment">   This method allows you to register your own extended DOM class to be used   afterward by the PHP DOM extension.  </p>  <p class="para">   This method is not part of the DOM standard.  </p>  <div class="caution"><strong class="caution">警告</strong>   <p class="simpara">    The constructor of the objects of the registered node classes is not called.   </p>  </div> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-domdocument.registernodeclass-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">baseClass</span></dt>     <dd>      <p class="para">       The DOM class that you want to extend. You can find a list of these        classes in the <a href="https://www.php.net/manual/zh/book.dom.php" class="link">chapter introduction</a>.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">extendedClass</span></dt>     <dd>      <p class="para">       Your extended class name. If <strong><span>null</span></strong> is provided, any previously        registered class extending <span class="parameter" style="color:#3A95FF">baseClass</span> will       be removed.      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-domdocument.registernodeclass-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   成功时返回 <strong><span>true</span></strong>， 或者在失败时返回 <strong><span>false</span></strong>。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-domdocument.registernodeclass-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 Adding a new method to DOMElement to ease our code</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #007700">class </span><span style="color: #9876AA">myElement </span><span style="color: #007700">extends </span><span style="color: #9876AA">DOMElement </span><span style="color: #007700">{<br />   function </span><span style="color: #9876AA">appendElement</span><span style="color: #007700">(</span><span style="color: #9876AA">$name</span><span style="color: #007700">) { <br />      return </span><span style="color: #9876AA">$this</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">appendChild</span><span style="color: #007700">(new </span><span style="color: #9876AA">myElement</span><span style="color: #007700">(</span><span style="color: #9876AA">$name</span><span style="color: #007700">));<br />   }<br />}<br /><br />class </span><span style="color: #9876AA">myDocument </span><span style="color: #007700">extends </span><span style="color: #9876AA">DOMDocument </span><span style="color: #007700">{<br />   function </span><span style="color: #9876AA">setRoot</span><span style="color: #007700">(</span><span style="color: #9876AA">$name</span><span style="color: #007700">) { <br />      return </span><span style="color: #9876AA">$this</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">appendChild</span><span style="color: #007700">(new </span><span style="color: #9876AA">myElement</span><span style="color: #007700">(</span><span style="color: #9876AA">$name</span><span style="color: #007700">));<br />   }<br />}<br /><br /></span><span style="color: #9876AA">$doc </span><span style="color: #007700">= new </span><span style="color: #9876AA">myDocument</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">registerNodeClass</span><span style="color: #007700">(</span><span style="color: #DD0000">'DOMElement'</span><span style="color: #007700">, </span><span style="color: #DD0000">'myElement'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// From now on, adding an element to another costs only one method call ! <br /></span><span style="color: #9876AA">$root </span><span style="color: #007700">= </span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">setRoot</span><span style="color: #007700">(</span><span style="color: #DD0000">'root'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$child </span><span style="color: #007700">= </span><span style="color: #9876AA">$root</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">appendElement</span><span style="color: #007700">(</span><span style="color: #DD0000">'child'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$child</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">setAttribute</span><span style="color: #007700">(</span><span style="color: #DD0000">'foo'</span><span style="color: #007700">, </span><span style="color: #DD0000">'bar'</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">saveXML</span><span style="color: #007700">();<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例会输出：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>&lt;?xml version=&quot;1.0&quot;?&gt;<br>&lt;root&gt;&lt;child foo=&quot;bar&quot;/&gt;&lt;/root&gt;<br></span></div>    </div>   </div>  </span>  <p class="para">   <div class="example" id="">    <p><strong>示例 #2 Retrieving elements as custom class</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #9876AA">myElement </span><span style="color: #007700">extends </span><span style="color: #9876AA">DOMElement </span><span style="color: #007700">{<br />    public function </span><span style="color: #9876AA">__toString</span><span style="color: #007700">() {<br />        return </span><span style="color: #9876AA">$this</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">nodeValue</span><span style="color: #007700">;<br />    }<br />}<br /><br /></span><span style="color: #9876AA">$doc </span><span style="color: #007700">= new </span><span style="color: #9876AA">DOMDocument</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">loadXML</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;root&gt;&lt;element&gt;&lt;child&gt;text in child&lt;/child&gt;&lt;/element&gt;&lt;/root&gt;"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">registerNodeClass</span><span style="color: #007700">(</span><span style="color: #DD0000">"DOMElement"</span><span style="color: #007700">, </span><span style="color: #DD0000">"myElement"</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$element </span><span style="color: #007700">= </span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">getElementsByTagName</span><span style="color: #007700">(</span><span style="color: #DD0000">"child"</span><span style="color: #007700">)-&gt;</span><span style="color: #9876AA">item</span><span style="color: #007700">(</span><span style="color: #9876AA">0</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">get_class</span><span style="color: #007700">(</span><span style="color: #9876AA">$element</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">// And take advantage of the __toString method..<br /></span><span style="color: #007700">echo </span><span style="color: #9876AA">$element</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例会输出：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>string(9) &quot;myElement&quot;<br>text in child<br></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="">    <p><strong>示例 #3 Retrieving owner document</strong></p>    <div class="example-contents"><p>     When instantiating a custom <span class="classname"><a href="https://www.php.net/manual/zh/class.domdocument.php" class="classname">DOMDocument</a></span> the     <var class="varname">ownerDocument</var> property will refer to the instantiated     class. However, if all references to that class are removed, it     will be destroyed and new <span class="classname"><a href="https://www.php.net/manual/zh/class.domdocument.php" class="classname">DOMDocument</a></span> will be     created instead. For that reason you might use     <span class="function"><strong style="color:#CC7832">DOMDocument::registerNodeClass()</strong></span> with     <span class="classname"><a href="https://www.php.net/manual/zh/class.domdocument.php" class="classname">DOMDocument</a></span>    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #9876AA">MyDOMDocument </span><span style="color: #007700">extends </span><span style="color: #9876AA">DOMDocument </span><span style="color: #007700">{<br />}<br /><br />class </span><span style="color: #9876AA">MyOtherDOMDocument </span><span style="color: #007700">extends </span><span style="color: #9876AA">DOMDocument </span><span style="color: #007700">{<br />}<br /><br /></span><span style="color: #FF8000">// Create MyDOMDocument with some XML<br /></span><span style="color: #9876AA">$doc </span><span style="color: #007700">= new </span><span style="color: #9876AA">MyDOMDocument</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">loadXML</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;root&gt;&lt;element&gt;&lt;child&gt;text in child&lt;/child&gt;&lt;/element&gt;&lt;/root&gt;"</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$child </span><span style="color: #007700">= </span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">getElementsByTagName</span><span style="color: #007700">(</span><span style="color: #DD0000">"child"</span><span style="color: #007700">)-&gt;</span><span style="color: #9876AA">item</span><span style="color: #007700">(</span><span style="color: #9876AA">0</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// The current owner of the node is MyDOMDocument<br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">get_class</span><span style="color: #007700">(</span><span style="color: #9876AA">$child</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">ownerDocument</span><span style="color: #007700">));<br /></span><span style="color: #FF8000">// MyDOMDocument is destroyed<br /></span><span style="color: #007700">unset(</span><span style="color: #9876AA">$doc</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">// And new DOMDocument instance is created<br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">get_class</span><span style="color: #007700">(</span><span style="color: #9876AA">$child</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">ownerDocument</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">// Import a node from MyDOMDocument<br /></span><span style="color: #9876AA">$newdoc </span><span style="color: #007700">= new </span><span style="color: #9876AA">MyOtherDOMDocument</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$child </span><span style="color: #007700">= </span><span style="color: #9876AA">$newdoc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">importNode</span><span style="color: #007700">(</span><span style="color: #9876AA">$child</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Register custom DOMDocument<br /></span><span style="color: #9876AA">$newdoc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">registerNodeClass</span><span style="color: #007700">(</span><span style="color: #DD0000">"DOMDocument"</span><span style="color: #007700">, </span><span style="color: #DD0000">"MyOtherDOMDocument"</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">get_class</span><span style="color: #007700">(</span><span style="color: #9876AA">$child</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">ownerDocument</span><span style="color: #007700">));<br />unset(</span><span style="color: #9876AA">$doc</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">// New MyOtherDOMDocument is created<br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">get_class</span><span style="color: #007700">(</span><span style="color: #9876AA">$child</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">ownerDocument</span><span style="color: #007700">));<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例会输出：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>string(13) &quot;MyDOMDocument&quot;<br>string(11) &quot;DOMDocument&quot;<br>string(18) &quot;MyOtherDOMDocument&quot;<br>string(18) &quot;MyOtherDOMDocument&quot;<br></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="">    <p><strong>示例 #4 Custom objects are transient</strong></p>    <div class="caution"><strong class="caution">警告</strong>     <p class="simpara">      Objects of the registered node classes are transient, i.e. they are      destroyed when they are no longer referenced from PHP code, and recreated      when being retrieved again. That implies that custom property values will be      lost after recreation.     </p>    </div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #9876AA">MyDOMElement </span><span style="color: #007700">extends </span><span style="color: #9876AA">DOMElement<br /></span><span style="color: #007700">{<br />    public </span><span style="color: #9876AA">$myProp </span><span style="color: #007700">= </span><span style="color: #DD0000">'default value'</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #9876AA">$doc </span><span style="color: #007700">= new </span><span style="color: #9876AA">DOMDocument</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">registerNodeClass</span><span style="color: #007700">(</span><span style="color: #DD0000">'DOMElement'</span><span style="color: #007700">, </span><span style="color: #DD0000">'MyDOMElement'</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$node </span><span style="color: #007700">= </span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">createElement</span><span style="color: #007700">(</span><span style="color: #DD0000">'a'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$node</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">myProp </span><span style="color: #007700">= </span><span style="color: #DD0000">'modified value'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">appendChild</span><span style="color: #007700">(</span><span style="color: #9876AA">$node</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">childNodes</span><span style="color: #007700">[</span><span style="color: #9876AA">0</span><span style="color: #007700">]-&gt;</span><span style="color: #9876AA">myProp</span><span style="color: #007700">, </span><span style="color: #9876AA">PHP_EOL</span><span style="color: #007700">;<br />unset(</span><span style="color: #9876AA">$node</span><span style="color: #007700">);<br />echo </span><span style="color: #9876AA">$doc</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">childNodes</span><span style="color: #007700">[</span><span style="color: #9876AA">0</span><span style="color: #007700">]-&gt;</span><span style="color: #9876AA">myProp</span><span style="color: #007700">, </span><span style="color: #9876AA">PHP_EOL</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例会输出：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>modified value<br>default value<br></span></div>    </div>   </div>  </p> </div></div>