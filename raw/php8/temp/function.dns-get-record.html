<div id="function.dns-get-record" class="refentry"> <div class="refnamediv">  <h1 class="refname">dns_get_record</h1>  <p class="verinfo">(PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">dns_get_record</span> &mdash; <span class="dc-title">获取指定主机名的 DNS 纪录</span></p> </div>  <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.dns-get-record-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>dns_get_record</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$hostname</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$type</span><span class="initializer"> = <strong><span>DNS_ANY</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">&$authoritative_name_servers</span><span class="initializer"> = <strong><span>null</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">&$additional_records</span><span class="initializer"> = <strong><span>null</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">bool</span> <span class="parameter" style="color:#3A95FF">$raw</span><span class="initializer"> = <strong><span>false</span></strong></span></span><br>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   获取指定 <span class="parameter" style="color:#3A95FF">hostname</span> 的 DNS 纪录。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.dns-get-record-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">hostname</span></dt>     <dd>      <p class="para">       <span class="parameter" style="color:#3A95FF">hostname</span> 应该是有效的 DNS 主机名，比如“<span>www.example.com</span>”。可以使用       <span>in-addr.arpa</span> 表示法生成反向查找，但大多数情况下更适合用 <span class="function">{@link gethostbyaddr()}</span>。      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:        <p class="para">        根据 DNS 标准，邮件地址以 <span>user.host</span> 格式给出（例如：<span>hostmaster.example.com</span>        而不是 <span>hostmaster@example.com</span>），请务必检查此值并在必要时进行修改，然后将其与        <span class="function">{@link mail()}</span> 等函数一起使用。       </p>      </p></blockquote>     </dd>             <dt><span class="parameter" style="color:#3A95FF">type</span></dt>     <dd>      <p class="para">       默认情况下，<span class="function"><strong style="color:#CC7832">dns_get_record()</strong></span> 将会搜索跟 <span class="parameter" style="color:#3A95FF">hostname</span>       关联的任何资源记录。要限制查询，可以指定可选的 <span class="parameter" style="color:#3A95FF">type</span>       选项。可以是以下之一：<strong><span>DNS_A</span></strong>、<strong><span>DNS_CNAME</span></strong>、<strong><span>DNS_HINFO</span></strong>, <strong><span>DNS_CAA</span></strong>、<strong><span>DNS_MX</span></strong>、<strong><span>DNS_NS</span></strong>、<strong><span>DNS_PTR</span></strong>、<strong><span>DNS_SOA</span></strong>、<strong><span>DNS_TXT</span></strong>、<strong><span>DNS_AAAA</span></strong>、<strong><span>DNS_SRV</span></strong>、<strong><span>DNS_NAPTR</span></strong>、<strong><span>DNS_A6</span></strong>、<strong><span>DNS_ALL</span></strong>       或 <strong><span>DNS_ANY</span></strong>。      </p>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:        <p class="para">        因为不同平台间的 libresolv 存在性能差异，<strong><span>DNS_ANY</span></strong>        不会始终返回每条记录，较慢的 <strong><span>DNS_ALL</span></strong>        会更可靠的收集所有记录。       </p>      </p></blockquote>      <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:        <p class="para">        Windows：不支持 <strong><span>DNS_CAA</span></strong>。没有实现对        <strong><span>DNS_A6</span></strong> 的支持。       </p>      </p></blockquote>     </dd>             <dt><span class="parameter" style="color:#3A95FF">authoritative_name_servers</span></dt>     <dd>      <p class="para">       引用传递，如果给出，将会填充<em>权威名称服务器</em>的资源记录。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">additional_records</span></dt>     <dd>      <p class="para">       引用传递，如果给出，将会填充任何<em>附加记录</em>。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">raw</span></dt>     <dd>      <p class="para">       <span class="parameter" style="color:#3A95FF">type</span> 将解释为原始 DNS 类型 ID（不能使用 <span>DNS_*</span>       常量）。返回值包含 <span>data</span> 键，需要手动解析。      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.dns-get-record-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   此函数返回由关联数组组成的数组， 或者在失败时返回 <strong><span>false</span></strong>。每个关联数组<em>至少</em>包含以下键：   <table class="doctable table">    <caption><strong>基础 DNS 属性</strong></caption>         <thead>      <tr>       <th>属性</th>       <th>含义</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td>host</td>       <td>        The record in the DNS namespace to which the rest of the associated data refers.       </td>      </tr>      <tr>       <td>class</td>       <td>        <span class="function"><strong style="color:#CC7832">dns_get_record()</strong></span> 仅返回内部类记录，因此参数将始终返回 <span>IN</span>。       </td>      </tr>      <tr>       <td>type</td>       <td>        包含记录类型的字符串。其他属性也包含在结果数组中，具体取决于 type 的值。查看下表。       </td>      </tr>      <tr>       <td>ttl</td>       <td>        <span>&quot;Time To Live&quot;</span> remaining for this record. This will <em>not</em> equal        the record&#039;s original ttl, but will rather equal the original ttl minus whatever        length of time has passed since the authoritative name server was queried.       </td>      </tr>     </tbody>       </table>  </p>  <p class="para">   <table class="doctable table">    <caption><strong>根据“type”的不同，出现的关联数组的其它键</strong></caption>         <thead>      <tr>       <th>类型</th>       <th>额外列</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td><span>A</span></td>       <td>        <span>ip</span>：点分十进制格式的 IPv4。       </td>      </tr>      <tr>       <td><span>MX</span></td>       <td>        <span>pri</span>：邮件交换器的有优先级。较低的数字有较高的优先级。<span>target</span>：邮件服务器的        FQDN（全称域名）。参阅 <span class="function">{@link dns_get_mx()}</span>。       </td>      </tr>      <tr>       <td><span>CNAME</span></td>       <td>        <span>target</span>: FQDN of location in DNS namespace to which        the record is aliased.       </td>      </tr>      <tr>       <td><span>NS</span></td>       <td>        <span>target</span>: FQDN of the name server which is authoritative        for this hostname.       </td>      </tr>      <tr>       <td><span>PTR</span></td>       <td>        <span>target</span>: Location within the DNS namespace to which        this record points.       </td>      </tr>       <tr>       <td><span>TXT</span></td>       <td>        <span>txt</span>：跟此记录关联的任意字符串数据。       </td>      </tr>      <tr>       <td><span>HINFO</span></td>       <td>        <span>cpu</span>: IANA number designating the CPU of the machine        referenced by this record.        <span>os</span>: IANA number designating the Operating System on        the machine referenced by this record.        See IANA&#039;s <a href="http://www.iana.org/assignments/operating-system-names" class="link external">&raquo;&nbsp;<span>Operating System        Names</span></a> for the meaning of these values.       </td>      </tr>      <tr>       <td><span>CAA</span></td>       <td>        <span>flags</span>：单字节位字段；目前仅定义了第 0        位，意味着“critical”；其他位保留且应该忽略。<span>tag</span>：CAA        标记名（字母数字的 ASCII 字符串）。<span>value</span>：CAA        标记值（二进制字符串，可以使用子格式）。更多信息参阅：<a href="http://www.faqs.org/rfcs/rfc6844" class="link external">&raquo;&nbsp;RFC 6844</a>。       </td>      </tr>      <tr>       <td><span>SOA</span></td>       <td>        <span>mname</span>: FQDN of the machine from which the resource        records originated.        <span>rname</span>: Email address of the administrative contact        for this domain.        <span>serial</span>: Serial # of this revision of the requested        domain.        <span>refresh</span>: Refresh interval (seconds) secondary name        servers should use when updating remote copies of this domain.        <span>retry</span>: Length of time (seconds) to wait after a        failed refresh before making a second attempt.        <span>expire</span>: Maximum length of time (seconds) a secondary        DNS server should retain remote copies of the zone data without a        successful refresh before discarding.        <span>minimum-ttl</span>: Minimum length of time (seconds) a        client can continue to use a DNS resolution before it should request        a new resolution from the server.  Can be overridden by individual        resource records.       </td>      </tr>      <tr>       <td><span>AAAA</span></td>       <td>        <span>ipv6</span>：IPv6 地址       </td>      </tr>      <tr>       <td><span>A6</span></td>       <td>        <span>masklen</span>: Length (in bits) to inherit from the target        specified by <span class="parameter" style="color:#3A95FF">chain</span>.        <span>ipv6</span>: Address for this specific record to merge with        <span class="parameter" style="color:#3A95FF">chain</span>.        <span>chain</span>: Parent record to merge with        <span class="parameter" style="color:#3A95FF">ipv6</span> data.       </td>      </tr>      <tr>       <td><span>SRV</span></td>       <td>        <span>pri</span>: (Priority) lowest priorities should be used first.        <span>weight</span>: Ranking to weight which of commonly prioritized        <span class="parameter" style="color:#3A95FF">targets</span> should be chosen at random.        <span>target</span> and <span>port</span>: hostname and port        where the requested service can be found.        For additional information see: <a href="http://www.faqs.org/rfcs/rfc2782" class="link external">&raquo;&nbsp;RFC 2782</a>       </td>      </tr>      <tr>       <td><span>NAPTR</span></td>       <td>        <span>order</span> and <span>pref</span>: Equivalent to        <span class="parameter" style="color:#3A95FF">pri</span> and <span class="parameter" style="color:#3A95FF">weight</span> above.        <span>flags</span>, <span>services</span>, <span>regex</span>,        and <span>replacement</span>: Parameters as defined by        <a href="http://www.faqs.org/rfcs/rfc2915" class="link external">&raquo;&nbsp;RFC 2915</a>.       </td>      </tr>     </tbody>       </table>  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.dns-get-record-changelog">  <h3 class="title">更新日志</h3>  <span>   <table class="doctable informaltable">         <thead>      <tr>       <th>版本</th>       <th>说明</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td>7.0.16, 7.1.2</td>       <td>        新增对 CAA 记录的支持。       </td>      </tr>     </tbody>       </table>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.dns-get-record-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 使用 <span class="function"><strong style="color:#CC7832">dns_get_record()</strong></span></strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$result </span><span style="color: #007700">= </span><span style="color: #9876AA">dns_get_record</span><span style="color: #007700">(</span><span style="color: #DD0000">"php.net"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$result</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例的输出类似于：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>Array<br>(<br>    [0] =&gt; Array<br>        (<br>            [host] =&gt; php.net<br>            [type] =&gt; MX<br>            [pri] =&gt; 5<br>            [target] =&gt; pair2.php.net<br>            [class] =&gt; IN<br>            [ttl] =&gt; 6765<br>        )<br><br>    [1] =&gt; Array<br>        (<br>            [host] =&gt; php.net<br>            [type] =&gt; A<br>            [ip] =&gt; 64.246.30.37<br>            [class] =&gt; IN<br>            [ttl] =&gt; 8125<br>        )<br><br>)<br></span></div>    </div>   </div>   <div class="example" id="">    <p><strong>示例 #2 使用 <span class="function"><strong style="color:#CC7832">dns_get_record()</strong></span> 和 DNS_ANY</strong></p>    <div class="example-contents"><p>     一旦解析了 MX 记录，通常需要邮件服务器的 IP 地址，因此 <span class="function"><strong style="color:#CC7832">dns_get_record()</strong></span>     还会在 <span class="parameter" style="color:#3A95FF">additional_records</span>     中返回包含关联记录的数组。<span class="parameter" style="color:#3A95FF">authoritative_name_servers</span>     也会返回，包含权威名称服务器列表。    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// 为 php.net 请求“ANY”记录，并创建 $authns 和 $addtl 数组，<br />   包含名称服务器列表和任何附加记录列表 <br /></span><span style="color: #9876AA">$result </span><span style="color: #007700">= </span><span style="color: #9876AA">dns_get_record</span><span style="color: #007700">(</span><span style="color: #DD0000">"php.net"</span><span style="color: #007700">, </span><span style="color: #9876AA">DNS_ANY</span><span style="color: #007700">, </span><span style="color: #9876AA">$authns</span><span style="color: #007700">, </span><span style="color: #9876AA">$addtl</span><span style="color: #007700">);<br />echo </span><span style="color: #DD0000">"Result = "</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$result</span><span style="color: #007700">);<br />echo </span><span style="color: #DD0000">"Auth NS = "</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$authns</span><span style="color: #007700">);<br />echo </span><span style="color: #DD0000">"Additional = "</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$addtl</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例的输出类似于：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>Result = Array<br>(<br>    [0] =&gt; Array<br>        (<br>            [host] =&gt; php.net<br>            [type] =&gt; MX<br>            [pri] =&gt; 5<br>            [target] =&gt; pair2.php.net<br>            [class] =&gt; IN<br>            [ttl] =&gt; 6765<br>        )<br><br>    [1] =&gt; Array<br>        (<br>            [host] =&gt; php.net<br>            [type] =&gt; A<br>            [ip] =&gt; 64.246.30.37<br>            [class] =&gt; IN<br>            [ttl] =&gt; 8125<br>        )<br><br>)<br>Auth NS = Array<br>(<br>    [0] =&gt; Array<br>        (<br>            [host] =&gt; php.net<br>            [type] =&gt; NS<br>            [target] =&gt; remote1.easydns.com<br>            [class] =&gt; IN<br>            [ttl] =&gt; 10722<br>        )<br><br>    [1] =&gt; Array<br>        (<br>            [host] =&gt; php.net<br>            [type] =&gt; NS<br>            [target] =&gt; remote2.easydns.com<br>            [class] =&gt; IN<br>            [ttl] =&gt; 10722<br>        )<br><br>    [2] =&gt; Array<br>        (<br>            [host] =&gt; php.net<br>            [type] =&gt; NS<br>            [target] =&gt; ns1.easydns.com<br>            [class] =&gt; IN<br>            [ttl] =&gt; 10722<br>        )<br><br>    [3] =&gt; Array<br>        (<br>            [host] =&gt; php.net<br>            [type] =&gt; NS<br>            [target] =&gt; ns2.easydns.com<br>            [class] =&gt; IN<br>            [ttl] =&gt; 10722<br>        )<br><br>)<br>Additional = Array<br>(<br>    [0] =&gt; Array<br>        (<br>            [host] =&gt; pair2.php.net<br>            [type] =&gt; A<br>            [ip] =&gt; 216.92.131.5<br>            [class] =&gt; IN<br>            [ttl] =&gt; 6766<br>        )<br><br>    [1] =&gt; Array<br>        (<br>            [host] =&gt; remote1.easydns.com<br>            [type] =&gt; A<br>            [ip] =&gt; 64.39.29.212<br>            [class] =&gt; IN<br>            [ttl] =&gt; 100384<br>        )<br><br>    [2] =&gt; Array<br>        (<br>            [host] =&gt; remote2.easydns.com<br>            [type] =&gt; A<br>            [ip] =&gt; 212.100.224.80<br>            [class] =&gt; IN<br>            [ttl] =&gt; 81241<br>        )<br><br>    [3] =&gt; Array<br>        (<br>            [host] =&gt; ns1.easydns.com<br>            [type] =&gt; A<br>            [ip] =&gt; 216.220.40.243<br>            [class] =&gt; IN<br>            [ttl] =&gt; 81241<br>        )<br><br>    [4] =&gt; Array<br>        (<br>            [host] =&gt; ns2.easydns.com<br>            [type] =&gt; A<br>            [ip] =&gt; 216.220.40.244<br>            [class] =&gt; IN<br>            [ttl] =&gt; 81241<br>        )<br><br>)<br></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.dns-get-record-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link dns_get_mx()} - 别名 getmxrr</span></li>    <li class="member"><span class="function">{@link dns_check_record()} - 别名 checkdnsrr</span></li>   </ul>  </span> </div></div>