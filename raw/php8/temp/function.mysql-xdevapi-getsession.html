<div id="function.mysql-xdevapi-getsession" class="refentry"> <div class="refnamediv">  <h1 class="refname">getSession</h1>  <p class="verinfo">(No version information available, might only be in Git)</p><p class="refpurpose"><span class="refname">getSession</span> &mdash; <span class="dc-title">Connect to a MySQL server</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.mysql-xdevapi-getsession-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>mysql_xdevapi\getSession</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$uri</span></span>): <span class="type" style="color:#EAB766"><a href="https://www.php.net/manual/zh/class.mysql-xdevapi-session.php" class="type mysql_xdevapi\Session" style="color:#EAB766">mysql_xdevapi\Session</a></span></div>  <p class="para rdfs-comment">   Connects to the MySQL server.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.mysql-xdevapi-getsession-parameters">  <h3 class="title">参数</h3>  <dl>       <dt><span class="parameter" style="color:#3A95FF">uri</span></dt>    <dd>     <span>      The URI to the MySQL server, such as <span>mysqlx://user:password@host</span>.     </span>     <p class="para">      URI format:     </p>     <p class="para">      <span>scheme://[user[:[password]]@]target[:port][?attribute1=value1&amp;attribute2=value2...</span>     </p>     <ul class="itemizedlist">      <li class="listitem">        <p class="para"><span>scheme</span>: required, the connection protocol</p>        <p class="para">In mysql_xdevapi it is always &#039;mysqlx&#039; (for X Protocol)</p>      </li>      <li class="listitem">        <p class="para"><span>user</span>: optional, the MySQL user account for authentication</p>      </li>      <li class="listitem">        <p class="para"><span>password</span>: optional, the MySQL user&#039;s password for authentication</p>      </li>      <li class="listitem">        <p class="para"><span>target</span>: required, the server instance the connection refers to:</p>        <p class="para">* TCP connection (host name, IPv4 address, or IPv6 address)</p>        <p class="para">* Unix socket path (local file path)</p>        <p class="para">* Windows named-pipe (local file path)</p>      </li>      <li class="listitem">        <p class="para"><span>port</span>: optional, network port of MySQL server.</p>        <p class="para">by default port for X Protocol is 33060</p>      </li>      <li class="listitem">        <p class="para">          <span>?attribute=value</span>: this element is optional and specifies a data dictionary           that contains different options, including:        </p>        <ul class="itemizedlist">          <li class="listitem">          <p class="para">            The <span>auth</span> (authentication mechanism) attribute as it relates to encrypted connections.            For additional information, see <a href="https://www.php.net/manual/zh/https://dev.mysql.com/doc/refman/8.0/en/encrypted-connection-options.php" class="link external">&raquo;&nbsp;Command            Options for Encrypted Connections</a>.            The following &#039;auth&#039; values are supported: <span>plain</span>,            <span>mysql41</span>, <span>external</span>, and <span>sha256_mem</span>.          </p>          </li>          <li class="listitem">          <p class="para">           The <span>connect-timeout</span> attribute affects the connection           and not subsequent operations. It is set per connection whether on           a single or multiple hosts.          </p>          <p class="para">           Pass in a positive integer to define the connection timeout in seconds,           or pass in 0 (zero) to disable the timeout (infinite). Not defining           connect-timeout uses the default value of 10.          </p>          <p class="para">            Related, the MYSQLX_CONNECTION_TIMEOUT (timeout in seconds) and MYSQLX_TEST_CONNECTION_TIMEOUT (used while running tests)            environment variables can be set and used instead of connect-timeout in the URI. The            connect-timeout URI option has precedence over these environment variables.          </p>          </li>          <li class="listitem">            <p class="para">              The optional <span>compression</span> attribute accepts these values:               <span>preferred</span> (client negotiates with server to find a supported algorithm; connection is uncompressed if a mutually supported algorithm is not found),               <span>required</span> (like &quot;preferred&quot;, but connection is terminated if a mutually supported algorithm is not found), or              <span>disabled</span> (connection is uncompressed). Defaults to <span>preferred</span>.            </p>            <p class="para">              This option was added in version 8.0.20.            </p>          </li>          <li class="listitem">            <p class="para">              The optional <span>compression-algorithms</span> attribute defines               the desired compression algorithms (and their preferred usage order):               <span>zstd_stream</span> (alias: zstd),              <span>lz4_message</span> (alias: lz4), or              <span>deflate_stream</span> (aliases: deflate or zlib).              By default, the order used (depending on system availability) is lz4_message, zstd_stream, then deflate_stream.              For example, passing in compression-algorithms=[lz4,zstd_stream] uses lz4 if it&#039;s available, otherwise              zstd_stream is used. If both are unavailable then behavior depends on the compression value              e.g., if compression=required then it&#039;ll fail with an error.            </p>            <p class="para">              This option was added in version 8.0.22.            </p>          </li>        </ul>       </li>      </ul>  <div class="example" id="example-4673">  <p><strong>示例 #1 URI examples</strong></p>  <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000">mysqlx://foobar<br />mysqlx://root@localhost?socket=%2Ftmp%2Fmysqld.sock%2F<br />mysqlx://foo:bar@localhost:33060<br />mysqlx://foo:bar@localhost:33160?ssl-mode=disabled<br />mysqlx://foo:bar@localhost:33260?ssl-mode=required<br />mysqlx://foo:bar@localhost:33360?ssl-mode=required&amp;auth=mysql41<br />mysqlx://foo:bar@(/path/to/socket)<br />mysqlx://foo:bar@(/path/to/socket)?auth=sha256_mem<br />mysqlx://foo:bar@[localhost:33060, 127.0.0.1:33061]<br />mysqlx://foobar?ssl-ca=(/path/to/ca.pem)&amp;ssl-crl=(/path/to/crl.pem)<br />mysqlx://foo:bar@[localhost:33060, 127.0.0.1:33061]?ssl-mode=disabled<br />mysqlx://foo:bar@localhost:33160/?connect-timeout=0<br />mysqlx://foo:bar@localhost:33160/?connect-timeout=10&amp;compression=required<br />mysqlx://foo:bar@localhost:33160/?connect-timeout=10&amp;compression=required&amp;compression-algorithms=[lz4,zstd_stream]</span></span></div></div></div>   <p class="para">    For related information, see MySQL Shell&#039;s    <a href="https://www.php.net/manual/zh/https://dev.mysql.com/doc/refman/8.0/en/mysql-shell-connection-using-uri.php" class="link external">&raquo;&nbsp;Connecting using a URI String</a>.   </p>    </dd>     </dl> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.mysql-xdevapi-getsession-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   A <span class="classname"><strong class="classname">Session</strong></span> object.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 errors" id="refsect1-function.mysql-xdevapi-getsession-errors">  <h3 class="title">错误／异常</h3>  <p class="para">   A connection failure throws an <span class="classname"><a href="https://www.php.net/manual/zh/class.exception.php" class="classname">Exception</a></span>.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.mysql-xdevapi-getsession-examples">  <h3 class="title">示例</h3>  <div class="example" id="example-4676">   <p><strong>示例 #2 <span class="function"><strong style="color:#CC7832">mysql_xdevapi\getSession()</strong></span> example</strong></p>   <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #007700">try {<br />    </span><span style="color: #9876AA">$session </span><span style="color: #007700">= </span><span style="color: #9876AA">mysql_xdevapi\getSession</span><span style="color: #007700">(</span><span style="color: #DD0000">"mysqlx://user:password@host"</span><span style="color: #007700">);<br />} catch(</span><span style="color: #9876AA">Exception $e</span><span style="color: #007700">) {<br />    die(</span><span style="color: #DD0000">"Connection could not be established: " </span><span style="color: #007700">. </span><span style="color: #9876AA">$e</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">getMessage</span><span style="color: #007700">());<br />}<br /><br /></span><span style="color: #9876AA">$schemas </span><span style="color: #007700">= </span><span style="color: #9876AA">$session</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">getSchemas</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$schemas</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$mysql_version </span><span style="color: #007700">= </span><span style="color: #9876AA">$session</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">getServerVersion</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">print_r</span><span style="color: #007700">(</span><span style="color: #9876AA">$mysql_version</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">find</span><span style="color: #007700">(</span><span style="color: #DD0000">"name = 'Alfred'"</span><span style="color: #007700">)-&gt;</span><span style="color: #9876AA">execute</span><span style="color: #007700">()-&gt;</span><span style="color: #9876AA">fetchOne</span><span style="color: #007700">());<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>   </div>   <div class="example-contents"><p>以上示例的输出类似于：</p></div>   <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>Array<br>(<br>    [0] =&gt; mysql_xdevapi\Schema Object<br>        (<br>            [name] =&gt; helloworld<br>        )<br>    [1] =&gt; mysql_xdevapi\Schema Object<br>        (<br>            [name] =&gt; information_schema<br>        )<br>    [2] =&gt; mysql_xdevapi\Schema Object<br>        (<br>            [name] =&gt; mysql<br>        )<br>    [3] =&gt; mysql_xdevapi\Schema Object<br>        (<br>            [name] =&gt; performance_schema<br>        )<br>    [4] =&gt; mysql_xdevapi\Schema Object<br>        (<br>            [name] =&gt; sys<br>        )<br>)<br><br>80012<br><br>array(4) {<br>  [&quot;_id&quot;]=&gt;<br>  string(28) &quot;00005ad66abf0001000400000003&quot;<br>  [&quot;age&quot;]=&gt;<br>  int(42)<br>  [&quot;job&quot;]=&gt;<br>  string(7) &quot;Butler&quot;<br>  [&quot;name&quot;]=&gt;<br>  string(4) &quot;Alfred&quot;<br>}<br></span></div>   </div>  </div> </div></div>