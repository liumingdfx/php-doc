<div id="function.db2-pconnect" class="refentry"> <div class="refnamediv">  <h1 class="refname">db2_pconnect</h1>  <p class="verinfo">(PECL ibm_db2 &gt;= 1.0.0)</p><p class="refpurpose"><span class="refname">db2_pconnect</span> &mdash; <span class="dc-title">   Returns a persistent connection to a database  </span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.db2-pconnect-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>db2_pconnect</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$database</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">string</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$username</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">string</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$password</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = []</span></span><br>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">resource</span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   Returns a persistent connection to an IBM DB2 Universal Database, IBM   Cloudscape, or Apache Derby database.  </p>  <p class="para">   For more information on persistent   connections, refer to <a href="https://www.php.net/manual/zh/features.persistent-connections.php" class="xref">持久数据库连接</a>.  </p>  <p class="para">   Calling <span class="function">{@link db2_close()}</span> on a persistent connection always   returns <strong><span>true</span></strong>, but the underlying DB2 client connection remains open and   waiting to serve the next matching <span class="function"><strong style="color:#CC7832">db2_pconnect()</strong></span>   request.  </p>  <p class="para">   Users running version 1.9.0 or later of ibm_db2 should be aware that the   extension will perform a transaction rollback on persistent connections at   the end of a request, thus ending the transaction.  This prevents the   transaction block from carrying over to the next request which uses that   connection if script execution ends before the transaction block does.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.db2-pconnect-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">database</span></dt>     <dd>      <p class="para">       The database alias in the DB2 client catalog.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">username</span></dt>     <dd>      <p class="para">       The username with which you are connecting to the database.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">password</span></dt>     <dd>      <p class="para">       The password with which you are connecting to the database.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">options</span></dt>     <dd>      <p class="para">       An associative array of connection options that affect the behavior       of the connection, where valid array keys include:       <dl>                 <dt><span class="parameter" style="color:#3A95FF">autocommit</span></dt>         <dd>          <p class="para">           Passing the <span>DB2_AUTOCOMMIT_ON</span> value turns           autocommit on for this connection handle.          </p>          <p class="para">           Passing the <span>DB2_AUTOCOMMIT_OFF</span> value turns           autocommit off for this connection handle.          </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">DB2_ATTR_CASE</span></dt>         <dd>          <p class="para">           Passing the <span>DB2_CASE_NATURAL</span> value specifies           that column names are returned in natural case.          </p>          <p class="para">           Passing the <span>DB2_CASE_LOWER</span> value specifies           that column names are returned in lower case.          </p>          <p class="para">           Passing the <span>DB2_CASE_UPPER</span> value specifies           that column names are returned in upper case.          </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">CURSOR</span></dt>         <dd>          <p class="para">           Passing the <span>DB2_FORWARD_ONLY</span> value specifies a           forward-only cursor for a statement resource. This is the default           cursor type and is supported on all database servers.          </p>          <p class="para">           Passing the <span>DB2_SCROLLABLE</span> value specifies a           scrollable cursor for a statement resource. This mode enables           random access to rows in a result set, but currently is supported           only by IBM DB2 Universal Database.          </p>         </dd>               </dl>      </p>      <p class="para">       The following new option is available in ibm_db2 version 1.7.0       and later.       <dl>                 <dt><span class="parameter" style="color:#3A95FF">trustedcontext</span></dt>         <dd>          <p class="para">           Passing the DB2_TRUSTED_CONTEXT_ENABLE value turns trusted context           on for this connection handle. This parameter cannot be set using           <span class="function">{@link db2_set_option()}</span>.          </p>          <p class="para">           This key works only if the database is cataloged (even if the           database is local), or if you specify the full DSN when you create           the connection.          </p>          <p class="para">           To catalog the database, use following commands:          </p>          <p class="para">           <span>db2 catalog tcpip node loopback remote &lt;SERVERNAME&gt; server &lt;SERVICENAME&gt;<br>db2 catalog database &lt;LOCALDBNAME&gt; as &lt;REMOTEDBNAME&gt; at node loopback<br>db2 &quot;update dbm cfg using svcename &lt;SERVICENAME&gt;&quot;<br>db2set DB2COMM=TCPIP</span>          </p>         </dd>              </dl>      </p>      <p class="para">       The following new i5/OS options are available in ibm_db2 version 1.5.1       and later.       <div class="tip"><strong class="tip">小技巧</strong>        <p class="para">Conflicting connection attributes used in conjunction with persistent         connections can produce indeterminate results on i5/OS. Site policies should         be establish for all applications using each persistent connection user         profile. The default DB2_AUTOCOMMIT_ON is suggested when using persistent connections.        </p>       </div>       <dl>                 <dt><span class="parameter" style="color:#3A95FF">i5_lib</span></dt>         <dd>          <p class="para">           A character value that indicates the default library that will be           used for resolving unqualified file references. This is not valid           if the connection is using system naming mode.          </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">i5_naming</span></dt>         <dd>          <p class="para">           <span>DB2_I5_NAMING_ON</span> value turns on DB2 UDB CLI iSeries           system naming mode. Files are qualified using the slash (/) delimiter.           Unqualified files are resolved using the library list for the job.          </p>          <p class="para">           <span>DB2_I5_NAMING_OFF</span> value turns off DB2 UDB CLI default           naming mode, which is SQL naming. Files are qualified using the period (.)           delimiter. Unqualified files are resolved using either the default library           or the current user ID.          </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">i5_commit</span></dt>         <dd>          <p class="para">           The <span class="parameter" style="color:#3A95FF">i5_commit</span> attribute should be set before the           <span class="function"><strong style="color:#CC7832">db2_pconnect()</strong></span>. If the value is changed after the           connection has been established, and the connection is to a remote data           source, the change does not take effect until the next successful           <span class="function"><strong style="color:#CC7832">db2_pconnect()</strong></span> for the connection handle.           <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:             <p class="para">             The php.ini setting <span class="parameter" style="color:#3A95FF">ibm_db2.i5_allow_commit</span>==0             or <span>DB2_I5_TXN_NO_COMMIT</span> is the default, but may be             overridden with the <span class="parameter" style="color:#3A95FF">i5_commit</span> option.            </p>           </p></blockquote>          </p>          <p class="para">           <span>DB2_I5_TXN_NO_COMMIT</span> - Commitment control is not used.          </p>          <p class="para">           <span>DB2_I5_TXN_READ_UNCOMMITTED</span> - Dirty reads, nonrepeatable           reads, and phantoms are possible.          </p>          <p class="para">           <span>DB2_I5_TXN_READ_COMMITTED</span> - Dirty reads are not possible.           Nonrepeatable reads, and phantoms are possible.          </p>          <p class="para">           <span>DB2_I5_TXN_REPEATABLE_READ</span> - Dirty reads and nonrepeatable           reads are not possible. Phantoms are possible.          </p>          <p class="para">           <span>DB2_I5_TXN_SERIALIZABLE</span> - Transactions are serializable.           Dirty reads, non-repeatable reads, and phantoms are not possible          </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">i5_query_optimize</span></dt>         <dd>          <p class="para">            <span>DB2_FIRST_IO</span> All queries are optimized with the goal of            returning the first page of output as fast as possible. This goal works well            when the output is controlled by a user who is most likely to cancel the query            after viewing the first page of output data. Queries coded with an            OPTIMIZE FOR nnn ROWS clause honor the goal specified by the clause.          </p>          <p class="para">           <span>DB2_ALL_IO</span> All queries are optimized with the goal of running           the entire query to completion in the shortest amount of elapsed time. This is a           good option when the output of a query is being written to a file or report, or           the interface is queuing the output data. Queries coded with an OPTIMIZE FOR nnn           ROWS clause honor the goal specified by the clause. This is the default.          </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">i5_dbcs_alloc</span></dt>         <dd>          <p class="para">           <span>DB2_I5_DBCS_ALLOC_ON</span> value turns on DB2 6X allocation scheme           for DBCS translation column size growth.          </p>          <p class="para">           <span>DB2_I5_DBCS_ALLOC_OFF</span> value turns off DB2 6X allocation scheme           for DBCS translation column size growth.           <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:             <p class="para">             The php.ini setting <span class="parameter" style="color:#3A95FF">ibm_db2.i5_dbcs_alloc</span>==0 or             <span>DB2_I5_DBCS_ALLOC_OFF</span> is the default, but may be overridden             with the <span class="parameter" style="color:#3A95FF">i5_dbcs_alloc</span> option.            </p>           </p></blockquote>           </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">i5_date_fmt</span></dt>         <dd>          <p class="para">           <span>DB2_I5_FMT_ISO</span> - The International Organization for Standardization           (ISO) date format yyyy-mm-dd is used. This is the default.          </p>          <p class="para">           <span>DB2_I5_FMT_USA</span> - The United States date format mm/dd/yyyy is used.          </p>          <p class="para">           <span>DB2_I5_FMT_EUR</span> - The European date format dd.mm.yyyy is used.          </p>          <p class="para">           <span>DB2_I5_FMT_JIS</span> - The Japanese Industrial Standard date format           yyyy-mm-dd is used.          </p>          <p class="para">           <span>DB2_I5_FMT_MDY</span> - The date format mm/dd/yyyy is used.          </p>          <p class="para">           <span>DB2_I5_FMT_DMY</span> - The date format dd/mm/yyyy is used.          </p>          <p class="para">           <span>DB2_I5_FMT_YMD</span> - The date format yy/mm/dd is used.          </p>          <p class="para">           <span>DB2_I5_FMT_JUL</span> - The Julian date format yy/ddd is used.          </p>          <p class="para">           <span>DB2_I5_FMT_JOB</span> - The job default is used.          </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">i5_date_sep</span></dt>         <dd>          <p class="para">           <span>DB2_I5_SEP_SLASH</span> - A slash ( / ) is used as the date separator.           This is the default.          </p>          <p class="para">           <span>DB2_I5_SEP_DASH</span> - A dash ( - ) is used as the date separator.          </p>          <p class="para">           <span>DB2_I5_SEP_PERIOD</span> - A period ( . ) is used as the date           separator.          </p>          <p class="para">           <span>DB2_I5_SEP_COMMA</span> - A comma ( , ) is used as the date separator.          </p>          <p class="para">           <span>DB2_I5_SEP_BLANK</span> - A blank is used as the date separator.          </p>          <p class="para">           <span>DB2_I5_SEP_JOB</span> - The job default is used          </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">i5_time_fmt</span></dt>         <dd>          <p class="para">           <span>DB2_I5_FMT_ISO</span> - The International Organization for           Standardization (ISO) time format hh.mm.ss is used. This is the default.          </p>          <p class="para">           <span>DB2_I5_FMT_USA</span> - The United States time format           hh:mmxx is used, where xx is AM or PM.          </p>          <p class="para">           <span>DB2_I5_FMT_EUR</span> - The European time format hh.mm.ss           is used.          </p>          <p class="para">           <span>DB2_I5_FMT_JIS</span> - The Japanese Industrial Standard           time format hh:mm:ss is used.          </p>          <p class="para">           <span>DB2_I5_FMT_HMS</span> - The hh:mm:ss format is used.          </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">i5_time_sep</span></dt>         <dd>          <p class="para">           <span>DB2_I5_SEP_COLON</span> - A colon ( : ) is used as the time           separator. This is the default.          </p>          <p class="para">           <span>DB2_I5_SEP_PERIOD</span> - A period ( . ) is used as the time           separator.          </p>          <p class="para">           <span>DB2_I5_SEP_COMMA</span> - A comma ( , ) is used as the time           separator.          </p>          <p class="para">           <span>DB2_I5_SEP_BLANK</span> - A blank is used as the time separator.          </p>          <p class="para">           <span>DB2_I5_SEP_JOB</span> - The job default is used.          </p>         </dd>                         <dt><span class="parameter" style="color:#3A95FF">i5_decimal_sep</span></dt>         <dd>          <p class="para">           <span>DB2_I5_SEP_PERIOD</span> - A period ( . ) is used as           the decimal separator. This is the default.          </p>          <p class="para">           <span>DB2_I5_SEP_COMMA</span> - A comma ( , ) is used as the           decimal separator.          </p>          <p class="para">           <span>DB2_I5_SEP_JOB</span> - The job default is used.          </p>         </dd>               </dl>      </p>      <p class="para">       The following new i5/OS option is available in ibm_db2 version 1.8.0       and later.       <dl>                 <dt><span class="parameter" style="color:#3A95FF">i5_libl</span></dt>         <dd>          <p class="para">           A character value that indicates the library list that will be used for           resolving unqualified file references. Specify the library list           elements separated by blanks &#039;i5_libl&#039;=&gt;&quot;MYLIB YOURLIB ANYLIB&quot;.           <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:             <p class="para">             i5_libl calls qsys2/qcmdexc(&#039;cmd&#039;,cmdlen), which is only available             in i5/OS V5R4 and later.            </p>           </p></blockquote>          </p>         </dd>               </dl>      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.db2-pconnect-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   Returns a connection handle resource if the connection attempt is   successful. <span class="function"><strong style="color:#CC7832">db2_pconnect()</strong></span> tries to reuse an existing   connection resource that exactly matches the   <span class="parameter" style="color:#3A95FF">database</span>, <span class="parameter" style="color:#3A95FF">username</span>, and   <span class="parameter" style="color:#3A95FF">password</span> parameters. If the connection attempt fails,   <span class="function"><strong style="color:#CC7832">db2_pconnect()</strong></span> returns <strong><span>false</span></strong>.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.db2-pconnect-changelog">  <h3 class="title">更新日志</h3>  <span>   <table class="doctable informaltable">         <thead>      <tr>       <th>版本</th>       <th>说明</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td>ibm_db2 1.9.0</td>       <td>        Active transactions within a persistent connection will be rolled back        at the end of each request.       </td>      </tr>      <tr>       <td>ibm_db2 1.8.0</td>       <td>        The <span class="parameter" style="color:#3A95FF">i5_libl</span> option is available for i5/OS        users.       </td>      </tr>      <tr>       <td>ibm_db2 1.7.0</td>       <td>        The <span class="parameter" style="color:#3A95FF">trustedcontext</span> option is available.       </td>      </tr>      <tr>       <td>ibm_db2 1.5.1</td>       <td>        The <span class="parameter" style="color:#3A95FF">i5_lib</span>, <span class="parameter" style="color:#3A95FF">i5_naming</span>,        <span class="parameter" style="color:#3A95FF">i5_commit</span>,        <span class="parameter" style="color:#3A95FF">i5_query_optimize</span>,        <span class="parameter" style="color:#3A95FF">i5_dbcs_alloc</span>,        <span class="parameter" style="color:#3A95FF">i5_date_fmt</span>,        <span class="parameter" style="color:#3A95FF">i5_date_sep</span>,        <span class="parameter" style="color:#3A95FF">i5_time_fmt</span>, <span class="parameter" style="color:#3A95FF">i5_time_sep</span>        and <span class="parameter" style="color:#3A95FF">i5_decimal_sep</span> options are available for        i5/OS users.       </td>      </tr>     </tbody>       </table>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.db2-pconnect-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="example-3851">    <p><strong>示例 #1 A <span class="function"><strong style="color:#CC7832">db2_pconnect()</strong></span> example</strong></p>    <div class="example-contents"><p>     In the following example, the first call to     <span class="function"><strong style="color:#CC7832">db2_pconnect()</strong></span> returns a new persistent connection     resource. The second call to <span class="function"><strong style="color:#CC7832">db2_pconnect()</strong></span> returns     a persistent connection resource that simply reuses the first persistent     connection resource.    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$database </span><span style="color: #007700">= </span><span style="color: #DD0000">'SAMPLE'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$user </span><span style="color: #007700">= </span><span style="color: #DD0000">'db2inst1'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$password </span><span style="color: #007700">= </span><span style="color: #DD0000">'ibmdb2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$pconn </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_pconnect</span><span style="color: #007700">(</span><span style="color: #9876AA">$database</span><span style="color: #007700">, </span><span style="color: #9876AA">$user</span><span style="color: #007700">, </span><span style="color: #9876AA">$password</span><span style="color: #007700">);<br /><br />if (</span><span style="color: #9876AA">$pconn</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"Persistent connection succeeded."</span><span style="color: #007700">;<br />}<br />else {<br />    echo </span><span style="color: #DD0000">"Persistent connection failed."</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #9876AA">$pconn2 </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_pconnect</span><span style="color: #007700">(</span><span style="color: #9876AA">$database</span><span style="color: #007700">, </span><span style="color: #9876AA">$user</span><span style="color: #007700">, </span><span style="color: #9876AA">$password</span><span style="color: #007700">);<br />if (</span><span style="color: #9876AA">$pconn</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"Second persistent connection succeeded."</span><span style="color: #007700">;<br />}<br />else {<br />    echo </span><span style="color: #DD0000">"Second persistent connection failed."</span><span style="color: #007700">;<br />}<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例会输出：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>Persistent connection succeeded.<br>Second persistent connection succeeded.<br></span></div>    </div>   </div>   <div class="example" id="example-3854">    <p><strong>示例 #2 Using trusted context</strong></p>    <div class="example-contents"><p>     The following example shows how to enable trusted context, switch     users, and get the current user ID.    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$database </span><span style="color: #007700">= </span><span style="color: #DD0000">"SAMPLE"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$hostname </span><span style="color: #007700">= </span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$port </span><span style="color: #007700">= </span><span style="color: #9876AA">50000</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$authID </span><span style="color: #007700">= </span><span style="color: #DD0000">"db2inst1"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$auth_pass </span><span style="color: #007700">= </span><span style="color: #DD0000">"ibmdb2"</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$tc_user </span><span style="color: #007700">= </span><span style="color: #DD0000">"tcuser"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$tc_pass </span><span style="color: #007700">= </span><span style="color: #DD0000">"tcpassword"</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$dsn </span><span style="color: #007700">= </span><span style="color: #DD0000">"DATABASE=</span><span style="color: #9876AA">$database</span><span style="color: #DD0000">;HOSTNAME=</span><span style="color: #9876AA">$hostname</span><span style="color: #DD0000">;PORT=</span><span style="color: #9876AA">$port</span><span style="color: #DD0000">;<br />  PROTOCOL=TCPIP;UID=</span><span style="color: #9876AA">$authID</span><span style="color: #DD0000">;PWD=</span><span style="color: #9876AA">$auth_pass</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$options </span><span style="color: #007700">= array (</span><span style="color: #DD0000">"trustedcontext" </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">DB2_TRUSTED_CONTEXT_ENABLE</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$tc_conn </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_pconnect</span><span style="color: #007700">(</span><span style="color: #9876AA">$dsn</span><span style="color: #007700">, </span><span style="color: #DD0000">""</span><span style="color: #007700">, </span><span style="color: #DD0000">""</span><span style="color: #007700">, </span><span style="color: #9876AA">$options</span><span style="color: #007700">);<br />if(</span><span style="color: #9876AA">$tc_conn</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"Explicit trusted connection succeeded.\n"</span><span style="color: #007700">;<br /><br />    if(</span><span style="color: #9876AA">db2_get_option</span><span style="color: #007700">(</span><span style="color: #9876AA">$tc_conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"trustedcontext"</span><span style="color: #007700">)) {<br />        </span><span style="color: #9876AA">$userBefore </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_get_option</span><span style="color: #007700">(</span><span style="color: #9876AA">$tc_conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"trusted_user"</span><span style="color: #007700">);<br /><br />        </span><span style="color: #FF8000">//Do some work as user 1.<br /><br />        //Switching to trusted user.<br />        </span><span style="color: #9876AA">$parameters </span><span style="color: #007700">= array(</span><span style="color: #DD0000">"trusted_user" </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">$tc_user</span><span style="color: #007700">,<br />          </span><span style="color: #DD0000">"trusted_password" </span><span style="color: #007700">=&gt; </span><span style="color: #9876AA">$tcuser_pass</span><span style="color: #007700">);<br />        </span><span style="color: #9876AA">$res </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_set_option </span><span style="color: #007700">(</span><span style="color: #9876AA">$tc_conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$parameters</span><span style="color: #007700">, </span><span style="color: #9876AA">1</span><span style="color: #007700">);<br /><br />        </span><span style="color: #9876AA">$userAfter </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_get_option</span><span style="color: #007700">(</span><span style="color: #9876AA">$tc_conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"trusted_user"</span><span style="color: #007700">);<br />        </span><span style="color: #FF8000">//Do more work as trusted user.<br /><br />        </span><span style="color: #007700">if(</span><span style="color: #9876AA">$userBefore </span><span style="color: #007700">!= </span><span style="color: #9876AA">$userAfter</span><span style="color: #007700">) {<br />            echo </span><span style="color: #DD0000">"User has been switched." </span><span style="color: #007700">. </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />        }<br />    }<br /><br />    </span><span style="color: #9876AA">db2_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$tc_conn</span><span style="color: #007700">);<br />}<br />else {<br />    echo </span><span style="color: #DD0000">"Explicit trusted connection failed.\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例会输出：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>Explicit trusted connection succeeded.<br>User has been switched.<br></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.db2-pconnect-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link db2_connect()} - Returns a connection to a database</span></li>   </ul>  </span> </div></div>