<div id="function.db2-prepare" class="refentry"> <div class="refnamediv">  <h1 class="refname">db2_prepare</h1>  <p class="verinfo">(PECL ibm_db2 &gt;= 1.0.0)</p><p class="refpurpose"><span class="refname">db2_prepare</span> &mdash; <span class="dc-title">   Prepares an SQL statement to be executed  </span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.db2-prepare-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>db2_prepare</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">resource</span> <span class="parameter" style="color:#3A95FF">$connection</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$statement</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">array</span> <span class="parameter" style="color:#3A95FF">$options</span><span class="initializer"> = []</span></span>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">resource</span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   <span class="function"><strong style="color:#CC7832">db2_prepare()</strong></span> creates a prepared SQL statement which can   include 0 or more parameter markers (<span>?</span> characters)   representing parameters for input, output, or input/output. You can pass   parameters to the prepared statement using   <span class="function">{@link db2_bind_param()}</span>, or for input values only, as an array   passed to <span class="function">{@link db2_execute()}</span>.  </p>  <p class="para">   There are three main advantages to using prepared statements in your   application:   <ul class="itemizedlist">    <li class="listitem">     <p class="para">      <em>Performance</em>: when you prepare a statement, the      database server creates an optimized access plan for retrieving data with      that statement. Subsequently issuing the prepared statement with      <span class="function">{@link db2_execute()}</span> enables the statements to reuse that      access plan and avoids the overhead of dynamically creating a new access      plan for every statement you issue.     </p>    </li>    <li class="listitem">     <p class="para">      <em>Security</em>: when you prepare a statement, you can      include parameter markers for input values. When you execute a prepared      statement with input values for placeholders, the database server checks      each input value to ensure that the type matches the column definition or      parameter definition.     </p>    </li>    <li class="listitem">     <p class="para">      <em>Advanced functionality</em>: Parameter markers not only      enable you to pass input values to prepared SQL statements, they also      enable you to retrieve OUT and INOUT parameters from stored procedures      using <span class="function">{@link db2_bind_param()}</span>.     </p>    </li>   </ul>  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.db2-prepare-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">connection</span></dt>     <dd>      <p class="para">       A valid database connection resource variable as returned from       <span class="function">{@link db2_connect()}</span> or <span class="function">{@link db2_pconnect()}</span>.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">statement</span></dt>     <dd>      <p class="para">       An SQL statement, optionally containing one or more parameter markers..      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">options</span></dt>     <dd>      <p class="para">       An associative array containing statement options. You can use this       parameter to request a scrollable cursor on database servers that       support this functionality.      </p>      <p class="para">       For a description of valid statement options, see        <span class="function">{@link db2_set_option()}</span>.      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.db2-prepare-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   Returns a statement resource if the SQL statement was successfully parsed and   prepared by the database server. Returns <strong><span>false</span></strong> if the database server   returned an error. You can determine which error was returned by calling   <span class="function">{@link db2_stmt_error()}</span> or <span class="function">{@link db2_stmt_errormsg()}</span>.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.db2-prepare-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="example-3857">    <p><strong>示例 #1 Preparing and executing an SQL statement with parameter markers</strong></p>    <div class="example-contents"><p>     The following example prepares an INSERT statement that accepts four     parameter markers, then iterates over an array of arrays containing the     input values to be passed to <span class="function">{@link db2_execute()}</span>.    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$animals </span><span style="color: #007700">= array(<br />    array(</span><span style="color: #9876AA">0</span><span style="color: #007700">, </span><span style="color: #DD0000">'cat'</span><span style="color: #007700">, </span><span style="color: #DD0000">'Pook'</span><span style="color: #007700">, </span><span style="color: #9876AA">3.2</span><span style="color: #007700">),<br />    array(</span><span style="color: #9876AA">1</span><span style="color: #007700">, </span><span style="color: #DD0000">'dog'</span><span style="color: #007700">, </span><span style="color: #DD0000">'Peaches'</span><span style="color: #007700">, </span><span style="color: #9876AA">12.3</span><span style="color: #007700">),<br />    array(</span><span style="color: #9876AA">2</span><span style="color: #007700">, </span><span style="color: #DD0000">'horse'</span><span style="color: #007700">, </span><span style="color: #DD0000">'Smarty'</span><span style="color: #007700">, </span><span style="color: #9876AA">350.0</span><span style="color: #007700">),<br />);<br /><br /></span><span style="color: #9876AA">$insert </span><span style="color: #007700">= </span><span style="color: #DD0000">'INSERT INTO animals (id, breed, name, weight)<br />    VALUES (?, ?, ?, ?)'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$stmt </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_prepare</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$insert</span><span style="color: #007700">);<br />if (</span><span style="color: #9876AA">$stmt</span><span style="color: #007700">) {<br />    foreach (</span><span style="color: #9876AA">$animals </span><span style="color: #007700">as </span><span style="color: #9876AA">$animal</span><span style="color: #007700">) {<br />        </span><span style="color: #9876AA">$result </span><span style="color: #007700">= </span><span style="color: #9876AA">db2_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stmt</span><span style="color: #007700">, </span><span style="color: #9876AA">$animal</span><span style="color: #007700">);<br />    }<br />}<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>     </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.db2-prepare-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link db2_bind_param()} - Binds a PHP variable to an SQL statement parameter</span></li>    <li class="member"><span class="function">{@link db2_execute()} - Executes a prepared SQL statement</span></li>    <li class="member"><span class="function">{@link db2_stmt_error()} - Returns a string containing the SQLSTATE returned by an SQL statement</span></li>    <li class="member"><span class="function">{@link db2_stmt_errormsg()} - Returns a string containing the last SQL statement error message</span></li>   </ul>  </span> </div></div>