<div id="function.oci-fetch-array" class="refentry"> <div class="refnamediv">  <h1 class="refname">oci_fetch_array</h1>  <p class="verinfo">(PHP 5, PHP 7, PHP 8, PECL OCI8 &gt;= 1.1.0)</p><p class="refpurpose"><span class="refname">oci_fetch_array</span> &mdash; <span class="dc-title">Returns the next row from a query as an associative or numeric array  </span></p> </div>  <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.oci-fetch-array-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>oci_fetch_array</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">resource</span> <span class="parameter" style="color:#3A95FF">$statement</span></span>, <span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$mode</span><span class="initializer"> = OCI_BOTH | OCI_RETURN_NULLS</span></span>): <span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">array</span>|<span class="type" style="color:#EAB766"><span class="type false" style="color:#EAB766">false</span></span></span></div>  <p class="para rdfs-comment">   Returns an array containing the next result-set row of a query.   Each array entry corresponds to a column of the row.  This function   is typically called in a loop until it returns <strong><span>false</span></strong>, indicating   no more rows exist.  </p>  <p class="para">   If <span class="parameter" style="color:#3A95FF">statement</span> corresponds to a PL/SQL block   returning Oracle Database Implicit Result Sets, then rows from   all sets are consecutively fetched. If   <span class="parameter" style="color:#3A95FF">statement</span> is returned   by <span class="function">{@link oci_get_implicit_resultset()}</span>, then only the   subset of rows for one child query are returned.  </p>  <p class="para">要获取 OCI8扩展进行数据类型映射的细节，请参见<a href="https://www.php.net/manual/zh/oci8.datatypes.php" class="link">驱动所支持的数据类型</a>。</p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.oci-fetch-array-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">statement</span></dt>     <dd>       <p class="para">有效的 OCI8 报表标识符由 <span class="function">{@link oci_parse()}</span> 创建，被 <span class="function">{@link oci_execute()}</span>或 <span>REF CURSOR</span> statement 标识执行。</p>       <p class="para">        Can also be a statement identifier returned by <span class="function">{@link oci_get_implicit_resultset()}</span>.       </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">mode</span></dt>     <dd>      <p class="para">       An optional second parameter can be any combination of the following       constants:       <table class="doctable table">        <caption><strong><span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> Modes</strong></caption>                 <thead>          <tr>           <th>Constant</th>           <th>Description</th>          </tr>         </thead>         <tbody class="tbody">          <tr>           <td><strong><span>OCI_BOTH</span></strong></td>           <td>Returns an array with both associative and numeric            indices. This is the same            as <strong><span>OCI_ASSOC</span></strong>            + <strong><span>OCI_NUM</span></strong> and is the default            behavior.</td>          </tr>          <tr>           <td><strong><span>OCI_ASSOC</span></strong></td>           <td>Returns an associative array.</td>          </tr>          <tr>           <td><strong><span>OCI_NUM</span></strong></td>           <td>Returns a numeric array.</td>          </tr>          <tr>           <td><strong><span>OCI_RETURN_NULLS</span></strong></td>           <td>Creates elements for <strong><span>null</span></strong> fields.  The element             values will be a PHP <strong><span>null</span></strong>.           </td>          </tr>          <tr>           <td><strong><span>OCI_RETURN_LOBS</span></strong></td>           <td>Returns the contents of LOBs instead of the LOB             descriptors.</td>          </tr>         </tbody>               </table>      </p>      <p class="para">       The default <span class="parameter" style="color:#3A95FF">mode</span> is <strong><span>OCI_BOTH</span></strong>.      </p>      <p class="para">       Use the addition operator &quot;+&quot; to specify more than       one mode at a time.      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.oci-fetch-array-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   Returns an array with associative and/or numeric indices. If there   are no more rows in the <span class="parameter" style="color:#3A95FF">statement</span> then   <strong><span>false</span></strong> is returned.  </p>  <p class="para">    By default, <span>LOB</span> columns are returned as LOB descriptors.  </p>  <p class="para">   <span>DATE</span> columns are returned as strings formatted   to the current date format.  The default format can be changed with   Oracle environment variables such as <span>NLS_LANG</span> or   by a previously executed <span>ALTER SESSION SET   NLS_DATE_FORMAT</span> command.  </p>  <p class="para">   Oracle&#039;s default, non-case sensitive column names will have   uppercase associative indices in the result array.  Case-sensitive   column names will have array indices using the exact column case.   Use <span class="function">{@link var_dump()}</span> on the result array to verify the   appropriate case to use for each query.   </p>  <p class="para">   The table name is not included in the array index.  If your query   contains two different columns with the same name,   use <strong><span>OCI_NUM</span></strong> or add a column alias to the query   to ensure name uniqueness, see example #7. Otherwise only one   column will be returned via PHP.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.oci-fetch-array-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="example-5543">    <p><strong>示例 #1 <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> with <strong><span>OCI_BOTH</span></strong></strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'SELECT department_id, department_name FROM departments'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br />while ((</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_BOTH</span><span style="color: #007700">)) != </span><span style="color: #9876AA">false</span><span style="color: #007700">) {<br />    </span><span style="color: #FF8000">// Use the uppercase column names for the associative array indices<br />    </span><span style="color: #007700">echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #9876AA">0</span><span style="color: #007700">] . </span><span style="color: #DD0000">" and " </span><span style="color: #007700">. </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'DEPARTMENT_ID'</span><span style="color: #007700">]   . </span><span style="color: #DD0000">" are the same&lt;br&gt;\n"</span><span style="color: #007700">;<br />    echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #9876AA">1</span><span style="color: #007700">] . </span><span style="color: #DD0000">" and " </span><span style="color: #007700">. </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'DEPARTMENT_NAME'</span><span style="color: #007700">] . </span><span style="color: #DD0000">" are the same&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span>  <p class="para">   <div class="example" id="example-5546">    <p><strong>示例 #2 <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> with <strong><span>OCI_NUM</span></strong></strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">//<br />  Before running, create the table:<br />      CREATE TABLE mytab (id NUMBER, description CLOB);<br />      INSERT INTO mytab (id, description) values (1, 'A very long string');<br />      COMMIT;<br /><br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'SELECT id, description FROM mytab'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br />while ((</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_NUM</span><span style="color: #007700">)) != </span><span style="color: #9876AA">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #9876AA">0</span><span style="color: #007700">] . </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />    echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #9876AA">1</span><span style="color: #007700">]-&gt;</span><span style="color: #9876AA">read</span><span style="color: #007700">(</span><span style="color: #9876AA">11</span><span style="color: #007700">) . </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">; </span><span style="color: #FF8000">// this will output first 11 bytes from DESCRIPTION<br /></span><span style="color: #007700">}<br /><br /></span><span style="color: #FF8000">// Output is:<br />//    1<br />//    A very long<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="example-5549">    <p><strong>示例 #3 <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> with <strong><span>OCI_ASSOC</span></strong></strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">//<br />  Before running, create the table:<br />      CREATE TABLE mytab (id NUMBER, description CLOB);<br />      INSERT INTO mytab (id, description) values (1, 'A very long string');<br />      COMMIT;<br /><br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'SELECT id, description FROM mytab'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br />while ((</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">)) != </span><span style="color: #9876AA">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'ID'</span><span style="color: #007700">] . </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />    echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'DESCRIPTION'</span><span style="color: #007700">]-&gt;</span><span style="color: #9876AA">read</span><span style="color: #007700">(</span><span style="color: #9876AA">11</span><span style="color: #007700">) . </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">; </span><span style="color: #FF8000">// this will output first 11 bytes from DESCRIPTION<br /></span><span style="color: #007700">}<br /><br /></span><span style="color: #FF8000">// Output is:<br />//    1<br />//    A very long<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="domdocument.replacechildren.example.basic">    <p><strong>示例 #4 <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> with <strong><span>OCI_RETURN_NULLS</span></strong></strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'SELECT 1, null FROM dual'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br />while ((</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array </span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">)) != </span><span style="color: #9876AA">false</span><span style="color: #007700">) { </span><span style="color: #FF8000">// Ignore NULLs<br />    </span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$row</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">//<br />The above code prints:<br />  array(1) {<br />    [1]=&gt;<br />    string(1) "1"<br />  }<br /><br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'SELECT 1, null FROM dual'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br />while ((</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array </span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #9876AA">OCI_RETURN_NULLS</span><span style="color: #007700">)) != </span><span style="color: #9876AA">false</span><span style="color: #007700">) { </span><span style="color: #FF8000">// Fetch NULLs<br />    </span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$row</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">//<br />The above code prints:<br />  array(2) {<br />    [1]=&gt;<br />    string(1) "1"<br />    ["NULL"]=&gt;<br />    NULL<br />  }<br /><br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="example-5555">    <p><strong>示例 #5 <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> with <strong><span>OCI_RETURN_LOBS</span></strong></strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">//<br />  Before running, create the table:<br />      CREATE TABLE mytab (id NUMBER, description CLOB);<br />      INSERT INTO mytab (id, description) values (1, 'A very long string');<br />      COMMIT;<br /><br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'SELECT id, description FROM mytab'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br />while ((</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #9876AA">OCI_RETURN_LOBS</span><span style="color: #007700">)) != </span><span style="color: #9876AA">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'ID'</span><span style="color: #007700">] . </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />    echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'DESCRIPTION'</span><span style="color: #007700">] . </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">; </span><span style="color: #FF8000">// this contains all of DESCRIPTION<br />    // In a loop, freeing the large variable before the 2nd fetch reduces PHP's peak memory usage<br />    </span><span style="color: #007700">unset(</span><span style="color: #9876AA">$row</span><span style="color: #007700">); <br />}<br /><br /></span><span style="color: #FF8000">// Output is:<br />//    1<br />//    A very long string<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="example-5558">    <p><strong>示例 #6 <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> with case sensitive column names</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">//<br />   Before running, create the table:<br />      CREATE TABLE mytab ("Name" VARCHAR2(20), city VARCHAR2(20));<br />      INSERT INTO mytab ("Name", city) values ('Chris', 'Melbourne');<br />      COMMIT;<br /><br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'select * from mytab'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #9876AA">OCI_RETURN_NULLS</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Because 'Name' was created as a case-sensitive column, that same<br />// case is used for the array index.  However uppercase 'CITY' must<br />// be used for the case-insensitive column index<br /></span><span style="color: #007700">print </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'Name'</span><span style="color: #007700">] . </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;   </span><span style="color: #FF8000">//  prints Chris<br /></span><span style="color: #007700">print </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'CITY'</span><span style="color: #007700">] . </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;   </span><span style="color: #FF8000">//  prints Melbourne<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="domdocumentfragment.prepend.example.basic">    <p><strong>示例 #7 <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> with columns having duplicate names</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br /></span><span style="color: #FF8000">//<br />  Before running, create the tables:<br />      CREATE TABLE mycity (id NUMBER, name VARCHAR2(20));<br />      INSERT INTO mycity (id, name) values (1, 'Melbourne');<br />      CREATE TABLE mycountry (id NUMBER, name VARCHAR2(20));<br />      INSERT INTO mycountry (id, name) values (1, 'Australia');<br />      COMMIT;<br /><br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT mycity.name, mycountry.name<br />        FROM mycity, mycountry<br />        WHERE mycity.id = mycountry.id'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$row</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Output only contains one "NAME" entry:<br />//    array(1) {<br />//      ["NAME"]=&gt;<br />//      string(9) "Australia"<br />//    }<br /><br />// To query a repeated column name, use an SQL column alias like "AS ctnm":<br /></span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT mycity.name AS ctnm, mycountry.name <br />        FROM mycity, mycountry <br />        WHERE mycity.id = mycountry.id'</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$row</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Output now contains both columns selected:<br />//    array(2) {<br />//      ["CTNM"]=&gt;<br />//      string(9) "Melbourne"<br />//      ["NAME"]=&gt;<br />//      string(9) "Australia"<br />//    }<br /><br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="domelement.append.example.basic">    <p><strong>示例 #8 <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> with <span>DATE</span> columns</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">// Set the date format for this connection.<br />// For performance reasons, consider changing the format<br />// in a trigger or with environment variables instead<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">"ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD'"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'SELECT hire_date FROM employees WHERE employee_id = 188'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">);<br />echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'HIRE_DATE'</span><span style="color: #007700">] . </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;  </span><span style="color: #FF8000">// prints 1997-06-14<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="example-5567">    <p><strong>示例 #9 <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> with <span>REF CURSOR</span></strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">//<br />  Create the PL/SQL stored procedure as:<br /><br />  CREATE OR REPLACE PROCEDURE myproc(p1 OUT SYS_REFCURSOR) AS<br />  BEGIN<br />    OPEN p1 FOR SELECT * FROM all_objects WHERE ROWNUM &lt; 5000;<br />  END;<br /><br /><br /></span><span style="color: #9876AA">$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'BEGIN myproc(:rc); END;'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$refcur </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_new_cursor</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':rc'</span><span style="color: #007700">, </span><span style="color: #9876AA">$refcur</span><span style="color: #007700">, -</span><span style="color: #9876AA">1</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_B_CURSOR</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Execute the returned REF CURSOR and fetch from it like a statement identifier<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$refcur</span><span style="color: #007700">);  <br />echo </span><span style="color: #DD0000">"&lt;table border='1'&gt;\n"</span><span style="color: #007700">;<br />while ((</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$refcur</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #9876AA">OCI_RETURN_NULLS</span><span style="color: #007700">)) != </span><span style="color: #9876AA">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"&lt;tr&gt;\n"</span><span style="color: #007700">;<br />    foreach (</span><span style="color: #9876AA">$row </span><span style="color: #007700">as </span><span style="color: #9876AA">$item</span><span style="color: #007700">) {<br />        echo </span><span style="color: #DD0000">"    &lt;td&gt;"</span><span style="color: #007700">.(</span><span style="color: #9876AA">$item </span><span style="color: #007700">!== </span><span style="color: #9876AA">null </span><span style="color: #007700">? </span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$item</span><span style="color: #007700">, </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">) : </span><span style="color: #DD0000">"&amp;nbsp;"</span><span style="color: #007700">).</span><span style="color: #DD0000">"&lt;/td&gt;\n"</span><span style="color: #007700">;<br />    }<br />    echo </span><span style="color: #DD0000">"&lt;/tr&gt;\n"</span><span style="color: #007700">;<br />}<br />echo </span><span style="color: #DD0000">"&lt;/table&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$refcur</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="domelement.prepend.example.basic">    <p><strong>示例 #10 Pagination with <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> using a <span>LIMIT</span>-like query</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">// Find the version of the database<br /></span><span style="color: #9876AA">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/Release ([0-9]+)\./'</span><span style="color: #007700">, </span><span style="color: #9876AA">oci_server_version</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">), </span><span style="color: #9876AA">$matches</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$oracleversion </span><span style="color: #007700">= </span><span style="color: #9876AA">$matches</span><span style="color: #007700">[</span><span style="color: #9876AA">1</span><span style="color: #007700">];<br /><br /></span><span style="color: #FF8000">// This is the query you want to "page" through<br /></span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT city, postal_code FROM locations ORDER BY city'</span><span style="color: #007700">;<br /><br />if (</span><span style="color: #9876AA">$oracleversion </span><span style="color: #007700">&gt;= </span><span style="color: #9876AA">12</span><span style="color: #007700">) {<br />    </span><span style="color: #FF8000">// Make use of Oracle 12c OFFSET / FETCH NEXT syntax<br />    </span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #9876AA">$sql </span><span style="color: #007700">. </span><span style="color: #DD0000">' OFFSET :offset ROWS FETCH NEXT :numrows ROWS ONLY'</span><span style="color: #007700">;<br />} else {<br />    </span><span style="color: #FF8000">// Older Oracle versions need a nested query selecting a subset<br />    // from $sql.  Or, if the SQL statement is known at development<br />    // time, consider using a row_number() function instead of this<br />    // nested solution.  In production environments, be careful to<br />    // avoid SQL Injection issues with concatenation.<br />    </span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">"SELECT * FROM (SELECT a.*, ROWNUM AS my_rnum<br />                           FROM (</span><span style="color: #9876AA">$sql</span><span style="color: #DD0000">) a<br />                           WHERE ROWNUM &lt;= :offset + :numrows)<br />            WHERE my_rnum &gt; :offset"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #9876AA">$offset  </span><span style="color: #007700">= </span><span style="color: #9876AA">0</span><span style="color: #007700">;  </span><span style="color: #FF8000">// skip this many rows<br /></span><span style="color: #9876AA">$numrows </span><span style="color: #007700">= </span><span style="color: #9876AA">5</span><span style="color: #007700">;  </span><span style="color: #FF8000">// return 5 rows<br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':numrows'</span><span style="color: #007700">, </span><span style="color: #9876AA">$numrows</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #DD0000">':offset'</span><span style="color: #007700">, </span><span style="color: #9876AA">$offset</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br />while ((</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC </span><span style="color: #007700">+ </span><span style="color: #9876AA">OCI_RETURN_NULLS</span><span style="color: #007700">)) != </span><span style="color: #9876AA">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'CITY'</span><span style="color: #007700">] . </span><span style="color: #DD0000">" " </span><span style="color: #007700">. </span><span style="color: #9876AA">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'POSTAL_CODE'</span><span style="color: #007700">] . </span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">// Output is:<br />//    Beijing 190518<br />//    Bern 3095<br />//    Bombay 490231<br />//    Geneva 1730<br />//    Hiroshima 6823<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p>  <p class="para">   <div class="example" id="domelement.replacewith.example.basic">    <p><strong>示例 #11 <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span> with Oracle Database Implicit Result Sets</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /><br />$conn </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">, </span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">, </span><span style="color: #DD0000">'localhost/pdborcl'</span><span style="color: #007700">);<br />if (!</span><span style="color: #9876AA">$conn</span><span style="color: #007700">) {<br />    </span><span style="color: #9876AA">$e </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_error</span><span style="color: #007700">();<br />    </span><span style="color: #9876AA">trigger_error</span><span style="color: #007700">(</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">'message'</span><span style="color: #007700">], </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">), </span><span style="color: #9876AA">E_USER_ERROR</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">// Requires OCI8 2.0 (or later) and Oracle Database 12c (or later)<br />// Also see oci_get_implicit_resultset()<br /></span><span style="color: #9876AA">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'DECLARE<br />           c1 SYS_REFCURSOR;<br />        BEGIN<br />           OPEN c1 FOR SELECT city, postal_code FROM locations WHERE ROWNUM &lt; 4 ORDER BY city;<br />           DBMS_SQL.RETURN_RESULT(c1);<br />           OPEN c1 FOR SELECT country_id FROM locations WHERE ROWNUM &lt; 4 ORDER BY city;<br />           DBMS_SQL.RETURN_RESULT(c1);<br />        END;'</span><span style="color: #007700">;<br /><br /></span><span style="color: #9876AA">$stid </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_parse</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">, </span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_execute</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Note: oci_fetch_all and oci_fetch() cannot be used in this manner<br /></span><span style="color: #007700">echo </span><span style="color: #DD0000">"&lt;table&gt;\n"</span><span style="color: #007700">;<br />while ((</span><span style="color: #9876AA">$row </span><span style="color: #007700">= </span><span style="color: #9876AA">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">, </span><span style="color: #9876AA">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #9876AA">OCI_RETURN_NULLS</span><span style="color: #007700">)) != </span><span style="color: #9876AA">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"&lt;tr&gt;\n"</span><span style="color: #007700">;<br />    foreach (</span><span style="color: #9876AA">$row </span><span style="color: #007700">as </span><span style="color: #9876AA">$item</span><span style="color: #007700">) {<br />        echo </span><span style="color: #DD0000">"  &lt;td&gt;"</span><span style="color: #007700">.(</span><span style="color: #9876AA">$item</span><span style="color: #007700">!==</span><span style="color: #9876AA">null</span><span style="color: #007700">?</span><span style="color: #9876AA">htmlentities</span><span style="color: #007700">(</span><span style="color: #9876AA">$item</span><span style="color: #007700">, </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">|</span><span style="color: #9876AA">ENT_SUBSTITUTE</span><span style="color: #007700">):</span><span style="color: #DD0000">"&amp;nbsp;"</span><span style="color: #007700">).</span><span style="color: #DD0000">"&lt;/td&gt;\n"</span><span style="color: #007700">;<br />    }<br />    echo </span><span style="color: #DD0000">"&lt;/tr&gt;\n"</span><span style="color: #007700">;<br />}<br />echo </span><span style="color: #DD0000">"&lt;/table&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// Output is:<br />//    Beijing 190518<br />//    Bern    3095<br />//    Bombay  490231<br />//    CN<br />//    CH<br />//    IN<br /><br /></span><span style="color: #9876AA">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #9876AA">$stid</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">oci_close</span><span style="color: #007700">(</span><span style="color: #9876AA">$conn</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 notes" id="refsect1-function.oci-fetch-array-notes">  <h3 class="title">注释</h3>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    Associative array indices need to be in uppercase for standard    Oracle columns that were created with case insensitive names.   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">查询返回巨大数量的数据行时，通过增大<a href="https://www.php.net/manual/zh/oci8.configuration.php#ini.oci8.default-prefetch" class="link">oci8.default_prefetch</a>值或使用 <span class="function">{@link oci_set_prefetch()}</span> 可显著提高性能。</p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    The function <span class="function"><strong style="color:#CC7832">oci_fetch_array()</strong></span>    is <em>insignificantly</em> slower than    <span class="function">{@link oci_fetch_assoc()}</span>    or <span class="function">{@link oci_fetch_row()}</span>, but is more flexible.   </p>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.oci-fetch-array-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link oci_fetch()} - 从查询中读取下一行到内部缓冲区</span></li>    <li class="member"><span class="function">{@link oci_fetch_all()} - 从查询中读取多行到二维数组中</span></li>    <li class="member"><span class="function">{@link oci_fetch_assoc()} - Returns the next row from a query as an associative array</span></li>    <li class="member"><span class="function">{@link oci_fetch_object()} - Returns the next row from a query as an object</span></li>    <li class="member"><span class="function">{@link oci_fetch_row()} - Returns the next row from a query as a numeric array</span></li>    <li class="member"><span class="function">{@link oci_set_prefetch()} - 设置查询预读取的行数</span></li>   </ul>  </span> </div></div>