<div id="function.com-message-pump" class="refentry"> <div class="refnamediv">  <h1 class="refname">com_message_pump</h1>  <p class="verinfo">(PHP 4 &gt;= 4.2.0, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">com_message_pump</span> &mdash; <span class="dc-title">Process COM messages, sleeping for up to timeoutms milliseconds</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.com-message-pump-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>com_message_pump</strong></span>(<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$timeout_milliseconds</span><span class="initializer"> = 0</span></span>): <span class="type" style="color:#EAB766">bool</span></div>  <p class="para rdfs-comment">   This function will sleep for up to <span class="parameter" style="color:#3A95FF">timeout_milliseconds</span>   milliseconds, or until a message arrives in the queue.  </p>  <p class="para">   The purpose of this function is to route COM calls between apartments and   handle various synchronization issues.  This allows your script to wait   efficiently for events to be triggered, while still handling other events   or running other code in the background.  You should use it in a loop, as   demonstrated by the example in the <span class="function">{@link com_event_sink()}</span>   function, until you are finished using event bound COM objects.  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.com-message-pump-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">timeout_milliseconds</span></dt>     <dd>      <p class="para">       The timeout, in milliseconds.      </p>      <p class="para">       If you do not specify a value for <span class="parameter" style="color:#3A95FF">timeout_milliseconds</span>,       then 0 will be assumed.  A 0 value means that no waiting will be       performed; if there are messages pending they will be dispatched as       before; if there are no messages pending, the function will return       <strong><span>false</span></strong> immediately without sleeping.      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.com-message-pump-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   If a message or messages arrives before the timeout, they will be   dispatched, and the function will return <strong><span>true</span></strong>. If the timeout occurs and   no messages were processed, the return value will be <strong><span>false</span></strong>.  </p> </div></div>