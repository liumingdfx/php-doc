<div id="pdo.pgsqllobcreate" class="refentry"> <div class="refnamediv">  <h1 class="refname">PDO::pgsqlLOBCreate</h1>  <p class="verinfo">(PHP 5 &gt;= 5.1.2, PHP 7, PHP 8, PECL pdo_pgsql &gt;= 1.0.2)</p><p class="refpurpose"><span class="refname">PDO::pgsqlLOBCreate</span> &mdash; <span class="dc-title">Creates a new large object</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-pdo.pgsqllobcreate-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><strong>PDO::pgsqlLOBCreate</strong></span>(): <span class="type" style="color:#EAB766">string</span></div>  <p class="para rdfs-comment">   <span class="function"><strong style="color:#CC7832">PDO::pgsqlLOBCreate()</strong></span> creates a large object and   returns the OID of that object.  You may then open a stream on the object   using <span class="function">{@link PDO::pgsqlLOBOpen()}</span> to read or write data to   it.  The OID can be stored in columns of type OID and be used to reference   the large object, without causing the row to grow arbitrarily large.   The large object will continue to live in the database until it   is removed by calling <span class="function">{@link PDO::pgsqlLOBUnlink()}</span>.  </p>  <p class="para">   Large objects can be up to 2GB in size, but are cumbersome to use; you need   to ensure that <span class="function">{@link PDO::pgsqlLOBUnlink()}</span> is called prior   to deleting the last row that references its OID from your database.   In addition, large objects have no access controls.  As an alternative,   try the bytea column type; recent versions of PostgreSQL allow bytea   columns of up to 1GB in size and transparently manage the storage for   optimal row size.  </p>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <span class="simpara">    This function must be called within a transaction.   </span>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-pdo.pgsqllobcreate-parameters">  <h3 class="title">参数</h3>  <span>   <span class="function"><strong style="color:#CC7832">PDO::pgsqlLOBCreate()</strong></span> takes no parameters.  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-pdo.pgsqllobcreate-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   Returns the OID of the newly created large object on success, or <strong><span>false</span></strong>   on failure.  </p> </div>  <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-pdo.pgsqllobcreate-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="example-3332">    <p><strong>示例 #1 A <span class="function"><strong style="color:#CC7832">PDO::pgsqlLOBCreate()</strong></span> example</strong></p>    <div class="example-contents"><p>     This example creates a new large object and copies the contents     of a file into it.  The OID is then stored into a table.    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$db </span><span style="color: #007700">= new </span><span style="color: #9876AA">PDO</span><span style="color: #007700">(</span><span style="color: #DD0000">'pgsql:dbname=test host=localhost'</span><span style="color: #007700">, </span><span style="color: #9876AA">$user</span><span style="color: #007700">, </span><span style="color: #9876AA">$pass</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$db</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">setAttribute</span><span style="color: #007700">(</span><span style="color: #9876AA">PDO</span><span style="color: #007700">::</span><span style="color: #9876AA">ATTR_ERRMODE</span><span style="color: #007700">, </span><span style="color: #9876AA">PDO</span><span style="color: #007700">::</span><span style="color: #9876AA">ERRMODE_EXCEPTION</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$db</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">beginTransaction</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">$oid </span><span style="color: #007700">= </span><span style="color: #9876AA">$db</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">pgsqlLOBCreate</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">$stream </span><span style="color: #007700">= </span><span style="color: #9876AA">$db</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">pgsqlLOBOpen</span><span style="color: #007700">(</span><span style="color: #9876AA">$oid</span><span style="color: #007700">, </span><span style="color: #DD0000">'w'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$local </span><span style="color: #007700">= </span><span style="color: #9876AA">fopen</span><span style="color: #007700">(</span><span style="color: #9876AA">$filename</span><span style="color: #007700">, </span><span style="color: #DD0000">'rb'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">stream_copy_to_stream</span><span style="color: #007700">(</span><span style="color: #9876AA">$local</span><span style="color: #007700">, </span><span style="color: #9876AA">$stream</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$local </span><span style="color: #007700">= </span><span style="color: #9876AA">null</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$stream </span><span style="color: #007700">= </span><span style="color: #9876AA">null</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$stmt </span><span style="color: #007700">= </span><span style="color: #9876AA">$db</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"INSERT INTO BLOBS (ident, oid) VALUES (?, ?)"</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">execute</span><span style="color: #007700">(array(</span><span style="color: #9876AA">$some_id</span><span style="color: #007700">, </span><span style="color: #9876AA">$oid</span><span style="color: #007700">));<br /></span><span style="color: #9876AA">$db</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">commit</span><span style="color: #007700">();<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-pdo.pgsqllobcreate-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link PDO::pgsqlLOBOpen()} - Opens an existing large object stream</span></li>    <li class="member"><span class="function">{@link PDO::pgsqlLOBUnlink()} - Deletes the large object</span></li>    <li class="member"><span class="function">{@link pg_lo_create()} - 新建大对象</span></li>   </ul>  </span> </div></div>