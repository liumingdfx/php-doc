<div id="function.htmlspecialchars" class="refentry"> <div class="refnamediv">  <h1 class="refname">htmlspecialchars</h1>  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">htmlspecialchars</span> &mdash; <span class="dc-title">将特殊字符转换为 HTML 实体</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.htmlspecialchars-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>htmlspecialchars</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$string</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$flags</span><span class="initializer"> = ENT_QUOTES | ENT_SUBSTITUTE | ENT_HTML401</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">?</span><span class="type" style="color:#EAB766"><span class="type" style="color:#EAB766">string</span><span class="type" style="color:#EAB766"></span></span> <span class="parameter" style="color:#3A95FF">$encoding</span><span class="initializer"> = <strong><span>null</span></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">bool</span> <span class="parameter" style="color:#3A95FF">$double_encode</span><span class="initializer"> = <strong><span>true</span></strong></span></span><br>): <span class="type" style="color:#EAB766">string</span></div>  <p class="para rdfs-comment">   某类字符在 HTML 中有特殊用处，如需保持原意，需要用 HTML 实体来表达。   本函数会返回字符转义后的表达。   如需转换子字符串中所有关联的名称实体，使用 <span class="function">{@link htmlentities()}</span> 代替本函数。  </p>  <p class="para">   如果传入字符的字符编码和最终的文档是一致的，则用函数处理的输入适合绝大多数 HTML 文档环境。   然而，如果输入的字符编码和最终包含字符的文档是不一样的，   想要保留字符（以数字或名称实体的形式），本函数以及 <span class="function">{@link htmlentities()}</span>    （仅编码名称实体对应的子字符串）可能不够用。   这种情况可以使用 <span class="function">{@link mb_encode_numericentity()}</span> 代替。  </p>  <p class="para">   <table class="doctable table">    <caption><strong>执行转换</strong></caption>         <thead>      <tr>       <th>字符</th>       <th>替换后</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td><span>&amp;</span> (&amp; 符号)</td>       <td><span>&amp;amp;</span></td>      </tr>      <tr>       <td><span>&quot;</span> (双引号)</td>       <td><span>&amp;quot;</span>，除非设置了 <strong><span>ENT_NOQUOTES</span></strong></td>      </tr>      <tr>       <td><span>&#039;</span> (单引号)</td>       <td>         设置了 <strong><span>ENT_QUOTES</span></strong> 后，        <span>&amp;#039;</span>        (如果是 <strong><span>ENT_HTML401</span></strong>) ，或者 <span>&amp;apos;</span> (如果是        <strong><span>ENT_XML1</span></strong>、 <strong><span>ENT_XHTML</span></strong> 或        <strong><span>ENT_HTML5</span></strong>)。       </td>      </tr>      <tr>       <td><span>&lt;</span> (小于)</td>       <td><span>&amp;lt;</span></td>      </tr>      <tr>       <td><span>&gt;</span> (大于)</td>       <td><span>&amp;gt;</span></td>      </tr>     </tbody>       </table>  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.htmlspecialchars-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">string</span></dt>     <dd>      <p class="para">       待转换的 <span class="type" style="color:#EAB766">string</span>。      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">flags</span></dt>     <dd>      <p class="para">       位掩码，由以下某个或多个标记组成，设置转义处理细节、无效单元序列、文档类型。       默认是       <span>ENT_QUOTES | ENT_SUBSTITUTE | ENT_HTML401</span>。       <table class="doctable table">        <caption><strong>有效的 <span class="parameter" style="color:#3A95FF">flags</span> 常量</strong></caption>                 <thead>          <tr>           <th>常量名称</th>           <th>描述</th>          </tr>         </thead>         <tbody class="tbody">          <tr>           <td><strong><span>ENT_COMPAT</span></strong></td>           <td>会转换双引号，不转换单引号。</td>          </tr>          <tr>           <td><strong><span>ENT_QUOTES</span></strong></td>           <td>既转换双引号也转换单引号。</td>          </tr>          <tr>           <td><strong><span>ENT_NOQUOTES</span></strong></td>           <td>单/双引号都不转换</td>          </tr>          <tr>           <td><strong><span>ENT_IGNORE</span></strong></td>           <td>            静默丢弃无效的代码单元序列，而不是返回空字符串。            不建议使用此标记，            因为它<a href="http://unicode.org/reports/tr36/#Deletion_of_Noncharacters" class="link external">&raquo;&nbsp;可能有安全影响</a>。           </td>          </tr>          <tr>           <td><strong><span>ENT_SUBSTITUTE</span></strong></td>           <td>            替换无效的代码单元序列为 Unicode 代替符（Replacement Character），            U+FFFD (UTF-8) 或者 &amp;#xFFFD; (其他)，而不是返回空字符串。           </td>          </tr>          <tr>           <td><strong><span>ENT_DISALLOWED</span></strong></td>           <td>            为文档的无效代码点替换为  Unicode 代替符（Replacement Character）：            U+FFFD (UTF-8)，或 &amp;#xFFFD;（其他），而不是把它们留在原处。            比如以下情况下就很有用：要保证 XML 文档嵌入额外内容时格式合法。           </td>          </tr>          <tr>           <td><strong><span>ENT_HTML401</span></strong></td>           <td>            以 HTML 4.01 处理代码。           </td>          </tr>          <tr>           <td><strong><span>ENT_XML1</span></strong></td>           <td>            以 XML 1 处理代码。           </td>          </tr>          <tr>           <td><strong><span>ENT_XHTML</span></strong></td>           <td>            以 XHTML 处理代码。           </td>          </tr>          <tr>           <td><strong><span>ENT_HTML5</span></strong></td>           <td>            以 HTML 5 处理代码。           </td>          </tr>         </tbody>               </table>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">encoding</span></dt>     <dd>       <p class="para">  An optional argument defining the encoding used when converting characters. </p> <p class="para">  If omitted, <span class="parameter" style="color:#3A95FF">encoding</span> defaults to the value of the  <a href="https://www.php.net/manual/zh/ini.core.php#ini.default-charset" class="link">default_charset</a> configuration  option. </p> <p class="para">  Although this argument is technically optional, you are highly encouraged to  specify the correct value for your code  if the <a href="https://www.php.net/manual/zh/ini.core.php#ini.default-charset" class="link">default_charset</a>  configuration option may be set incorrectly for the given input. </p>      <p class="para">       本函数使用效果上，如果 <span class="parameter" style="color:#3A95FF">string</span> 对以下字符编码是有效的，       <span>ISO-8859-1</span>、 <span>ISO-8859-15</span>、       <span>UTF-8</span>、 <span>cp866</span>、       <span>cp1251</span>、 <span>cp1252</span>、       <span>KOI8-R</span> 将具有相同的效果。       也就是说，在这些编码里，       受 <span class="function"><strong style="color:#CC7832">htmlspecialchars()</strong></span> 影响的字符会占据相同的位置。      </p>      <p class="para"> 支持以下字符集： <table class="doctable table">  <caption><strong>支持的字符集列表</strong></caption>     <thead>    <tr>     <th>字符集</th>     <th>别名</th>     <th>描述</th>    </tr>   </thead>   <tbody class="tbody">    <tr>     <td>ISO-8859-1</td>     <td>ISO8859-1</td>     <td>      西欧，Latin-1     </td>    </tr>    <tr>     <td>ISO-8859-5</td>     <td>ISO8859-5</td>     <td>      Little used cyrillic charset (Latin/Cyrillic).     </td>    </tr>    <tr>     <td>ISO-8859-15</td>     <td>ISO8859-15</td>     <td>      西欧，Latin-9。增加欧元符号，法语和芬兰语字母在 Latin-1(ISO-8859-1) 中缺失。     </td>    </tr>    <tr>     <td>UTF-8</td>     <td class="empty">&nbsp;</td>     <td>      ASCII 兼容的多字节 8 位 Unicode。     </td>    </tr>    <tr>     <td>cp866</td>     <td>ibm866, 866</td>     <td>      DOS 特有的西里尔编码。本字符集在 4.3.2 版本中得到支持。     </td>    </tr>    <tr>     <td>cp1251</td>     <td>Windows-1251, win-1251, 1251</td>     <td>      Windows 特有的西里尔编码。本字符集在 4.3.2 版本中得到支持。     </td>    </tr>    <tr>     <td>cp1252</td>     <td>Windows-1252, 1252</td>     <td>      Windows 特有的西欧编码。     </td>    </tr>    <tr>     <td>KOI8-R</td>     <td>koi8-ru, koi8r</td>     <td>      俄语。本字符集在 4.3.2 版本中得到支持。     </td>    </tr>    <tr>     <td>BIG5</td>     <td>950</td>     <td>      繁体中文，主要用于中国台湾省。     </td>    </tr>    <tr>     <td>GB2312</td>     <td>936</td>     <td>      简体中文，中国国家标准字符集。     </td>    </tr>    <tr>     <td>BIG5-HKSCS</td>     <td class="empty">&nbsp;</td>     <td>      繁体中文，附带香港扩展的 Big5 字符集。     </td>    </tr>    <tr>     <td>Shift_JIS</td>     <td>SJIS, 932</td>     <td>      日语     </td>    </tr>    <tr>     <td>EUC-JP</td>     <td>EUCJP</td>     <td>      日语     </td>    </tr>    <tr>     <td>MacRoman</td>     <td class="empty">&nbsp;</td>     <td>      Mac OS 使用的字符串。     </td>    </tr>    <tr>     <td><span>&#039;&#039;</span></td>     <td class="empty">&nbsp;</td>     <td>      An empty string activates detection from script encoding (Zend multibyte),      <a href="https://www.php.net/manual/zh/ini.core.php#ini.default-charset" class="link">default_charset</a> and current      locale (see <span class="function">{@link nl_langinfo()}</span> and      <span class="function">{@link setlocale()}</span>), in this order. Not recommended.     </td>    </tr>   </tbody>   </table> <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:   <span class="simpara">   其他字符集没有认可。将会使用默认编码并抛出异常。  </span> </p></blockquote></p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">double_encode</span></dt>     <dd>      <p class="para">       关闭 <span class="parameter" style="color:#3A95FF">double_encode</span> 时，PHP 不会转换现有的 HTML 实体，       默认是全部转换。      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.htmlspecialchars-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   转换后的 <span class="type" style="color:#EAB766">string</span>。  </p>  <p class="para">   如果指定的编码 <span class="parameter" style="color:#3A95FF">encoding</span> 里，   <span class="parameter" style="color:#3A95FF">string</span> 包含了无效的代码单元序列，   没有设置 <strong><span>ENT_IGNORE</span></strong> 或者   <strong><span>ENT_SUBSTITUTE</span></strong> 标记的情况下，会返回空字符串。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.htmlspecialchars-changelog">  <h3 class="title">更新日志</h3>  <table class="doctable informaltable">       <thead>     <tr>      <th>版本</th>      <th>说明</th>     </tr>    </thead>    <tbody class="tbody">     <tr>      <td>8.1.0</td>      <td>       <span class="parameter" style="color:#3A95FF">flags</span> 从 <strong><span>ENT_COMPAT</span></strong> 变更为 <strong><span>ENT_QUOTES</span></strong> | <strong><span>ENT_SUBSTITUTE</span></strong> | <strong><span>ENT_HTML401</span></strong>。      </td>     </tr>    </tbody>     </table> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.htmlspecialchars-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="">    <p><strong>示例 #1 <span class="function"><strong style="color:#CC7832">htmlspecialchars()</strong></span> 例子</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$new </span><span style="color: #007700">= </span><span style="color: #9876AA">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;a href='test'&gt;Test&lt;/a&gt;"</span><span style="color: #007700">, </span><span style="color: #9876AA">ENT_QUOTES</span><span style="color: #007700">);<br />echo </span><span style="color: #9876AA">$new</span><span style="color: #007700">; </span><span style="color: #FF8000">// &amp;lt;a href=&amp;#039;test&amp;#039;&amp;gt;Test&amp;lt;/a&amp;gt;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 notes" id="refsect1-function.htmlspecialchars-notes">  <h3 class="title">注释</h3>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    注意，本函数不会转换以上列表以外的实体。    完整转换请参见 <span class="function">{@link htmlentities()}</span>。   </p>  </p></blockquote>  <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:    <p class="para">    如果 <span class="parameter" style="color:#3A95FF">flags</span> 的设置模糊易混淆，将遵循以下规则：   </p>   <p class="para">    <ul class="itemizedlist">     <li class="listitem">      <span class="simpara">       当 <strong><span>ENT_COMPAT</span></strong>、<strong><span>ENT_QUOTES</span></strong>、<strong><span>ENT_NOQUOTES</span></strong> 都没设置，       默认就是 <strong><span>ENT_NOQUOTES</span></strong>。      </span>     </li>     <li class="listitem">      <span class="simpara">       如果设置不止一个 <strong><span>ENT_COMPAT</span></strong>、 <strong><span>ENT_QUOTES</span></strong>、       <strong><span>ENT_NOQUOTES</span></strong> ，优先级最高的是 <strong><span>ENT_QUOTES</span></strong>，       其次是 <strong><span>ENT_COMPAT</span></strong>。      </span>     </li>     <li class="listitem">      <span class="simpara">       当 <strong><span>ENT_HTML401</span></strong>、 <strong><span>ENT_HTML5</span></strong>、       <strong><span>ENT_XHTML</span></strong>、 <strong><span>ENT_XML1</span></strong> 都没设置，默认是       <strong><span>ENT_HTML401</span></strong>。      </span>     </li>     <li class="listitem">      <span class="simpara">       如果设置不止一个 <strong><span>ENT_HTML401</span></strong>、 <strong><span>ENT_HTML5</span></strong>、       <strong><span>ENT_XHTML</span></strong>、 <strong><span>ENT_XML1</span></strong>，       优先级最高的是       <strong><span>ENT_HTML5</span></strong> 其次是 <strong><span>ENT_XHTML</span></strong>、<strong><span>ENT_XML1</span></strong> 和 <strong><span>ENT_HTML401</span></strong>。      </span>     </li>     <li class="listitem">      <span class="simpara">       如果设置不止一个 <strong><span>ENT_DISALLOWED</span></strong>、 <strong><span>ENT_IGNORE</span></strong>、       <strong><span>ENT_SUBSTITUTE</span></strong>，优先级最高的是 <strong><span>ENT_IGNORE</span></strong>，       其次是 <strong><span>ENT_SUBSTITUTE</span></strong>。      </span>     </li>    </ul>   </p>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.htmlspecialchars-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link get_html_translation_table()} - 返回使用 htmlspecialchars 和 htmlentities 后的转换表</span></li>    <li class="member"><span class="function">{@link htmlspecialchars_decode()} - 将特殊的 HTML 实体转换回普通字符</span></li>    <li class="member"><span class="function">{@link strip_tags()} - 从字符串中去除 HTML 和 PHP 标签</span></li>    <li class="member"><span class="function">{@link htmlentities()} - 将字符转换为 HTML 转义字符</span></li>    <li class="member"><span class="function">{@link nl2br()} - 在字符串所有新行之前插入 HTML 换行标记</span></li>   </ul>  </span> </div></div>