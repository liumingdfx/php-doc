<div id="function.hash-hkdf" class="refentry"> <div class="refnamediv">  <h1 class="refname">hash_hkdf</h1>  <p class="verinfo">(PHP 7 &gt;= 7.1.2, PHP 8)</p><p class="refpurpose"><span class="refname">hash_hkdf</span> &mdash; <span class="dc-title">Generate a HKDF key derivation of a supplied key input</span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-function.hash-hkdf-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="methodname" style="color:#CC7832"><strong>hash_hkdf</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$algo</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$key</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">int</span> <span class="parameter" style="color:#3A95FF">$length</span><span class="initializer"> = 0</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$info</span><span class="initializer"> = &quot;&quot;</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type" style="color:#EAB766">string</span> <span class="parameter" style="color:#3A95FF">$salt</span><span class="initializer"> = &quot;&quot;</span></span><br>): <span class="type" style="color:#EAB766">string</span></div> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-function.hash-hkdf-parameters">  <h3 class="title">参数</h3>  <span>   <dl>         <dt><span class="parameter" style="color:#3A95FF">algo</span></dt>     <dd>      <p class="para">       Name of selected hashing algorithm (i.e. &quot;sha256&quot;, &quot;sha512&quot;, &quot;haval160,4&quot;, etc..)       See <span class="function">{@link hash_algos()}</span> for a list of supported algorithms.       <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:         <p class="para">         Non-cryptographic hash functions are not allowed.        </p>       </p></blockquote>      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">key</span></dt>     <dd>      <p class="para">       Input keying material (raw binary). Cannot be empty.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">length</span></dt>     <dd>      <p class="para">       Desired output length in bytes.       Cannot be greater than 255 times the chosen hash function size.      </p>      <p class="para">       If <span class="parameter" style="color:#3A95FF">length</span> is <span>0</span>, the output length       will default to the chosen hash function size.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">info</span></dt>     <dd>      <p class="para">       Application/context-specific info string.      </p>     </dd>             <dt><span class="parameter" style="color:#3A95FF">salt</span></dt>     <dd>      <p class="para">       Salt to use during derivation.      </p>      <p class="para">       While optional, adding random salt significantly improves the strength of HKDF.      </p>     </dd>       </dl>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-function.hash-hkdf-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   Returns a string containing a raw binary representation of the derived key   (also known as output keying material - OKM).  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 errors" id="refsect1-function.hash-hkdf-errors">  <h3 class="title">错误／异常</h3>  <p class="para">   Throws a <span class="classname"><a href="https://www.php.net/manual/zh/class.valueerror.php" class="classname">ValueError</a></span> exception if <span class="parameter" style="color:#3A95FF">key</span>   is empty, <span class="parameter" style="color:#3A95FF">algo</span> is unknown/non-cryptographic,   <span class="parameter" style="color:#3A95FF">length</span> is less than <span>0</span> or too large   (greater than 255 times the size of the hash function).  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 changelog" id="refsect1-function.hash-hkdf-changelog">  <h3 class="title">更新日志</h3>  <span>   <table class="doctable informaltable">         <thead>      <tr>       <th>版本</th>       <th>说明</th>      </tr>     </thead>     <tbody class="tbody">      <tr>       <td>8.0.0</td>       <td>        Now throws a <span class="classname"><a href="https://www.php.net/manual/zh/class.valueerror.php" class="classname">ValueError</a></span> exception on error.        Previously, <strong><span>false</span></strong> was returned and an <strong><span>E_WARNING</span></strong>        message was emitted.       </td>      </tr>     </tbody>       </table>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-function.hash-hkdf-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="example-2693">    <p><strong>示例 #1 <span class="function"><strong style="color:#CC7832">hash_hkdf()</strong></span> example</strong></p>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">// Generate a random key, and salt to strengthen it during derivation.<br /></span><span style="color: #9876AA">$inputKey </span><span style="color: #007700">= </span><span style="color: #9876AA">random_bytes</span><span style="color: #007700">(</span><span style="color: #9876AA">32</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$salt </span><span style="color: #007700">= </span><span style="color: #9876AA">random_bytes</span><span style="color: #007700">(</span><span style="color: #9876AA">16</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Derive a pair of separate keys, using the same input created above.<br /></span><span style="color: #9876AA">$encryptionKey </span><span style="color: #007700">= </span><span style="color: #9876AA">hash_hkdf</span><span style="color: #007700">(</span><span style="color: #DD0000">'sha256'</span><span style="color: #007700">, </span><span style="color: #9876AA">$inputKey</span><span style="color: #007700">, </span><span style="color: #9876AA">32</span><span style="color: #007700">, </span><span style="color: #DD0000">'aes-256-encryption'</span><span style="color: #007700">, </span><span style="color: #9876AA">$salt</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$authenticationKey </span><span style="color: #007700">= </span><span style="color: #9876AA">hash_hkdf</span><span style="color: #007700">(</span><span style="color: #DD0000">'sha256'</span><span style="color: #007700">, </span><span style="color: #9876AA">$inputKey</span><span style="color: #007700">, </span><span style="color: #9876AA">32</span><span style="color: #007700">, </span><span style="color: #DD0000">'sha-256-authentication'</span><span style="color: #007700">, </span><span style="color: #9876AA">$salt</span><span style="color: #007700">);<br /><br /></span><span style="color: #9876AA">var_dump</span><span style="color: #007700">(</span><span style="color: #9876AA">$encryptionKey </span><span style="color: #007700">!== </span><span style="color: #9876AA">$authenticationKey</span><span style="color: #007700">); </span><span style="color: #FF8000">// bool(true)<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>     The above example produces a pair of separate keys, suitable for creation of an     encrypt-then-HMAC construct, using AES-256 and SHA-256 for encryption and     authentication respectively.    </p></div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-function.hash-hkdf-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="function">{@link hash_pbkdf2()} - 生成所提供密码的 PBKDF2 密钥导出</span></li>    <li class="member"><a href="http://www.faqs.org/rfcs/rfc5869" class="link external">&raquo;&nbsp;RFC 5869</a></li>    <li class="member"><a href="https://www.php.net/manual/zh/https://github.com/narfbg/hash_hkdf_compat" class="link external">&raquo;&nbsp;userland implementation</a></li>   </ul>  </span> </div></div>