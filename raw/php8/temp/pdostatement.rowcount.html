<div id="pdostatement.rowcount" class="refentry"> <div class="refnamediv">  <h1 class="refname">PDOStatement::rowCount</h1>  <p class="verinfo">(PHP 5 &gt;= 5.1.0, PHP 7, PHP 8, PECL pdo &gt;= 0.1.0)</p><p class="refpurpose"><span class="refname">PDOStatement::rowCount</span> &mdash; <span class="dc-title">   返回受上一个 SQL 语句影响的行数  </span></p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 description" id="refsect1-pdostatement.rowcount-description">  <h3 class="title">说明</h3>  <div class="methodsynopsis dc-description">   <span class="modifier">public</span> <span class="methodname" style="color:#CC7832"><strong>PDOStatement::rowCount</strong></span>(): <span class="type" style="color:#EAB766">int</span></div>  <p class="para rdfs-comment">   <span class="methodname" style="color:#CC7832"><strong>PDOStatement::rowCount()</strong></span> 返回上一个由对应的 <span>PDOStatement</span> 对象执行 DELETE、INSERT 或 UPDATE 语句受影响的行数。  </p>  <p class="para">   对于生成结果集的语句，例如 <span>SELECT</span>，行为是未定义的，并且对于每个驱动程序可能不同。某些数据库可能会返回该语句生成的行数（例如缓冲模式下的   MySQL），但不能保证所有数据库都具有这种行为，并且对于可移植的应用不应依赖于此方式。  </p>    <blockquote class="note" style="border:1px gray solid"><p><strong class="note" style="border:1px gray solid">注意</strong>:      <p class="para">      对 SQLite 驱动程序，此方法始终返回“0”（零），并且 PostgreSQL 驱动程序仅当将 <strong><span>PDO::ATTR_CURSOR</span></strong> 语句属性设置为 <strong><span>PDO::CURSOR_SCROLL</span></strong> 时返回“0”（零）。     </p>  </p></blockquote> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 parameters" id="refsect1-pdostatement.rowcount-parameters">  <h3 class="title">参数</h3>  <span>此函数没有参数。</span> </div>   <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 returnvalues" id="refsect1-pdostatement.rowcount-returnvalues">  <h3 class="title">返回值</h3>  <p class="para">   返回行数。  </p> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 errors" id="refsect1-pdostatement.rowcount-errors">  <h3 class="title">错误／异常</h3>  <p class="para">如果属性 <strong><span>PDO::ATTR_ERRMODE</span></strong> 设置为 <strong><span>PDO::ERRMODE_WARNING</span></strong>，则发出级别为 <strong><span>E_WARNING</span></strong> 的错误。</p><p class="para">如果属性 <strong><span>PDO::ATTR_ERRMODE</span></strong> 设置为 <strong><span>PDO::ERRMODE_EXCEPTION</span></strong>，则抛出 <span class="classname"><a href="https://www.php.net/manual/zh/class.pdoexception.php" class="classname">PDOException</a></span>。</p> </div>  <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 examples" id="refsect1-pdostatement.rowcount-examples">  <h3 class="title">示例</h3>  <span>   <div class="example" id="example-3254">    <p><strong>示例 #1 返回删除的行数</strong></p>    <div class="example-contents"><p>     <span class="methodname" style="color:#CC7832"><strong>PDOStatement::rowCount()</strong></span> 返回受 DELETE、INSERT 或 UPDATE 语句影响的行数。    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br /></span><span style="color: #FF8000">//  从 FRUIT 数据表中删除所有行 <br /></span><span style="color: #9876AA">$del </span><span style="color: #007700">= </span><span style="color: #9876AA">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">'DELETE FROM fruit'</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$del</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//  返回被删除的行数 <br /></span><span style="color: #007700">print </span><span style="color: #DD0000">"Return number of rows that were deleted:\n"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$count </span><span style="color: #007700">= </span><span style="color: #9876AA">$del</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">rowCount</span><span style="color: #007700">();<br />print </span><span style="color: #DD0000">"Deleted </span><span style="color: #9876AA">$count</span><span style="color: #DD0000"> rows.\n"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">?&gt;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例的输出类似于：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>Return number of rows that were deleted:<br>Deleted 9 rows.<br></span></div>    </div>   </div>   <div class="example" id="example-3257">    <p><strong>示例 #2 计算由一个 SELECT 语句返回的行数</strong></p>    <div class="example-contents"><p>     对于大多数数据库，<span class="methodname" style="color:#CC7832"><strong>PDOStatement::rowCount()</strong></span> 不能返回受一条 SELECT 语句影响的行数。替代的方法是，使用 <span class="methodname" style="color:#CC7832">{@link PDO::query()}</span>     来发出一条和原打算中的 SELECT 语句有相同条件表达式的 SELECT COUNT(*) 语句，然后用 <span class="methodname" style="color:#CC7832">{@link PDOStatement::fetchColumn()}</span> 来取得匹配的行数。    </p></div>    <div class="example-contents"><div class="phpcode" style="border-color:gray;background:#232525"><span><span style="color: #000000"><span style="color: #9876AA">&lt;?php<br />$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">"SELECT COUNT(*) FROM fruit WHERE calories &gt; 100"</span><span style="color: #007700">;<br /></span><span style="color: #9876AA">$res </span><span style="color: #007700">= </span><span style="color: #9876AA">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">query</span><span style="color: #007700">(</span><span style="color: #9876AA">$sql</span><span style="color: #007700">);<br /></span><span style="color: #9876AA">$count </span><span style="color: #007700">= </span><span style="color: #9876AA">$res</span><span style="color: #007700">-&gt;</span><span style="color: #9876AA">fetchColumn</span><span style="color: #007700">();<br /><br />print </span><span style="color: #DD0000">"There are " </span><span style="color: #007700">.  </span><span style="color: #9876AA">$count </span><span style="color: #007700">. </span><span style="color: #DD0000">" matching records."</span><span style="color: #007700">;</span></span></span></div>    </div>    <div class="example-contents"><p>以上示例的输出类似于：</p></div>    <div class="example-contents screen" style="color:AFB1B3;background:black;padding-left:5px;"><div class="cdata"><span>There are 2 matching records.<br></span></div>    </div>   </div>  </span> </div> <br></br><div style="BORDER-TOP: gray 1px dashed; OVERFLOW: hidden; HEIGHT: 1px"></div><div class="refsect1 seealso" id="refsect1-pdostatement.rowcount-seealso">  <h3 class="title">参见</h3>  <span>   <ul class="simplelist">    <li class="member"><span class="methodname" style="color:#CC7832">{@link PDOStatement::columnCount()} - 返回结果集中的列数</span></li>    <li class="member"><span class="methodname" style="color:#CC7832">{@link PDOStatement::fetchColumn()} - 从结果集中的下一行返回单独的一列</span></li>    <li class="member"><span class="methodname" style="color:#CC7832">{@link PDO::query()} - 预处理并执行没有占位符的 SQL 语句</span></li>   </ul>  </span> </div></div>